<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Source: subst.ml (odoc.source.src.xref2)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.css"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/></head><body class="odoc-src"><nav class="odoc-nav"><a href="index.html">Up</a> â€“ <a href="../../../index.html">odoc</a> &#x00BB; <a href="../../index.html">source</a> &#x00BB; <a href="../index.html">src</a> &#x00BB; <a href="index.html">xref2</a> &#x00BB; subst.ml</nav><header class="odoc-preamble"><h1>Source file <code><span>subst.ml</span></code></h1></header><pre class="source_container"><code class="source_line_column"><a id="L1" class="source_line" href="#L1">1</a>
<a id="L2" class="source_line" href="#L2">2</a>
<a id="L3" class="source_line" href="#L3">3</a>
<a id="L4" class="source_line" href="#L4">4</a>
<a id="L5" class="source_line" href="#L5">5</a>
<a id="L6" class="source_line" href="#L6">6</a>
<a id="L7" class="source_line" href="#L7">7</a>
<a id="L8" class="source_line" href="#L8">8</a>
<a id="L9" class="source_line" href="#L9">9</a>
<a id="L10" class="source_line" href="#L10">10</a>
<a id="L11" class="source_line" href="#L11">11</a>
<a id="L12" class="source_line" href="#L12">12</a>
<a id="L13" class="source_line" href="#L13">13</a>
<a id="L14" class="source_line" href="#L14">14</a>
<a id="L15" class="source_line" href="#L15">15</a>
<a id="L16" class="source_line" href="#L16">16</a>
<a id="L17" class="source_line" href="#L17">17</a>
<a id="L18" class="source_line" href="#L18">18</a>
<a id="L19" class="source_line" href="#L19">19</a>
<a id="L20" class="source_line" href="#L20">20</a>
<a id="L21" class="source_line" href="#L21">21</a>
<a id="L22" class="source_line" href="#L22">22</a>
<a id="L23" class="source_line" href="#L23">23</a>
<a id="L24" class="source_line" href="#L24">24</a>
<a id="L25" class="source_line" href="#L25">25</a>
<a id="L26" class="source_line" href="#L26">26</a>
<a id="L27" class="source_line" href="#L27">27</a>
<a id="L28" class="source_line" href="#L28">28</a>
<a id="L29" class="source_line" href="#L29">29</a>
<a id="L30" class="source_line" href="#L30">30</a>
<a id="L31" class="source_line" href="#L31">31</a>
<a id="L32" class="source_line" href="#L32">32</a>
<a id="L33" class="source_line" href="#L33">33</a>
<a id="L34" class="source_line" href="#L34">34</a>
<a id="L35" class="source_line" href="#L35">35</a>
<a id="L36" class="source_line" href="#L36">36</a>
<a id="L37" class="source_line" href="#L37">37</a>
<a id="L38" class="source_line" href="#L38">38</a>
<a id="L39" class="source_line" href="#L39">39</a>
<a id="L40" class="source_line" href="#L40">40</a>
<a id="L41" class="source_line" href="#L41">41</a>
<a id="L42" class="source_line" href="#L42">42</a>
<a id="L43" class="source_line" href="#L43">43</a>
<a id="L44" class="source_line" href="#L44">44</a>
<a id="L45" class="source_line" href="#L45">45</a>
<a id="L46" class="source_line" href="#L46">46</a>
<a id="L47" class="source_line" href="#L47">47</a>
<a id="L48" class="source_line" href="#L48">48</a>
<a id="L49" class="source_line" href="#L49">49</a>
<a id="L50" class="source_line" href="#L50">50</a>
<a id="L51" class="source_line" href="#L51">51</a>
<a id="L52" class="source_line" href="#L52">52</a>
<a id="L53" class="source_line" href="#L53">53</a>
<a id="L54" class="source_line" href="#L54">54</a>
<a id="L55" class="source_line" href="#L55">55</a>
<a id="L56" class="source_line" href="#L56">56</a>
<a id="L57" class="source_line" href="#L57">57</a>
<a id="L58" class="source_line" href="#L58">58</a>
<a id="L59" class="source_line" href="#L59">59</a>
<a id="L60" class="source_line" href="#L60">60</a>
<a id="L61" class="source_line" href="#L61">61</a>
<a id="L62" class="source_line" href="#L62">62</a>
<a id="L63" class="source_line" href="#L63">63</a>
<a id="L64" class="source_line" href="#L64">64</a>
<a id="L65" class="source_line" href="#L65">65</a>
<a id="L66" class="source_line" href="#L66">66</a>
<a id="L67" class="source_line" href="#L67">67</a>
<a id="L68" class="source_line" href="#L68">68</a>
<a id="L69" class="source_line" href="#L69">69</a>
<a id="L70" class="source_line" href="#L70">70</a>
<a id="L71" class="source_line" href="#L71">71</a>
<a id="L72" class="source_line" href="#L72">72</a>
<a id="L73" class="source_line" href="#L73">73</a>
<a id="L74" class="source_line" href="#L74">74</a>
<a id="L75" class="source_line" href="#L75">75</a>
<a id="L76" class="source_line" href="#L76">76</a>
<a id="L77" class="source_line" href="#L77">77</a>
<a id="L78" class="source_line" href="#L78">78</a>
<a id="L79" class="source_line" href="#L79">79</a>
<a id="L80" class="source_line" href="#L80">80</a>
<a id="L81" class="source_line" href="#L81">81</a>
<a id="L82" class="source_line" href="#L82">82</a>
<a id="L83" class="source_line" href="#L83">83</a>
<a id="L84" class="source_line" href="#L84">84</a>
<a id="L85" class="source_line" href="#L85">85</a>
<a id="L86" class="source_line" href="#L86">86</a>
<a id="L87" class="source_line" href="#L87">87</a>
<a id="L88" class="source_line" href="#L88">88</a>
<a id="L89" class="source_line" href="#L89">89</a>
<a id="L90" class="source_line" href="#L90">90</a>
<a id="L91" class="source_line" href="#L91">91</a>
<a id="L92" class="source_line" href="#L92">92</a>
<a id="L93" class="source_line" href="#L93">93</a>
<a id="L94" class="source_line" href="#L94">94</a>
<a id="L95" class="source_line" href="#L95">95</a>
<a id="L96" class="source_line" href="#L96">96</a>
<a id="L97" class="source_line" href="#L97">97</a>
<a id="L98" class="source_line" href="#L98">98</a>
<a id="L99" class="source_line" href="#L99">99</a>
<a id="L100" class="source_line" href="#L100">100</a>
<a id="L101" class="source_line" href="#L101">101</a>
<a id="L102" class="source_line" href="#L102">102</a>
<a id="L103" class="source_line" href="#L103">103</a>
<a id="L104" class="source_line" href="#L104">104</a>
<a id="L105" class="source_line" href="#L105">105</a>
<a id="L106" class="source_line" href="#L106">106</a>
<a id="L107" class="source_line" href="#L107">107</a>
<a id="L108" class="source_line" href="#L108">108</a>
<a id="L109" class="source_line" href="#L109">109</a>
<a id="L110" class="source_line" href="#L110">110</a>
<a id="L111" class="source_line" href="#L111">111</a>
<a id="L112" class="source_line" href="#L112">112</a>
<a id="L113" class="source_line" href="#L113">113</a>
<a id="L114" class="source_line" href="#L114">114</a>
<a id="L115" class="source_line" href="#L115">115</a>
<a id="L116" class="source_line" href="#L116">116</a>
<a id="L117" class="source_line" href="#L117">117</a>
<a id="L118" class="source_line" href="#L118">118</a>
<a id="L119" class="source_line" href="#L119">119</a>
<a id="L120" class="source_line" href="#L120">120</a>
<a id="L121" class="source_line" href="#L121">121</a>
<a id="L122" class="source_line" href="#L122">122</a>
<a id="L123" class="source_line" href="#L123">123</a>
<a id="L124" class="source_line" href="#L124">124</a>
<a id="L125" class="source_line" href="#L125">125</a>
<a id="L126" class="source_line" href="#L126">126</a>
<a id="L127" class="source_line" href="#L127">127</a>
<a id="L128" class="source_line" href="#L128">128</a>
<a id="L129" class="source_line" href="#L129">129</a>
<a id="L130" class="source_line" href="#L130">130</a>
<a id="L131" class="source_line" href="#L131">131</a>
<a id="L132" class="source_line" href="#L132">132</a>
<a id="L133" class="source_line" href="#L133">133</a>
<a id="L134" class="source_line" href="#L134">134</a>
<a id="L135" class="source_line" href="#L135">135</a>
<a id="L136" class="source_line" href="#L136">136</a>
<a id="L137" class="source_line" href="#L137">137</a>
<a id="L138" class="source_line" href="#L138">138</a>
<a id="L139" class="source_line" href="#L139">139</a>
<a id="L140" class="source_line" href="#L140">140</a>
<a id="L141" class="source_line" href="#L141">141</a>
<a id="L142" class="source_line" href="#L142">142</a>
<a id="L143" class="source_line" href="#L143">143</a>
<a id="L144" class="source_line" href="#L144">144</a>
<a id="L145" class="source_line" href="#L145">145</a>
<a id="L146" class="source_line" href="#L146">146</a>
<a id="L147" class="source_line" href="#L147">147</a>
<a id="L148" class="source_line" href="#L148">148</a>
<a id="L149" class="source_line" href="#L149">149</a>
<a id="L150" class="source_line" href="#L150">150</a>
<a id="L151" class="source_line" href="#L151">151</a>
<a id="L152" class="source_line" href="#L152">152</a>
<a id="L153" class="source_line" href="#L153">153</a>
<a id="L154" class="source_line" href="#L154">154</a>
<a id="L155" class="source_line" href="#L155">155</a>
<a id="L156" class="source_line" href="#L156">156</a>
<a id="L157" class="source_line" href="#L157">157</a>
<a id="L158" class="source_line" href="#L158">158</a>
<a id="L159" class="source_line" href="#L159">159</a>
<a id="L160" class="source_line" href="#L160">160</a>
<a id="L161" class="source_line" href="#L161">161</a>
<a id="L162" class="source_line" href="#L162">162</a>
<a id="L163" class="source_line" href="#L163">163</a>
<a id="L164" class="source_line" href="#L164">164</a>
<a id="L165" class="source_line" href="#L165">165</a>
<a id="L166" class="source_line" href="#L166">166</a>
<a id="L167" class="source_line" href="#L167">167</a>
<a id="L168" class="source_line" href="#L168">168</a>
<a id="L169" class="source_line" href="#L169">169</a>
<a id="L170" class="source_line" href="#L170">170</a>
<a id="L171" class="source_line" href="#L171">171</a>
<a id="L172" class="source_line" href="#L172">172</a>
<a id="L173" class="source_line" href="#L173">173</a>
<a id="L174" class="source_line" href="#L174">174</a>
<a id="L175" class="source_line" href="#L175">175</a>
<a id="L176" class="source_line" href="#L176">176</a>
<a id="L177" class="source_line" href="#L177">177</a>
<a id="L178" class="source_line" href="#L178">178</a>
<a id="L179" class="source_line" href="#L179">179</a>
<a id="L180" class="source_line" href="#L180">180</a>
<a id="L181" class="source_line" href="#L181">181</a>
<a id="L182" class="source_line" href="#L182">182</a>
<a id="L183" class="source_line" href="#L183">183</a>
<a id="L184" class="source_line" href="#L184">184</a>
<a id="L185" class="source_line" href="#L185">185</a>
<a id="L186" class="source_line" href="#L186">186</a>
<a id="L187" class="source_line" href="#L187">187</a>
<a id="L188" class="source_line" href="#L188">188</a>
<a id="L189" class="source_line" href="#L189">189</a>
<a id="L190" class="source_line" href="#L190">190</a>
<a id="L191" class="source_line" href="#L191">191</a>
<a id="L192" class="source_line" href="#L192">192</a>
<a id="L193" class="source_line" href="#L193">193</a>
<a id="L194" class="source_line" href="#L194">194</a>
<a id="L195" class="source_line" href="#L195">195</a>
<a id="L196" class="source_line" href="#L196">196</a>
<a id="L197" class="source_line" href="#L197">197</a>
<a id="L198" class="source_line" href="#L198">198</a>
<a id="L199" class="source_line" href="#L199">199</a>
<a id="L200" class="source_line" href="#L200">200</a>
<a id="L201" class="source_line" href="#L201">201</a>
<a id="L202" class="source_line" href="#L202">202</a>
<a id="L203" class="source_line" href="#L203">203</a>
<a id="L204" class="source_line" href="#L204">204</a>
<a id="L205" class="source_line" href="#L205">205</a>
<a id="L206" class="source_line" href="#L206">206</a>
<a id="L207" class="source_line" href="#L207">207</a>
<a id="L208" class="source_line" href="#L208">208</a>
<a id="L209" class="source_line" href="#L209">209</a>
<a id="L210" class="source_line" href="#L210">210</a>
<a id="L211" class="source_line" href="#L211">211</a>
<a id="L212" class="source_line" href="#L212">212</a>
<a id="L213" class="source_line" href="#L213">213</a>
<a id="L214" class="source_line" href="#L214">214</a>
<a id="L215" class="source_line" href="#L215">215</a>
<a id="L216" class="source_line" href="#L216">216</a>
<a id="L217" class="source_line" href="#L217">217</a>
<a id="L218" class="source_line" href="#L218">218</a>
<a id="L219" class="source_line" href="#L219">219</a>
<a id="L220" class="source_line" href="#L220">220</a>
<a id="L221" class="source_line" href="#L221">221</a>
<a id="L222" class="source_line" href="#L222">222</a>
<a id="L223" class="source_line" href="#L223">223</a>
<a id="L224" class="source_line" href="#L224">224</a>
<a id="L225" class="source_line" href="#L225">225</a>
<a id="L226" class="source_line" href="#L226">226</a>
<a id="L227" class="source_line" href="#L227">227</a>
<a id="L228" class="source_line" href="#L228">228</a>
<a id="L229" class="source_line" href="#L229">229</a>
<a id="L230" class="source_line" href="#L230">230</a>
<a id="L231" class="source_line" href="#L231">231</a>
<a id="L232" class="source_line" href="#L232">232</a>
<a id="L233" class="source_line" href="#L233">233</a>
<a id="L234" class="source_line" href="#L234">234</a>
<a id="L235" class="source_line" href="#L235">235</a>
<a id="L236" class="source_line" href="#L236">236</a>
<a id="L237" class="source_line" href="#L237">237</a>
<a id="L238" class="source_line" href="#L238">238</a>
<a id="L239" class="source_line" href="#L239">239</a>
<a id="L240" class="source_line" href="#L240">240</a>
<a id="L241" class="source_line" href="#L241">241</a>
<a id="L242" class="source_line" href="#L242">242</a>
<a id="L243" class="source_line" href="#L243">243</a>
<a id="L244" class="source_line" href="#L244">244</a>
<a id="L245" class="source_line" href="#L245">245</a>
<a id="L246" class="source_line" href="#L246">246</a>
<a id="L247" class="source_line" href="#L247">247</a>
<a id="L248" class="source_line" href="#L248">248</a>
<a id="L249" class="source_line" href="#L249">249</a>
<a id="L250" class="source_line" href="#L250">250</a>
<a id="L251" class="source_line" href="#L251">251</a>
<a id="L252" class="source_line" href="#L252">252</a>
<a id="L253" class="source_line" href="#L253">253</a>
<a id="L254" class="source_line" href="#L254">254</a>
<a id="L255" class="source_line" href="#L255">255</a>
<a id="L256" class="source_line" href="#L256">256</a>
<a id="L257" class="source_line" href="#L257">257</a>
<a id="L258" class="source_line" href="#L258">258</a>
<a id="L259" class="source_line" href="#L259">259</a>
<a id="L260" class="source_line" href="#L260">260</a>
<a id="L261" class="source_line" href="#L261">261</a>
<a id="L262" class="source_line" href="#L262">262</a>
<a id="L263" class="source_line" href="#L263">263</a>
<a id="L264" class="source_line" href="#L264">264</a>
<a id="L265" class="source_line" href="#L265">265</a>
<a id="L266" class="source_line" href="#L266">266</a>
<a id="L267" class="source_line" href="#L267">267</a>
<a id="L268" class="source_line" href="#L268">268</a>
<a id="L269" class="source_line" href="#L269">269</a>
<a id="L270" class="source_line" href="#L270">270</a>
<a id="L271" class="source_line" href="#L271">271</a>
<a id="L272" class="source_line" href="#L272">272</a>
<a id="L273" class="source_line" href="#L273">273</a>
<a id="L274" class="source_line" href="#L274">274</a>
<a id="L275" class="source_line" href="#L275">275</a>
<a id="L276" class="source_line" href="#L276">276</a>
<a id="L277" class="source_line" href="#L277">277</a>
<a id="L278" class="source_line" href="#L278">278</a>
<a id="L279" class="source_line" href="#L279">279</a>
<a id="L280" class="source_line" href="#L280">280</a>
<a id="L281" class="source_line" href="#L281">281</a>
<a id="L282" class="source_line" href="#L282">282</a>
<a id="L283" class="source_line" href="#L283">283</a>
<a id="L284" class="source_line" href="#L284">284</a>
<a id="L285" class="source_line" href="#L285">285</a>
<a id="L286" class="source_line" href="#L286">286</a>
<a id="L287" class="source_line" href="#L287">287</a>
<a id="L288" class="source_line" href="#L288">288</a>
<a id="L289" class="source_line" href="#L289">289</a>
<a id="L290" class="source_line" href="#L290">290</a>
<a id="L291" class="source_line" href="#L291">291</a>
<a id="L292" class="source_line" href="#L292">292</a>
<a id="L293" class="source_line" href="#L293">293</a>
<a id="L294" class="source_line" href="#L294">294</a>
<a id="L295" class="source_line" href="#L295">295</a>
<a id="L296" class="source_line" href="#L296">296</a>
<a id="L297" class="source_line" href="#L297">297</a>
<a id="L298" class="source_line" href="#L298">298</a>
<a id="L299" class="source_line" href="#L299">299</a>
<a id="L300" class="source_line" href="#L300">300</a>
<a id="L301" class="source_line" href="#L301">301</a>
<a id="L302" class="source_line" href="#L302">302</a>
<a id="L303" class="source_line" href="#L303">303</a>
<a id="L304" class="source_line" href="#L304">304</a>
<a id="L305" class="source_line" href="#L305">305</a>
<a id="L306" class="source_line" href="#L306">306</a>
<a id="L307" class="source_line" href="#L307">307</a>
<a id="L308" class="source_line" href="#L308">308</a>
<a id="L309" class="source_line" href="#L309">309</a>
<a id="L310" class="source_line" href="#L310">310</a>
<a id="L311" class="source_line" href="#L311">311</a>
<a id="L312" class="source_line" href="#L312">312</a>
<a id="L313" class="source_line" href="#L313">313</a>
<a id="L314" class="source_line" href="#L314">314</a>
<a id="L315" class="source_line" href="#L315">315</a>
<a id="L316" class="source_line" href="#L316">316</a>
<a id="L317" class="source_line" href="#L317">317</a>
<a id="L318" class="source_line" href="#L318">318</a>
<a id="L319" class="source_line" href="#L319">319</a>
<a id="L320" class="source_line" href="#L320">320</a>
<a id="L321" class="source_line" href="#L321">321</a>
<a id="L322" class="source_line" href="#L322">322</a>
<a id="L323" class="source_line" href="#L323">323</a>
<a id="L324" class="source_line" href="#L324">324</a>
<a id="L325" class="source_line" href="#L325">325</a>
<a id="L326" class="source_line" href="#L326">326</a>
<a id="L327" class="source_line" href="#L327">327</a>
<a id="L328" class="source_line" href="#L328">328</a>
<a id="L329" class="source_line" href="#L329">329</a>
<a id="L330" class="source_line" href="#L330">330</a>
<a id="L331" class="source_line" href="#L331">331</a>
<a id="L332" class="source_line" href="#L332">332</a>
<a id="L333" class="source_line" href="#L333">333</a>
<a id="L334" class="source_line" href="#L334">334</a>
<a id="L335" class="source_line" href="#L335">335</a>
<a id="L336" class="source_line" href="#L336">336</a>
<a id="L337" class="source_line" href="#L337">337</a>
<a id="L338" class="source_line" href="#L338">338</a>
<a id="L339" class="source_line" href="#L339">339</a>
<a id="L340" class="source_line" href="#L340">340</a>
<a id="L341" class="source_line" href="#L341">341</a>
<a id="L342" class="source_line" href="#L342">342</a>
<a id="L343" class="source_line" href="#L343">343</a>
<a id="L344" class="source_line" href="#L344">344</a>
<a id="L345" class="source_line" href="#L345">345</a>
<a id="L346" class="source_line" href="#L346">346</a>
<a id="L347" class="source_line" href="#L347">347</a>
<a id="L348" class="source_line" href="#L348">348</a>
<a id="L349" class="source_line" href="#L349">349</a>
<a id="L350" class="source_line" href="#L350">350</a>
<a id="L351" class="source_line" href="#L351">351</a>
<a id="L352" class="source_line" href="#L352">352</a>
<a id="L353" class="source_line" href="#L353">353</a>
<a id="L354" class="source_line" href="#L354">354</a>
<a id="L355" class="source_line" href="#L355">355</a>
<a id="L356" class="source_line" href="#L356">356</a>
<a id="L357" class="source_line" href="#L357">357</a>
<a id="L358" class="source_line" href="#L358">358</a>
<a id="L359" class="source_line" href="#L359">359</a>
<a id="L360" class="source_line" href="#L360">360</a>
<a id="L361" class="source_line" href="#L361">361</a>
<a id="L362" class="source_line" href="#L362">362</a>
<a id="L363" class="source_line" href="#L363">363</a>
<a id="L364" class="source_line" href="#L364">364</a>
<a id="L365" class="source_line" href="#L365">365</a>
<a id="L366" class="source_line" href="#L366">366</a>
<a id="L367" class="source_line" href="#L367">367</a>
<a id="L368" class="source_line" href="#L368">368</a>
<a id="L369" class="source_line" href="#L369">369</a>
<a id="L370" class="source_line" href="#L370">370</a>
<a id="L371" class="source_line" href="#L371">371</a>
<a id="L372" class="source_line" href="#L372">372</a>
<a id="L373" class="source_line" href="#L373">373</a>
<a id="L374" class="source_line" href="#L374">374</a>
<a id="L375" class="source_line" href="#L375">375</a>
<a id="L376" class="source_line" href="#L376">376</a>
<a id="L377" class="source_line" href="#L377">377</a>
<a id="L378" class="source_line" href="#L378">378</a>
<a id="L379" class="source_line" href="#L379">379</a>
<a id="L380" class="source_line" href="#L380">380</a>
<a id="L381" class="source_line" href="#L381">381</a>
<a id="L382" class="source_line" href="#L382">382</a>
<a id="L383" class="source_line" href="#L383">383</a>
<a id="L384" class="source_line" href="#L384">384</a>
<a id="L385" class="source_line" href="#L385">385</a>
<a id="L386" class="source_line" href="#L386">386</a>
<a id="L387" class="source_line" href="#L387">387</a>
<a id="L388" class="source_line" href="#L388">388</a>
<a id="L389" class="source_line" href="#L389">389</a>
<a id="L390" class="source_line" href="#L390">390</a>
<a id="L391" class="source_line" href="#L391">391</a>
<a id="L392" class="source_line" href="#L392">392</a>
<a id="L393" class="source_line" href="#L393">393</a>
<a id="L394" class="source_line" href="#L394">394</a>
<a id="L395" class="source_line" href="#L395">395</a>
<a id="L396" class="source_line" href="#L396">396</a>
<a id="L397" class="source_line" href="#L397">397</a>
<a id="L398" class="source_line" href="#L398">398</a>
<a id="L399" class="source_line" href="#L399">399</a>
<a id="L400" class="source_line" href="#L400">400</a>
<a id="L401" class="source_line" href="#L401">401</a>
<a id="L402" class="source_line" href="#L402">402</a>
<a id="L403" class="source_line" href="#L403">403</a>
<a id="L404" class="source_line" href="#L404">404</a>
<a id="L405" class="source_line" href="#L405">405</a>
<a id="L406" class="source_line" href="#L406">406</a>
<a id="L407" class="source_line" href="#L407">407</a>
<a id="L408" class="source_line" href="#L408">408</a>
<a id="L409" class="source_line" href="#L409">409</a>
<a id="L410" class="source_line" href="#L410">410</a>
<a id="L411" class="source_line" href="#L411">411</a>
<a id="L412" class="source_line" href="#L412">412</a>
<a id="L413" class="source_line" href="#L413">413</a>
<a id="L414" class="source_line" href="#L414">414</a>
<a id="L415" class="source_line" href="#L415">415</a>
<a id="L416" class="source_line" href="#L416">416</a>
<a id="L417" class="source_line" href="#L417">417</a>
<a id="L418" class="source_line" href="#L418">418</a>
<a id="L419" class="source_line" href="#L419">419</a>
<a id="L420" class="source_line" href="#L420">420</a>
<a id="L421" class="source_line" href="#L421">421</a>
<a id="L422" class="source_line" href="#L422">422</a>
<a id="L423" class="source_line" href="#L423">423</a>
<a id="L424" class="source_line" href="#L424">424</a>
<a id="L425" class="source_line" href="#L425">425</a>
<a id="L426" class="source_line" href="#L426">426</a>
<a id="L427" class="source_line" href="#L427">427</a>
<a id="L428" class="source_line" href="#L428">428</a>
<a id="L429" class="source_line" href="#L429">429</a>
<a id="L430" class="source_line" href="#L430">430</a>
<a id="L431" class="source_line" href="#L431">431</a>
<a id="L432" class="source_line" href="#L432">432</a>
<a id="L433" class="source_line" href="#L433">433</a>
<a id="L434" class="source_line" href="#L434">434</a>
<a id="L435" class="source_line" href="#L435">435</a>
<a id="L436" class="source_line" href="#L436">436</a>
<a id="L437" class="source_line" href="#L437">437</a>
<a id="L438" class="source_line" href="#L438">438</a>
<a id="L439" class="source_line" href="#L439">439</a>
<a id="L440" class="source_line" href="#L440">440</a>
<a id="L441" class="source_line" href="#L441">441</a>
<a id="L442" class="source_line" href="#L442">442</a>
<a id="L443" class="source_line" href="#L443">443</a>
<a id="L444" class="source_line" href="#L444">444</a>
<a id="L445" class="source_line" href="#L445">445</a>
<a id="L446" class="source_line" href="#L446">446</a>
<a id="L447" class="source_line" href="#L447">447</a>
<a id="L448" class="source_line" href="#L448">448</a>
<a id="L449" class="source_line" href="#L449">449</a>
<a id="L450" class="source_line" href="#L450">450</a>
<a id="L451" class="source_line" href="#L451">451</a>
<a id="L452" class="source_line" href="#L452">452</a>
<a id="L453" class="source_line" href="#L453">453</a>
<a id="L454" class="source_line" href="#L454">454</a>
<a id="L455" class="source_line" href="#L455">455</a>
<a id="L456" class="source_line" href="#L456">456</a>
<a id="L457" class="source_line" href="#L457">457</a>
<a id="L458" class="source_line" href="#L458">458</a>
<a id="L459" class="source_line" href="#L459">459</a>
<a id="L460" class="source_line" href="#L460">460</a>
<a id="L461" class="source_line" href="#L461">461</a>
<a id="L462" class="source_line" href="#L462">462</a>
<a id="L463" class="source_line" href="#L463">463</a>
<a id="L464" class="source_line" href="#L464">464</a>
<a id="L465" class="source_line" href="#L465">465</a>
<a id="L466" class="source_line" href="#L466">466</a>
<a id="L467" class="source_line" href="#L467">467</a>
<a id="L468" class="source_line" href="#L468">468</a>
<a id="L469" class="source_line" href="#L469">469</a>
<a id="L470" class="source_line" href="#L470">470</a>
<a id="L471" class="source_line" href="#L471">471</a>
<a id="L472" class="source_line" href="#L472">472</a>
<a id="L473" class="source_line" href="#L473">473</a>
<a id="L474" class="source_line" href="#L474">474</a>
<a id="L475" class="source_line" href="#L475">475</a>
<a id="L476" class="source_line" href="#L476">476</a>
<a id="L477" class="source_line" href="#L477">477</a>
<a id="L478" class="source_line" href="#L478">478</a>
<a id="L479" class="source_line" href="#L479">479</a>
<a id="L480" class="source_line" href="#L480">480</a>
<a id="L481" class="source_line" href="#L481">481</a>
<a id="L482" class="source_line" href="#L482">482</a>
<a id="L483" class="source_line" href="#L483">483</a>
<a id="L484" class="source_line" href="#L484">484</a>
<a id="L485" class="source_line" href="#L485">485</a>
<a id="L486" class="source_line" href="#L486">486</a>
<a id="L487" class="source_line" href="#L487">487</a>
<a id="L488" class="source_line" href="#L488">488</a>
<a id="L489" class="source_line" href="#L489">489</a>
<a id="L490" class="source_line" href="#L490">490</a>
<a id="L491" class="source_line" href="#L491">491</a>
<a id="L492" class="source_line" href="#L492">492</a>
<a id="L493" class="source_line" href="#L493">493</a>
<a id="L494" class="source_line" href="#L494">494</a>
<a id="L495" class="source_line" href="#L495">495</a>
<a id="L496" class="source_line" href="#L496">496</a>
<a id="L497" class="source_line" href="#L497">497</a>
<a id="L498" class="source_line" href="#L498">498</a>
<a id="L499" class="source_line" href="#L499">499</a>
<a id="L500" class="source_line" href="#L500">500</a>
<a id="L501" class="source_line" href="#L501">501</a>
<a id="L502" class="source_line" href="#L502">502</a>
<a id="L503" class="source_line" href="#L503">503</a>
<a id="L504" class="source_line" href="#L504">504</a>
<a id="L505" class="source_line" href="#L505">505</a>
<a id="L506" class="source_line" href="#L506">506</a>
<a id="L507" class="source_line" href="#L507">507</a>
<a id="L508" class="source_line" href="#L508">508</a>
<a id="L509" class="source_line" href="#L509">509</a>
<a id="L510" class="source_line" href="#L510">510</a>
<a id="L511" class="source_line" href="#L511">511</a>
<a id="L512" class="source_line" href="#L512">512</a>
<a id="L513" class="source_line" href="#L513">513</a>
<a id="L514" class="source_line" href="#L514">514</a>
<a id="L515" class="source_line" href="#L515">515</a>
<a id="L516" class="source_line" href="#L516">516</a>
<a id="L517" class="source_line" href="#L517">517</a>
<a id="L518" class="source_line" href="#L518">518</a>
<a id="L519" class="source_line" href="#L519">519</a>
<a id="L520" class="source_line" href="#L520">520</a>
<a id="L521" class="source_line" href="#L521">521</a>
<a id="L522" class="source_line" href="#L522">522</a>
<a id="L523" class="source_line" href="#L523">523</a>
<a id="L524" class="source_line" href="#L524">524</a>
<a id="L525" class="source_line" href="#L525">525</a>
<a id="L526" class="source_line" href="#L526">526</a>
<a id="L527" class="source_line" href="#L527">527</a>
<a id="L528" class="source_line" href="#L528">528</a>
<a id="L529" class="source_line" href="#L529">529</a>
<a id="L530" class="source_line" href="#L530">530</a>
<a id="L531" class="source_line" href="#L531">531</a>
<a id="L532" class="source_line" href="#L532">532</a>
<a id="L533" class="source_line" href="#L533">533</a>
<a id="L534" class="source_line" href="#L534">534</a>
<a id="L535" class="source_line" href="#L535">535</a>
<a id="L536" class="source_line" href="#L536">536</a>
<a id="L537" class="source_line" href="#L537">537</a>
<a id="L538" class="source_line" href="#L538">538</a>
<a id="L539" class="source_line" href="#L539">539</a>
<a id="L540" class="source_line" href="#L540">540</a>
<a id="L541" class="source_line" href="#L541">541</a>
<a id="L542" class="source_line" href="#L542">542</a>
<a id="L543" class="source_line" href="#L543">543</a>
<a id="L544" class="source_line" href="#L544">544</a>
<a id="L545" class="source_line" href="#L545">545</a>
<a id="L546" class="source_line" href="#L546">546</a>
<a id="L547" class="source_line" href="#L547">547</a>
<a id="L548" class="source_line" href="#L548">548</a>
<a id="L549" class="source_line" href="#L549">549</a>
<a id="L550" class="source_line" href="#L550">550</a>
<a id="L551" class="source_line" href="#L551">551</a>
<a id="L552" class="source_line" href="#L552">552</a>
<a id="L553" class="source_line" href="#L553">553</a>
<a id="L554" class="source_line" href="#L554">554</a>
<a id="L555" class="source_line" href="#L555">555</a>
<a id="L556" class="source_line" href="#L556">556</a>
<a id="L557" class="source_line" href="#L557">557</a>
<a id="L558" class="source_line" href="#L558">558</a>
<a id="L559" class="source_line" href="#L559">559</a>
<a id="L560" class="source_line" href="#L560">560</a>
<a id="L561" class="source_line" href="#L561">561</a>
<a id="L562" class="source_line" href="#L562">562</a>
<a id="L563" class="source_line" href="#L563">563</a>
<a id="L564" class="source_line" href="#L564">564</a>
<a id="L565" class="source_line" href="#L565">565</a>
<a id="L566" class="source_line" href="#L566">566</a>
<a id="L567" class="source_line" href="#L567">567</a>
<a id="L568" class="source_line" href="#L568">568</a>
<a id="L569" class="source_line" href="#L569">569</a>
<a id="L570" class="source_line" href="#L570">570</a>
<a id="L571" class="source_line" href="#L571">571</a>
<a id="L572" class="source_line" href="#L572">572</a>
<a id="L573" class="source_line" href="#L573">573</a>
<a id="L574" class="source_line" href="#L574">574</a>
<a id="L575" class="source_line" href="#L575">575</a>
<a id="L576" class="source_line" href="#L576">576</a>
<a id="L577" class="source_line" href="#L577">577</a>
<a id="L578" class="source_line" href="#L578">578</a>
<a id="L579" class="source_line" href="#L579">579</a>
<a id="L580" class="source_line" href="#L580">580</a>
<a id="L581" class="source_line" href="#L581">581</a>
<a id="L582" class="source_line" href="#L582">582</a>
<a id="L583" class="source_line" href="#L583">583</a>
<a id="L584" class="source_line" href="#L584">584</a>
<a id="L585" class="source_line" href="#L585">585</a>
<a id="L586" class="source_line" href="#L586">586</a>
<a id="L587" class="source_line" href="#L587">587</a>
<a id="L588" class="source_line" href="#L588">588</a>
<a id="L589" class="source_line" href="#L589">589</a>
<a id="L590" class="source_line" href="#L590">590</a>
<a id="L591" class="source_line" href="#L591">591</a>
<a id="L592" class="source_line" href="#L592">592</a>
<a id="L593" class="source_line" href="#L593">593</a>
<a id="L594" class="source_line" href="#L594">594</a>
<a id="L595" class="source_line" href="#L595">595</a>
<a id="L596" class="source_line" href="#L596">596</a>
<a id="L597" class="source_line" href="#L597">597</a>
<a id="L598" class="source_line" href="#L598">598</a>
<a id="L599" class="source_line" href="#L599">599</a>
<a id="L600" class="source_line" href="#L600">600</a>
<a id="L601" class="source_line" href="#L601">601</a>
<a id="L602" class="source_line" href="#L602">602</a>
<a id="L603" class="source_line" href="#L603">603</a>
<a id="L604" class="source_line" href="#L604">604</a>
<a id="L605" class="source_line" href="#L605">605</a>
<a id="L606" class="source_line" href="#L606">606</a>
<a id="L607" class="source_line" href="#L607">607</a>
<a id="L608" class="source_line" href="#L608">608</a>
<a id="L609" class="source_line" href="#L609">609</a>
<a id="L610" class="source_line" href="#L610">610</a>
<a id="L611" class="source_line" href="#L611">611</a>
<a id="L612" class="source_line" href="#L612">612</a>
<a id="L613" class="source_line" href="#L613">613</a>
<a id="L614" class="source_line" href="#L614">614</a>
<a id="L615" class="source_line" href="#L615">615</a>
<a id="L616" class="source_line" href="#L616">616</a>
<a id="L617" class="source_line" href="#L617">617</a>
<a id="L618" class="source_line" href="#L618">618</a>
<a id="L619" class="source_line" href="#L619">619</a>
<a id="L620" class="source_line" href="#L620">620</a>
<a id="L621" class="source_line" href="#L621">621</a>
<a id="L622" class="source_line" href="#L622">622</a>
<a id="L623" class="source_line" href="#L623">623</a>
<a id="L624" class="source_line" href="#L624">624</a>
<a id="L625" class="source_line" href="#L625">625</a>
<a id="L626" class="source_line" href="#L626">626</a>
<a id="L627" class="source_line" href="#L627">627</a>
<a id="L628" class="source_line" href="#L628">628</a>
<a id="L629" class="source_line" href="#L629">629</a>
<a id="L630" class="source_line" href="#L630">630</a>
<a id="L631" class="source_line" href="#L631">631</a>
<a id="L632" class="source_line" href="#L632">632</a>
<a id="L633" class="source_line" href="#L633">633</a>
<a id="L634" class="source_line" href="#L634">634</a>
<a id="L635" class="source_line" href="#L635">635</a>
<a id="L636" class="source_line" href="#L636">636</a>
<a id="L637" class="source_line" href="#L637">637</a>
<a id="L638" class="source_line" href="#L638">638</a>
<a id="L639" class="source_line" href="#L639">639</a>
<a id="L640" class="source_line" href="#L640">640</a>
<a id="L641" class="source_line" href="#L641">641</a>
<a id="L642" class="source_line" href="#L642">642</a>
<a id="L643" class="source_line" href="#L643">643</a>
<a id="L644" class="source_line" href="#L644">644</a>
<a id="L645" class="source_line" href="#L645">645</a>
<a id="L646" class="source_line" href="#L646">646</a>
<a id="L647" class="source_line" href="#L647">647</a>
<a id="L648" class="source_line" href="#L648">648</a>
<a id="L649" class="source_line" href="#L649">649</a>
<a id="L650" class="source_line" href="#L650">650</a>
<a id="L651" class="source_line" href="#L651">651</a>
<a id="L652" class="source_line" href="#L652">652</a>
<a id="L653" class="source_line" href="#L653">653</a>
<a id="L654" class="source_line" href="#L654">654</a>
<a id="L655" class="source_line" href="#L655">655</a>
<a id="L656" class="source_line" href="#L656">656</a>
<a id="L657" class="source_line" href="#L657">657</a>
<a id="L658" class="source_line" href="#L658">658</a>
<a id="L659" class="source_line" href="#L659">659</a>
<a id="L660" class="source_line" href="#L660">660</a>
<a id="L661" class="source_line" href="#L661">661</a>
<a id="L662" class="source_line" href="#L662">662</a>
<a id="L663" class="source_line" href="#L663">663</a>
<a id="L664" class="source_line" href="#L664">664</a>
<a id="L665" class="source_line" href="#L665">665</a>
<a id="L666" class="source_line" href="#L666">666</a>
<a id="L667" class="source_line" href="#L667">667</a>
<a id="L668" class="source_line" href="#L668">668</a>
<a id="L669" class="source_line" href="#L669">669</a>
<a id="L670" class="source_line" href="#L670">670</a>
<a id="L671" class="source_line" href="#L671">671</a>
<a id="L672" class="source_line" href="#L672">672</a>
<a id="L673" class="source_line" href="#L673">673</a>
<a id="L674" class="source_line" href="#L674">674</a>
<a id="L675" class="source_line" href="#L675">675</a>
<a id="L676" class="source_line" href="#L676">676</a>
<a id="L677" class="source_line" href="#L677">677</a>
<a id="L678" class="source_line" href="#L678">678</a>
<a id="L679" class="source_line" href="#L679">679</a>
<a id="L680" class="source_line" href="#L680">680</a>
<a id="L681" class="source_line" href="#L681">681</a>
<a id="L682" class="source_line" href="#L682">682</a>
<a id="L683" class="source_line" href="#L683">683</a>
<a id="L684" class="source_line" href="#L684">684</a>
<a id="L685" class="source_line" href="#L685">685</a>
<a id="L686" class="source_line" href="#L686">686</a>
<a id="L687" class="source_line" href="#L687">687</a>
<a id="L688" class="source_line" href="#L688">688</a>
<a id="L689" class="source_line" href="#L689">689</a>
<a id="L690" class="source_line" href="#L690">690</a>
<a id="L691" class="source_line" href="#L691">691</a>
<a id="L692" class="source_line" href="#L692">692</a>
<a id="L693" class="source_line" href="#L693">693</a>
<a id="L694" class="source_line" href="#L694">694</a>
<a id="L695" class="source_line" href="#L695">695</a>
<a id="L696" class="source_line" href="#L696">696</a>
<a id="L697" class="source_line" href="#L697">697</a>
<a id="L698" class="source_line" href="#L698">698</a>
<a id="L699" class="source_line" href="#L699">699</a>
<a id="L700" class="source_line" href="#L700">700</a>
<a id="L701" class="source_line" href="#L701">701</a>
<a id="L702" class="source_line" href="#L702">702</a>
<a id="L703" class="source_line" href="#L703">703</a>
<a id="L704" class="source_line" href="#L704">704</a>
<a id="L705" class="source_line" href="#L705">705</a>
<a id="L706" class="source_line" href="#L706">706</a>
<a id="L707" class="source_line" href="#L707">707</a>
<a id="L708" class="source_line" href="#L708">708</a>
<a id="L709" class="source_line" href="#L709">709</a>
<a id="L710" class="source_line" href="#L710">710</a>
<a id="L711" class="source_line" href="#L711">711</a>
<a id="L712" class="source_line" href="#L712">712</a>
<a id="L713" class="source_line" href="#L713">713</a>
<a id="L714" class="source_line" href="#L714">714</a>
<a id="L715" class="source_line" href="#L715">715</a>
<a id="L716" class="source_line" href="#L716">716</a>
<a id="L717" class="source_line" href="#L717">717</a>
<a id="L718" class="source_line" href="#L718">718</a>
<a id="L719" class="source_line" href="#L719">719</a>
<a id="L720" class="source_line" href="#L720">720</a>
<a id="L721" class="source_line" href="#L721">721</a>
<a id="L722" class="source_line" href="#L722">722</a>
<a id="L723" class="source_line" href="#L723">723</a>
<a id="L724" class="source_line" href="#L724">724</a>
<a id="L725" class="source_line" href="#L725">725</a>
<a id="L726" class="source_line" href="#L726">726</a>
<a id="L727" class="source_line" href="#L727">727</a>
<a id="L728" class="source_line" href="#L728">728</a>
<a id="L729" class="source_line" href="#L729">729</a>
<a id="L730" class="source_line" href="#L730">730</a>
<a id="L731" class="source_line" href="#L731">731</a>
<a id="L732" class="source_line" href="#L732">732</a>
<a id="L733" class="source_line" href="#L733">733</a>
<a id="L734" class="source_line" href="#L734">734</a>
<a id="L735" class="source_line" href="#L735">735</a>
<a id="L736" class="source_line" href="#L736">736</a>
<a id="L737" class="source_line" href="#L737">737</a>
<a id="L738" class="source_line" href="#L738">738</a>
<a id="L739" class="source_line" href="#L739">739</a>
<a id="L740" class="source_line" href="#L740">740</a>
<a id="L741" class="source_line" href="#L741">741</a>
<a id="L742" class="source_line" href="#L742">742</a>
<a id="L743" class="source_line" href="#L743">743</a>
<a id="L744" class="source_line" href="#L744">744</a>
<a id="L745" class="source_line" href="#L745">745</a>
<a id="L746" class="source_line" href="#L746">746</a>
<a id="L747" class="source_line" href="#L747">747</a>
<a id="L748" class="source_line" href="#L748">748</a>
<a id="L749" class="source_line" href="#L749">749</a>
<a id="L750" class="source_line" href="#L750">750</a>
<a id="L751" class="source_line" href="#L751">751</a>
<a id="L752" class="source_line" href="#L752">752</a>
<a id="L753" class="source_line" href="#L753">753</a>
<a id="L754" class="source_line" href="#L754">754</a>
<a id="L755" class="source_line" href="#L755">755</a>
<a id="L756" class="source_line" href="#L756">756</a>
<a id="L757" class="source_line" href="#L757">757</a>
<a id="L758" class="source_line" href="#L758">758</a>
<a id="L759" class="source_line" href="#L759">759</a>
<a id="L760" class="source_line" href="#L760">760</a>
<a id="L761" class="source_line" href="#L761">761</a>
<a id="L762" class="source_line" href="#L762">762</a>
<a id="L763" class="source_line" href="#L763">763</a>
<a id="L764" class="source_line" href="#L764">764</a>
<a id="L765" class="source_line" href="#L765">765</a>
<a id="L766" class="source_line" href="#L766">766</a>
<a id="L767" class="source_line" href="#L767">767</a>
<a id="L768" class="source_line" href="#L768">768</a>
<a id="L769" class="source_line" href="#L769">769</a>
<a id="L770" class="source_line" href="#L770">770</a>
<a id="L771" class="source_line" href="#L771">771</a>
<a id="L772" class="source_line" href="#L772">772</a>
<a id="L773" class="source_line" href="#L773">773</a>
<a id="L774" class="source_line" href="#L774">774</a>
<a id="L775" class="source_line" href="#L775">775</a>
<a id="L776" class="source_line" href="#L776">776</a>
<a id="L777" class="source_line" href="#L777">777</a>
<a id="L778" class="source_line" href="#L778">778</a>
<a id="L779" class="source_line" href="#L779">779</a>
<a id="L780" class="source_line" href="#L780">780</a>
<a id="L781" class="source_line" href="#L781">781</a>
<a id="L782" class="source_line" href="#L782">782</a>
<a id="L783" class="source_line" href="#L783">783</a>
<a id="L784" class="source_line" href="#L784">784</a>
<a id="L785" class="source_line" href="#L785">785</a>
<a id="L786" class="source_line" href="#L786">786</a>
<a id="L787" class="source_line" href="#L787">787</a>
<a id="L788" class="source_line" href="#L788">788</a>
<a id="L789" class="source_line" href="#L789">789</a>
<a id="L790" class="source_line" href="#L790">790</a>
<a id="L791" class="source_line" href="#L791">791</a>
<a id="L792" class="source_line" href="#L792">792</a>
<a id="L793" class="source_line" href="#L793">793</a>
<a id="L794" class="source_line" href="#L794">794</a>
<a id="L795" class="source_line" href="#L795">795</a>
<a id="L796" class="source_line" href="#L796">796</a>
<a id="L797" class="source_line" href="#L797">797</a>
<a id="L798" class="source_line" href="#L798">798</a>
<a id="L799" class="source_line" href="#L799">799</a>
<a id="L800" class="source_line" href="#L800">800</a>
<a id="L801" class="source_line" href="#L801">801</a>
<a id="L802" class="source_line" href="#L802">802</a>
<a id="L803" class="source_line" href="#L803">803</a>
<a id="L804" class="source_line" href="#L804">804</a>
<a id="L805" class="source_line" href="#L805">805</a>
<a id="L806" class="source_line" href="#L806">806</a>
<a id="L807" class="source_line" href="#L807">807</a>
<a id="L808" class="source_line" href="#L808">808</a>
<a id="L809" class="source_line" href="#L809">809</a>
<a id="L810" class="source_line" href="#L810">810</a>
<a id="L811" class="source_line" href="#L811">811</a>
<a id="L812" class="source_line" href="#L812">812</a>
<a id="L813" class="source_line" href="#L813">813</a>
<a id="L814" class="source_line" href="#L814">814</a>
<a id="L815" class="source_line" href="#L815">815</a>
<a id="L816" class="source_line" href="#L816">816</a>
<a id="L817" class="source_line" href="#L817">817</a>
<a id="L818" class="source_line" href="#L818">818</a>
<a id="L819" class="source_line" href="#L819">819</a>
<a id="L820" class="source_line" href="#L820">820</a>
<a id="L821" class="source_line" href="#L821">821</a>
<a id="L822" class="source_line" href="#L822">822</a>
<a id="L823" class="source_line" href="#L823">823</a>
<a id="L824" class="source_line" href="#L824">824</a>
<a id="L825" class="source_line" href="#L825">825</a>
<a id="L826" class="source_line" href="#L826">826</a>
<a id="L827" class="source_line" href="#L827">827</a>
<a id="L828" class="source_line" href="#L828">828</a>
<a id="L829" class="source_line" href="#L829">829</a>
<a id="L830" class="source_line" href="#L830">830</a>
<a id="L831" class="source_line" href="#L831">831</a>
<a id="L832" class="source_line" href="#L832">832</a>
<a id="L833" class="source_line" href="#L833">833</a>
<a id="L834" class="source_line" href="#L834">834</a>
<a id="L835" class="source_line" href="#L835">835</a>
<a id="L836" class="source_line" href="#L836">836</a>
<a id="L837" class="source_line" href="#L837">837</a>
<a id="L838" class="source_line" href="#L838">838</a>
<a id="L839" class="source_line" href="#L839">839</a>
<a id="L840" class="source_line" href="#L840">840</a>
<a id="L841" class="source_line" href="#L841">841</a>
<a id="L842" class="source_line" href="#L842">842</a>
<a id="L843" class="source_line" href="#L843">843</a>
<a id="L844" class="source_line" href="#L844">844</a>
<a id="L845" class="source_line" href="#L845">845</a>
<a id="L846" class="source_line" href="#L846">846</a>
<a id="L847" class="source_line" href="#L847">847</a>
<a id="L848" class="source_line" href="#L848">848</a>
<a id="L849" class="source_line" href="#L849">849</a>
<a id="L850" class="source_line" href="#L850">850</a>
<a id="L851" class="source_line" href="#L851">851</a>
<a id="L852" class="source_line" href="#L852">852</a>
<a id="L853" class="source_line" href="#L853">853</a>
<a id="L854" class="source_line" href="#L854">854</a>
<a id="L855" class="source_line" href="#L855">855</a>
<a id="L856" class="source_line" href="#L856">856</a>
<a id="L857" class="source_line" href="#L857">857</a>
<a id="L858" class="source_line" href="#L858">858</a>
<a id="L859" class="source_line" href="#L859">859</a>
<a id="L860" class="source_line" href="#L860">860</a>
<a id="L861" class="source_line" href="#L861">861</a>
<a id="L862" class="source_line" href="#L862">862</a>
<a id="L863" class="source_line" href="#L863">863</a>
<a id="L864" class="source_line" href="#L864">864</a>
<a id="L865" class="source_line" href="#L865">865</a>
<a id="L866" class="source_line" href="#L866">866</a>
<a id="L867" class="source_line" href="#L867">867</a>
<a id="L868" class="source_line" href="#L868">868</a>
<a id="L869" class="source_line" href="#L869">869</a>
<a id="L870" class="source_line" href="#L870">870</a>
<a id="L871" class="source_line" href="#L871">871</a>
<a id="L872" class="source_line" href="#L872">872</a>
<a id="L873" class="source_line" href="#L873">873</a>
<a id="L874" class="source_line" href="#L874">874</a>
<a id="L875" class="source_line" href="#L875">875</a>
<a id="L876" class="source_line" href="#L876">876</a>
<a id="L877" class="source_line" href="#L877">877</a>
<a id="L878" class="source_line" href="#L878">878</a>
<a id="L879" class="source_line" href="#L879">879</a>
<a id="L880" class="source_line" href="#L880">880</a>
<a id="L881" class="source_line" href="#L881">881</a>
<a id="L882" class="source_line" href="#L882">882</a>
<a id="L883" class="source_line" href="#L883">883</a>
<a id="L884" class="source_line" href="#L884">884</a>
<a id="L885" class="source_line" href="#L885">885</a>
<a id="L886" class="source_line" href="#L886">886</a>
<a id="L887" class="source_line" href="#L887">887</a>
<a id="L888" class="source_line" href="#L888">888</a>
<a id="L889" class="source_line" href="#L889">889</a>
<a id="L890" class="source_line" href="#L890">890</a>
<a id="L891" class="source_line" href="#L891">891</a>
<a id="L892" class="source_line" href="#L892">892</a>
<a id="L893" class="source_line" href="#L893">893</a>
<a id="L894" class="source_line" href="#L894">894</a>
<a id="L895" class="source_line" href="#L895">895</a>
<a id="L896" class="source_line" href="#L896">896</a>
<a id="L897" class="source_line" href="#L897">897</a>
<a id="L898" class="source_line" href="#L898">898</a>
<a id="L899" class="source_line" href="#L899">899</a>
<a id="L900" class="source_line" href="#L900">900</a>
<a id="L901" class="source_line" href="#L901">901</a>
<a id="L902" class="source_line" href="#L902">902</a>
<a id="L903" class="source_line" href="#L903">903</a>
<a id="L904" class="source_line" href="#L904">904</a>
<a id="L905" class="source_line" href="#L905">905</a>
<a id="L906" class="source_line" href="#L906">906</a>
<a id="L907" class="source_line" href="#L907">907</a>
<a id="L908" class="source_line" href="#L908">908</a>
<a id="L909" class="source_line" href="#L909">909</a>
<a id="L910" class="source_line" href="#L910">910</a>
<a id="L911" class="source_line" href="#L911">911</a>
<a id="L912" class="source_line" href="#L912">912</a>
<a id="L913" class="source_line" href="#L913">913</a>
<a id="L914" class="source_line" href="#L914">914</a>
<a id="L915" class="source_line" href="#L915">915</a>
<a id="L916" class="source_line" href="#L916">916</a>
<a id="L917" class="source_line" href="#L917">917</a>
<a id="L918" class="source_line" href="#L918">918</a>
<a id="L919" class="source_line" href="#L919">919</a>
<a id="L920" class="source_line" href="#L920">920</a>
<a id="L921" class="source_line" href="#L921">921</a>
<a id="L922" class="source_line" href="#L922">922</a>
<a id="L923" class="source_line" href="#L923">923</a>
<a id="L924" class="source_line" href="#L924">924</a>
<a id="L925" class="source_line" href="#L925">925</a>
<a id="L926" class="source_line" href="#L926">926</a>
<a id="L927" class="source_line" href="#L927">927</a>
<a id="L928" class="source_line" href="#L928">928</a>
<a id="L929" class="source_line" href="#L929">929</a>
<a id="L930" class="source_line" href="#L930">930</a>
<a id="L931" class="source_line" href="#L931">931</a>
<a id="L932" class="source_line" href="#L932">932</a>
<a id="L933" class="source_line" href="#L933">933</a>
<a id="L934" class="source_line" href="#L934">934</a>
<a id="L935" class="source_line" href="#L935">935</a>
<a id="L936" class="source_line" href="#L936">936</a>
<a id="L937" class="source_line" href="#L937">937</a>
<a id="L938" class="source_line" href="#L938">938</a>
<a id="L939" class="source_line" href="#L939">939</a>
<a id="L940" class="source_line" href="#L940">940</a>
<a id="L941" class="source_line" href="#L941">941</a>
<a id="L942" class="source_line" href="#L942">942</a>
<a id="L943" class="source_line" href="#L943">943</a>
<a id="L944" class="source_line" href="#L944">944</a>
<a id="L945" class="source_line" href="#L945">945</a>
<a id="L946" class="source_line" href="#L946">946</a>
<a id="L947" class="source_line" href="#L947">947</a>
<a id="L948" class="source_line" href="#L948">948</a>
<a id="L949" class="source_line" href="#L949">949</a>
<a id="L950" class="source_line" href="#L950">950</a>
<a id="L951" class="source_line" href="#L951">951</a>
<a id="L952" class="source_line" href="#L952">952</a>
<a id="L953" class="source_line" href="#L953">953</a>
<a id="L954" class="source_line" href="#L954">954</a>
<a id="L955" class="source_line" href="#L955">955</a>
<a id="L956" class="source_line" href="#L956">956</a>
<a id="L957" class="source_line" href="#L957">957</a>
<a id="L958" class="source_line" href="#L958">958</a>
<a id="L959" class="source_line" href="#L959">959</a>
<a id="L960" class="source_line" href="#L960">960</a>
<a id="L961" class="source_line" href="#L961">961</a>
<a id="L962" class="source_line" href="#L962">962</a>
<a id="L963" class="source_line" href="#L963">963</a>
<a id="L964" class="source_line" href="#L964">964</a>
<a id="L965" class="source_line" href="#L965">965</a>
<a id="L966" class="source_line" href="#L966">966</a>
<a id="L967" class="source_line" href="#L967">967</a>
<a id="L968" class="source_line" href="#L968">968</a>
<a id="L969" class="source_line" href="#L969">969</a>
<a id="L970" class="source_line" href="#L970">970</a>
<a id="L971" class="source_line" href="#L971">971</a>
<a id="L972" class="source_line" href="#L972">972</a>
<a id="L973" class="source_line" href="#L973">973</a>
<a id="L974" class="source_line" href="#L974">974</a>
<a id="L975" class="source_line" href="#L975">975</a>
<a id="L976" class="source_line" href="#L976">976</a>
<a id="L977" class="source_line" href="#L977">977</a>
<a id="L978" class="source_line" href="#L978">978</a>
<a id="L979" class="source_line" href="#L979">979</a>
<a id="L980" class="source_line" href="#L980">980</a>
<a id="L981" class="source_line" href="#L981">981</a>
<a id="L982" class="source_line" href="#L982">982</a>
<a id="L983" class="source_line" href="#L983">983</a>
<a id="L984" class="source_line" href="#L984">984</a>
<a id="L985" class="source_line" href="#L985">985</a>
<a id="L986" class="source_line" href="#L986">986</a>
<a id="L987" class="source_line" href="#L987">987</a>
<a id="L988" class="source_line" href="#L988">988</a>
<a id="L989" class="source_line" href="#L989">989</a>
<a id="L990" class="source_line" href="#L990">990</a>
<a id="L991" class="source_line" href="#L991">991</a>
<a id="L992" class="source_line" href="#L992">992</a>
<a id="L993" class="source_line" href="#L993">993</a>
<a id="L994" class="source_line" href="#L994">994</a>
<a id="L995" class="source_line" href="#L995">995</a>
<a id="L996" class="source_line" href="#L996">996</a>
<a id="L997" class="source_line" href="#L997">997</a>
<a id="L998" class="source_line" href="#L998">998</a>
<a id="L999" class="source_line" href="#L999">999</a>
<a id="L1000" class="source_line" href="#L1000">1000</a>
<a id="L1001" class="source_line" href="#L1001">1001</a>
<a id="L1002" class="source_line" href="#L1002">1002</a>
<a id="L1003" class="source_line" href="#L1003">1003</a>
<a id="L1004" class="source_line" href="#L1004">1004</a>
<a id="L1005" class="source_line" href="#L1005">1005</a>
<a id="L1006" class="source_line" href="#L1006">1006</a>
<a id="L1007" class="source_line" href="#L1007">1007</a>
<a id="L1008" class="source_line" href="#L1008">1008</a>
<a id="L1009" class="source_line" href="#L1009">1009</a>
<a id="L1010" class="source_line" href="#L1010">1010</a>
<a id="L1011" class="source_line" href="#L1011">1011</a>
<a id="L1012" class="source_line" href="#L1012">1012</a>
<a id="L1013" class="source_line" href="#L1013">1013</a>
<a id="L1014" class="source_line" href="#L1014">1014</a>
<a id="L1015" class="source_line" href="#L1015">1015</a>
<a id="L1016" class="source_line" href="#L1016">1016</a>
<a id="L1017" class="source_line" href="#L1017">1017</a>
<a id="L1018" class="source_line" href="#L1018">1018</a>
<a id="L1019" class="source_line" href="#L1019">1019</a>
<a id="L1020" class="source_line" href="#L1020">1020</a>
<a id="L1021" class="source_line" href="#L1021">1021</a>
<a id="L1022" class="source_line" href="#L1022">1022</a>
<a id="L1023" class="source_line" href="#L1023">1023</a>
<a id="L1024" class="source_line" href="#L1024">1024</a>
<a id="L1025" class="source_line" href="#L1025">1025</a>
<a id="L1026" class="source_line" href="#L1026">1026</a>
<a id="L1027" class="source_line" href="#L1027">1027</a>
<a id="L1028" class="source_line" href="#L1028">1028</a>
<a id="L1029" class="source_line" href="#L1029">1029</a>
<a id="L1030" class="source_line" href="#L1030">1030</a>
<a id="L1031" class="source_line" href="#L1031">1031</a>
<a id="L1032" class="source_line" href="#L1032">1032</a>
<a id="L1033" class="source_line" href="#L1033">1033</a>
<a id="L1034" class="source_line" href="#L1034">1034</a>
<a id="L1035" class="source_line" href="#L1035">1035</a>
<a id="L1036" class="source_line" href="#L1036">1036</a>
<a id="L1037" class="source_line" href="#L1037">1037</a>
<a id="L1038" class="source_line" href="#L1038">1038</a>
<a id="L1039" class="source_line" href="#L1039">1039</a>
<a id="L1040" class="source_line" href="#L1040">1040</a>
<a id="L1041" class="source_line" href="#L1041">1041</a>
<a id="L1042" class="source_line" href="#L1042">1042</a>
<a id="L1043" class="source_line" href="#L1043">1043</a>
<a id="L1044" class="source_line" href="#L1044">1044</a>
<a id="L1045" class="source_line" href="#L1045">1045</a>
<a id="L1046" class="source_line" href="#L1046">1046</a>
<a id="L1047" class="source_line" href="#L1047">1047</a>
<a id="L1048" class="source_line" href="#L1048">1048</a>
<a id="L1049" class="source_line" href="#L1049">1049</a>
<a id="L1050" class="source_line" href="#L1050">1050</a>
<a id="L1051" class="source_line" href="#L1051">1051</a>
<a id="L1052" class="source_line" href="#L1052">1052</a>
<a id="L1053" class="source_line" href="#L1053">1053</a>
<a id="L1054" class="source_line" href="#L1054">1054</a>
<a id="L1055" class="source_line" href="#L1055">1055</a>
<a id="L1056" class="source_line" href="#L1056">1056</a>
<a id="L1057" class="source_line" href="#L1057">1057</a>
<a id="L1058" class="source_line" href="#L1058">1058</a>
<a id="L1059" class="source_line" href="#L1059">1059</a>
<a id="L1060" class="source_line" href="#L1060">1060</a>
<a id="L1061" class="source_line" href="#L1061">1061</a>
<a id="L1062" class="source_line" href="#L1062">1062</a>
<a id="L1063" class="source_line" href="#L1063">1063</a>
<a id="L1064" class="source_line" href="#L1064">1064</a>
<a id="L1065" class="source_line" href="#L1065">1065</a>
<a id="L1066" class="source_line" href="#L1066">1066</a>
<a id="L1067" class="source_line" href="#L1067">1067</a>
<a id="L1068" class="source_line" href="#L1068">1068</a>
<a id="L1069" class="source_line" href="#L1069">1069</a>
<a id="L1070" class="source_line" href="#L1070">1070</a>
<a id="L1071" class="source_line" href="#L1071">1071</a>
<a id="L1072" class="source_line" href="#L1072">1072</a>
<a id="L1073" class="source_line" href="#L1073">1073</a>
<a id="L1074" class="source_line" href="#L1074">1074</a>
<a id="L1075" class="source_line" href="#L1075">1075</a>
<a id="L1076" class="source_line" href="#L1076">1076</a>
<a id="L1077" class="source_line" href="#L1077">1077</a>
<a id="L1078" class="source_line" href="#L1078">1078</a>
<a id="L1079" class="source_line" href="#L1079">1079</a>
<a id="L1080" class="source_line" href="#L1080">1080</a>
<a id="L1081" class="source_line" href="#L1081">1081</a>
<a id="L1082" class="source_line" href="#L1082">1082</a>
<a id="L1083" class="source_line" href="#L1083">1083</a>
<a id="L1084" class="source_line" href="#L1084">1084</a>
<a id="L1085" class="source_line" href="#L1085">1085</a>
<a id="L1086" class="source_line" href="#L1086">1086</a>
<a id="L1087" class="source_line" href="#L1087">1087</a>
<a id="L1088" class="source_line" href="#L1088">1088</a>
<a id="L1089" class="source_line" href="#L1089">1089</a>
<a id="L1090" class="source_line" href="#L1090">1090</a>
<a id="L1091" class="source_line" href="#L1091">1091</a>
<a id="L1092" class="source_line" href="#L1092">1092</a>
<a id="L1093" class="source_line" href="#L1093">1093</a>
<a id="L1094" class="source_line" href="#L1094">1094</a>
<a id="L1095" class="source_line" href="#L1095">1095</a>
<a id="L1096" class="source_line" href="#L1096">1096</a>
</code><code class="source_code"><span><span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="EOL">
</span><span class="EOL">
</span><span id="exception-Invalidated"><span class="EXCEPTION">exception</span> <span class="UIDENT">Invalidated</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="exception-MTOInvalidated"><span class="EXCEPTION">exception</span> <span class="UIDENT">MTOInvalidated</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="type-or_replaced"><span class="TYPE">type</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="QUOTE">'</span><span class="LIDENT">b</span><span class="RPAREN">)</span> <span class="LIDENT">or_replaced</span> <span class="EQUAL">=</span> <span id="type-or_replaced.constructor-Not_replaced"><span class="UIDENT">Not_replaced</span> <span class="OF">of</span> <span class="QUOTE">'</span><span class="LIDENT">a</span></span> <span id="type-or_replaced.constructor-Replaced"><span class="BAR">|</span> <span class="UIDENT">Replaced</span> <span class="OF">of</span> <span class="QUOTE">'</span><span class="LIDENT">b</span></span></span><span class="EOL">
</span><span class="EOL">
</span><span id="type-type_or_replaced"><span class="TYPE">type</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">type_or_replaced</span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="UIDENT">TypeExpr</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="STAR">*</span> <span class="UIDENT">TypeDecl</span><span class="DOT">.</span><span class="UIDENT">Equation</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="LIDENT">or_replaced</span></span><span class="EOL">
</span><span class="EOL">
</span><span id="type-module_type_or_replaced"><span class="TYPE">type</span> <span class="QUOTE">'</span><span class="LIDENT">a</span> <span class="LIDENT">module_type_or_replaced</span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><span class="QUOTE">'</span><span class="LIDENT">a</span><span class="COMMA">,</span> <span class="UIDENT">ModuleType</span><span class="DOT">.</span><span class="LIDENT">expr</span><span class="RPAREN">)</span> <span class="LIDENT">or_replaced</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-map_replaced"><span class="LIDENT">map_replaced</span></span> <span id="local_f_1"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Not_replaced</span> <span id="local_p_2"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <span class="LPAREN">(</span><a href="#local_f_1"><span class="LIDENT">f</span></a> <a href="#local_p_2"><span class="LIDENT">p</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Replaced</span> <span class="UNDERSCORE">_</span> <span class="AS">as</span> <span id="local_r_3"><span class="LIDENT">r</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_r_3"><span class="LIDENT">r</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="EOL">
</span><span class="OPEN">open</span> <span class="UIDENT">Substitution</span><span class="EOL">
</span><span class="EOL">
</span><span id="type-t"><span class="TYPE">type</span> <span class="NONREC">nonrec</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span> <span class="LIDENT">t</span></span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-identity"><span class="LIDENT">identity</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LBRACE">{</span><span class="EOL">
</span>    <span class="LIDENT">module_</span> <span class="EQUAL">=</span> <span class="UIDENT">PathModuleMap</span><span class="DOT">.</span><span class="LIDENT">empty</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">module_type</span> <span class="EQUAL">=</span> <span class="UIDENT">ModuleTypeMap</span><span class="DOT">.</span><span class="LIDENT">empty</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">module_type_replacement</span> <span class="EQUAL">=</span> <span class="UIDENT">ModuleTypeMap</span><span class="DOT">.</span><span class="LIDENT">empty</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">type_</span> <span class="EQUAL">=</span> <span class="UIDENT">PathTypeMap</span><span class="DOT">.</span><span class="LIDENT">empty</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">class_type</span> <span class="EQUAL">=</span> <span class="UIDENT">PathClassTypeMap</span><span class="DOT">.</span><span class="LIDENT">empty</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">type_replacement</span> <span class="EQUAL">=</span> <span class="UIDENT">PathTypeMap</span><span class="DOT">.</span><span class="LIDENT">empty</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">path_invalidating_modules</span> <span class="EQUAL">=</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">module_type_of_invalidating_modules</span> <span class="EQUAL">=</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">unresolve_opaque_paths</span> <span class="EQUAL">=</span> <span class="FALSE">false</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-unresolve_opaque_paths"><span class="LIDENT">unresolve_opaque_paths</span></span> <span id="local_s_4"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_s_4"><span class="LIDENT">s</span></a> <span class="WITH">with</span> <span class="LIDENT">unresolve_opaque_paths</span> <span class="EQUAL">=</span> <span class="TRUE">true</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-path_invalidate_module"><span class="LIDENT">path_invalidate_module</span></span> <span id="local_id_5"><span class="LIDENT">id</span></span> <span id="local_t_6"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_t_6"><span class="LIDENT">t</span></a> <span class="WITH">with</span> <span class="LIDENT">path_invalidating_modules</span> <span class="EQUAL">=</span> <a href="#local_id_5"><span class="LIDENT">id</span></a> <span class="COLONCOLON">::</span> <a href="#local_t_6"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">path_invalidating_modules</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-mto_invalidate_module"><span class="LIDENT">mto_invalidate_module</span></span> <span id="local_id_7"><span class="LIDENT">id</span></span> <span id="local_t_8"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LBRACE">{</span><span class="EOL">
</span>    <a href="#local_t_8"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="LIDENT">module_type_of_invalidating_modules</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="#local_id_7"><span class="LIDENT">id</span></a> <span class="COLONCOLON">::</span> <a href="#local_t_8"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">module_type_of_invalidating_modules</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_module"><span class="LIDENT">add_module</span></span> <span id="local_id_9"><span class="LIDENT">id</span></span> <span id="local_p_10"><span class="LIDENT">p</span></span> <span id="local_rp_11"><span class="LIDENT">rp</span></span> <span id="local_t_12"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_t_12"><span class="LIDENT">t</span></a> <span class="WITH">with</span> <span class="LIDENT">module_</span> <span class="EQUAL">=</span> <span class="UIDENT">PathModuleMap</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_id_9"><span class="LIDENT">id</span></a> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Prefixed</span> <span class="LPAREN">(</span><a href="#local_p_10"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#local_rp_11"><span class="LIDENT">rp</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_t_12"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">module_</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_module_type"><span class="LIDENT">add_module_type</span></span> <span id="local_id_13"><span class="LIDENT">id</span></span> <span id="local_p_14"><span class="LIDENT">p</span></span> <span id="local_rp_15"><span class="LIDENT">rp</span></span> <span id="local_t_16"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LBRACE">{</span><span class="EOL">
</span>    <a href="#local_t_16"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="LIDENT">module_type</span> <span class="EQUAL">=</span> <span class="UIDENT">ModuleTypeMap</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_id_13"><span class="LIDENT">id</span></a> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Prefixed</span> <span class="LPAREN">(</span><a href="#local_p_14"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#local_rp_15"><span class="LIDENT">rp</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_t_16"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">module_type</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_type"><span class="LIDENT">add_type</span></span> <span class="COLON">:</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">type_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="LIDENT">type_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="UIDENT">Resolved</span><span class="DOT">.</span><span class="LIDENT">type_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_id_17"><span class="LIDENT">id</span></span> <span id="local_p_18"><span class="LIDENT">p</span></span> <span id="local_rp_19"><span class="LIDENT">rp</span></span> <span id="local_t_20"><span class="LIDENT">t</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="LBRACE">{</span><span class="EOL">
</span>    <a href="#local_t_20"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="LIDENT">type_</span> <span class="EQUAL">=</span> <span class="UIDENT">PathTypeMap</span><span class="DOT">.</span><span class="LIDENT">add</span> <span class="LPAREN">(</span><a href="#local_id_17"><span class="LIDENT">id</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_type</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Prefixed</span> <span class="LPAREN">(</span><a href="#local_p_18"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#local_rp_19"><span class="LIDENT">rp</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_t_20"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">type_</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_class"><span class="LIDENT">add_class</span></span> <span class="COLON">:</span><span class="EOL">
</span>    <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">class_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="LIDENT">class_type</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="UIDENT">Resolved</span><span class="DOT">.</span><span class="LIDENT">class_type</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_id_21"><span class="LIDENT">id</span></span> <span id="local_p_22"><span class="LIDENT">p</span></span> <span id="local_rp_23"><span class="LIDENT">rp</span></span> <span id="local_t_24"><span class="LIDENT">t</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="LBRACE">{</span><span class="EOL">
</span>    <a href="#local_t_24"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="LIDENT">type_</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="UIDENT">PathTypeMap</span><span class="DOT">.</span><span class="LIDENT">add</span><span class="EOL">
</span>        <span class="LPAREN">(</span><a href="#local_id_21"><span class="LIDENT">id</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_type</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Prefixed</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_p_22"><span class="LIDENT">p</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="LIDENT">type_</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="LPAREN">(</span><a href="#local_rp_23"><span class="LIDENT">rp</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="UIDENT">Resolved</span><span class="DOT">.</span><span class="LIDENT">type_</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_t_24"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">type_</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">class_type</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="UIDENT">PathClassTypeMap</span><span class="DOT">.</span><span class="LIDENT">add</span><span class="EOL">
</span>        <span class="LPAREN">(</span><a href="#local_id_21"><span class="LIDENT">id</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_class_type</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Prefixed</span> <span class="LPAREN">(</span><a href="#local_p_22"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#local_rp_23"><span class="LIDENT">rp</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_t_24"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">class_type</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_class_type"><span class="LIDENT">add_class_type</span></span> <span class="COLON">:</span><span class="EOL">
</span>    <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">class_type</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="LIDENT">class_type</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="UIDENT">Resolved</span><span class="DOT">.</span><span class="LIDENT">class_type</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span><span class="EOL">
</span>    <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_id_25"><span class="LIDENT">id</span></span> <span id="local_p_26"><span class="LIDENT">p</span></span> <span id="local_rp_27"><span class="LIDENT">rp</span></span> <span id="local_t_28"><span class="LIDENT">t</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="LBRACE">{</span><span class="EOL">
</span>    <a href="#local_t_28"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="LIDENT">type_</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="UIDENT">PathTypeMap</span><span class="DOT">.</span><span class="LIDENT">add</span><span class="EOL">
</span>        <span class="LPAREN">(</span><a href="#local_id_25"><span class="LIDENT">id</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_type</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Prefixed</span> <span class="LPAREN">(</span><span class="LPAREN">(</span><a href="#local_p_26"><span class="LIDENT">p</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="LIDENT">type_</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="LPAREN">(</span><a href="#local_rp_27"><span class="LIDENT">rp</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="UIDENT">Resolved</span><span class="DOT">.</span><span class="LIDENT">type_</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_t_28"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">type_</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">class_type</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="UIDENT">PathClassTypeMap</span><span class="DOT">.</span><span class="LIDENT">add</span><span class="EOL">
</span>        <span class="LPAREN">(</span><a href="#local_id_25"><span class="LIDENT">id</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_class_type</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Prefixed</span> <span class="LPAREN">(</span><a href="#local_p_26"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#local_rp_27"><span class="LIDENT">rp</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_t_28"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">class_type</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_type_replacement"><span class="LIDENT">add_type_replacement</span></span> <span id="local_id_29"><span class="LIDENT">id</span></span> <span id="local_texp_30"><span class="LIDENT">texp</span></span> <span id="local_equation_31"><span class="LIDENT">equation</span></span> <span id="local_t_32"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LBRACE">{</span><span class="EOL">
</span>    <a href="#local_t_32"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="LIDENT">type_replacement</span> <span class="EQUAL">=</span> <span class="UIDENT">PathTypeMap</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_id_29"><span class="LIDENT">id</span></a> <span class="LPAREN">(</span><a href="#local_texp_30"><span class="LIDENT">texp</span></a><span class="COMMA">,</span> <a href="#local_equation_31"><span class="LIDENT">equation</span></a><span class="RPAREN">)</span> <a href="#local_t_32"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">type_replacement</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_module_type_replacement"><span class="LIDENT">add_module_type_replacement</span></span> <span id="local_path_33"><span class="LIDENT">path</span></span> <span id="local_mty_34"><span class="LIDENT">mty</span></span> <span id="local_t_35"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LBRACE">{</span><span class="EOL">
</span>    <a href="#local_t_35"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="LIDENT">module_type_replacement</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="UIDENT">ModuleTypeMap</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_path_33"><span class="LIDENT">path</span></a> <a href="#local_mty_34"><span class="LIDENT">mty</span></a> <a href="#local_t_35"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">module_type_replacement</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-add_module_substitution"><span class="LIDENT">add_module_substitution</span></span> <span class="COLON">:</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_module</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_id_36"><span class="LIDENT">id</span></span> <span id="local_t_37"><span class="LIDENT">t</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="LBRACE">{</span><span class="EOL">
</span>    <a href="#local_t_37"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="LIDENT">module_type_of_invalidating_modules</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <a href="#local_id_36"><span class="LIDENT">id</span></a> <span class="COLONCOLON">::</span> <a href="#local_t_37"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">module_type_of_invalidating_modules</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">path_invalidating_modules</span> <span class="EQUAL">=</span> <a href="#local_id_36"><span class="LIDENT">id</span></a> <span class="COLONCOLON">::</span> <a href="#local_t_37"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">path_invalidating_modules</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">module_</span> <span class="EQUAL">=</span> <span class="UIDENT">PathModuleMap</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_id_36"><span class="LIDENT">id</span></a> <span class="BACKQUOTE">`</span><span class="UIDENT">Substituted</span> <a href="#local_t_37"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">module_</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-rename_module"><span class="LIDENT">rename_module</span></span> <span class="COLON">:</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_module</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_module</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_id_38"><span class="LIDENT">id</span></span> <span id="local_id'_39"><span class="LIDENT">id'</span></span> <span id="local_t_40"><span class="LIDENT">t</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_t_40"><span class="LIDENT">t</span></a> <span class="WITH">with</span> <span class="LIDENT">module_</span> <span class="EQUAL">=</span> <span class="UIDENT">PathModuleMap</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_id_38"><span class="LIDENT">id</span></a> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Renamed</span> <a href="#local_id'_39"><span class="LIDENT">id'</span></a><span class="RPAREN">)</span> <a href="#local_t_40"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">module_</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-rename_module_type"><span class="LIDENT">rename_module_type</span></span> <span class="COLON">:</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">module_type</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">module_type</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_id_41"><span class="LIDENT">id</span></span> <span id="local_id'_42"><span class="LIDENT">id'</span></span> <span id="local_t_43"><span class="LIDENT">t</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_t_43"><span class="LIDENT">t</span></a> <span class="WITH">with</span> <span class="LIDENT">module_type</span> <span class="EQUAL">=</span> <span class="UIDENT">ModuleTypeMap</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_id_41"><span class="LIDENT">id</span></a> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Renamed</span> <a href="#local_id'_42"><span class="LIDENT">id'</span></a><span class="RPAREN">)</span> <a href="#local_t_43"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">module_type</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-rename_type"><span class="LIDENT">rename_type</span></span> <span class="COLON">:</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_type</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_type</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_id_44"><span class="LIDENT">id</span></span> <span id="local_id'_45"><span class="LIDENT">id'</span></span> <span id="local_t_46"><span class="LIDENT">t</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LBRACE">{</span> <a href="#local_t_46"><span class="LIDENT">t</span></a> <span class="WITH">with</span> <span class="LIDENT">type_</span> <span class="EQUAL">=</span> <span class="UIDENT">PathTypeMap</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_id_44"><span class="LIDENT">id</span></a> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Renamed</span> <a href="#local_id'_45"><span class="LIDENT">id'</span></a><span class="RPAREN">)</span> <a href="#local_t_46"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">type_</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-rename_class_type"><span class="LIDENT">rename_class_type</span></span> <span class="COLON">:</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_class_type</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_class_type</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">t</span><span class="EOL">
</span>    <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_id_47"><span class="LIDENT">id</span></span> <span id="local_id'_48"><span class="LIDENT">id'</span></span> <span id="local_t_49"><span class="LIDENT">t</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="LBRACE">{</span><span class="EOL">
</span>    <a href="#local_t_49"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="LIDENT">class_type</span> <span class="EQUAL">=</span> <span class="UIDENT">PathClassTypeMap</span><span class="DOT">.</span><span class="LIDENT">add</span> <a href="#local_id_47"><span class="LIDENT">id</span></a> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Renamed</span> <a href="#local_id'_48"><span class="LIDENT">id'</span></a><span class="RPAREN">)</span> <a href="#local_t_49"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">class_type</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">type_</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="UIDENT">PathTypeMap</span><span class="DOT">.</span><span class="LIDENT">add</span><span class="EOL">
</span>        <span class="LPAREN">(</span><a href="#local_id_47"><span class="LIDENT">id</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_type</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Renamed</span> <span class="LPAREN">(</span><a href="#local_id'_48"><span class="LIDENT">id'</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_type</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_t_49"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">type_</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-substitute_vars"><span class="LIDENT">substitute_vars</span></span> <span id="local_vars_50"><span class="LIDENT">vars</span></span> <span id="local_t_51"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">TypeExpr</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_t_51"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Var</span> <span id="local_s_52"><span class="LIDENT">s</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span> <span class="TRY">try</span> <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">assoc</span> <a href="#local_s_52"><span class="LIDENT">s</span></a> <a href="#local_vars_50"><span class="LIDENT">vars</span></a> <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_t_51"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Any</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Any</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Alias</span> <span class="LPAREN">(</span><span id="local_t_53"><span class="LIDENT">t</span></span><span class="COMMA">,</span> <span id="local_str_54"><span class="LIDENT">str</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Alias</span> <span class="LPAREN">(</span><a href="#val-substitute_vars"><span class="LIDENT">substitute_vars</span></a> <a href="#local_vars_50"><span class="LIDENT">vars</span></a> <a href="#local_t_53"><span class="LIDENT">t</span></a><span class="COMMA">,</span> <a href="#local_str_54"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Arrow</span> <span class="LPAREN">(</span><span id="local_lbl_55"><span class="LIDENT">lbl</span></span><span class="COMMA">,</span> <span id="local_t1_56"><span class="LIDENT">t1</span></span><span class="COMMA">,</span> <span id="local_t2_57"><span class="LIDENT">t2</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="UIDENT">Arrow</span> <span class="LPAREN">(</span><a href="#local_lbl_55"><span class="LIDENT">lbl</span></a><span class="COMMA">,</span> <a href="#val-substitute_vars"><span class="LIDENT">substitute_vars</span></a> <a href="#local_vars_50"><span class="LIDENT">vars</span></a> <a href="#local_t1_56"><span class="LIDENT">t1</span></a><span class="COMMA">,</span> <a href="#val-substitute_vars"><span class="LIDENT">substitute_vars</span></a> <a href="#local_vars_50"><span class="LIDENT">vars</span></a> <a href="#local_t2_57"><span class="LIDENT">t2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Tuple</span> <span id="local_ts_58"><span class="LIDENT">ts</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Tuple</span> <span class="LPAREN">(</span><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span> <span class="LPAREN">(</span><a href="#val-substitute_vars"><span class="LIDENT">substitute_vars</span></a> <a href="#local_vars_50"><span class="LIDENT">vars</span></a><span class="RPAREN">)</span> <a href="#local_ts_58"><span class="LIDENT">ts</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Constr</span> <span class="LPAREN">(</span><span id="local_p_59"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_ts_60"><span class="LIDENT">ts</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Constr</span> <span class="LPAREN">(</span><a href="#local_p_59"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span> <span class="LPAREN">(</span><a href="#val-substitute_vars"><span class="LIDENT">substitute_vars</span></a> <a href="#local_vars_50"><span class="LIDENT">vars</span></a><span class="RPAREN">)</span> <a href="#local_ts_60"><span class="LIDENT">ts</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Polymorphic_variant</span> <span id="local_v_61"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="UIDENT">Polymorphic_variant</span> <span class="LPAREN">(</span><a href="#val-substitute_vars_poly_variant"><span class="LIDENT">substitute_vars_poly_variant</span></a> <a href="#local_vars_50"><span class="LIDENT">vars</span></a> <a href="#local_v_61"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Object</span> <span id="local_o_62"><span class="LIDENT">o</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Object</span> <span class="LPAREN">(</span><a href="#val-substitute_vars_type_object"><span class="LIDENT">substitute_vars_type_object</span></a> <a href="#local_vars_50"><span class="LIDENT">vars</span></a> <a href="#local_o_62"><span class="LIDENT">o</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Class</span> <span class="LPAREN">(</span><span id="local_p_63"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_ts_64"><span class="LIDENT">ts</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Class</span> <span class="LPAREN">(</span><a href="#local_p_63"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span> <span class="LPAREN">(</span><a href="#val-substitute_vars"><span class="LIDENT">substitute_vars</span></a> <a href="#local_vars_50"><span class="LIDENT">vars</span></a><span class="RPAREN">)</span> <a href="#local_ts_64"><span class="LIDENT">ts</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Poly</span> <span class="LPAREN">(</span><span id="local_strs_65"><span class="LIDENT">strs</span></span><span class="COMMA">,</span> <span id="local_ts_66"><span class="LIDENT">ts</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Poly</span> <span class="LPAREN">(</span><a href="#local_strs_65"><span class="LIDENT">strs</span></a><span class="COMMA">,</span> <a href="#val-substitute_vars"><span class="LIDENT">substitute_vars</span></a> <a href="#local_vars_50"><span class="LIDENT">vars</span></a> <a href="#local_ts_66"><span class="LIDENT">ts</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Package</span> <span id="local_p_67"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Package</span> <span class="LPAREN">(</span><a href="#val-substitute_vars_package"><span class="LIDENT">substitute_vars_package</span></a> <a href="#local_vars_50"><span class="LIDENT">vars</span></a> <a href="#local_p_67"><span class="LIDENT">p</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-substitute_vars_package"><span class="LIDENT">substitute_vars_package</span></span> <span id="local_vars_68"><span class="LIDENT">vars</span></span> <span id="local_p_69"><span class="LIDENT">p</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">TypeExpr</span><span class="DOT">.</span><span class="UIDENT">Package</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_subst_subst_70"><span class="LIDENT">subst_subst</span></span> <span class="LPAREN">(</span><span id="local_p_71"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_t_72"><span class="LIDENT">t</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="#local_p_71"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#val-substitute_vars"><span class="LIDENT">substitute_vars</span></a> <a href="#local_vars_68"><span class="LIDENT">vars</span></a> <a href="#local_t_72"><span class="LIDENT">t</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_p_69"><span class="LIDENT">p</span></a> <span class="WITH">with</span> <span class="LIDENT">substitutions</span> <span class="EQUAL">=</span> <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span> <a href="#local_subst_subst_70"><span class="LIDENT">subst_subst</span></a> <a href="#local_p_69"><span class="LIDENT">p</span></a><span class="DOT">.</span><span class="LIDENT">substitutions</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-substitute_vars_type_object"><span class="LIDENT">substitute_vars_type_object</span></span> <span id="local_vars_73"><span class="LIDENT">vars</span></span> <span id="local_o_74"><span class="LIDENT">o</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">TypeExpr</span><span class="DOT">.</span><span class="UIDENT">Object</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_subst_field_75"><span class="LIDENT">subst_field</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Method</span> <span id="local_m_76"><span class="LIDENT">m</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Method</span> <span class="LBRACE">{</span> <a href="#local_m_76"><span class="LIDENT">m</span></a> <span class="WITH">with</span> <span class="LIDENT">type_</span> <span class="EQUAL">=</span> <a href="#val-substitute_vars"><span class="LIDENT">substitute_vars</span></a> <a href="#local_vars_73"><span class="LIDENT">vars</span></a> <a href="#local_m_76"><span class="LIDENT">m</span></a><span class="DOT">.</span><span class="LIDENT">type_</span> <span class="RBRACE">}</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Inherit</span> <span id="local_t_77"><span class="LIDENT">t</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Inherit</span> <span class="LPAREN">(</span><a href="#val-substitute_vars"><span class="LIDENT">substitute_vars</span></a> <a href="#local_vars_73"><span class="LIDENT">vars</span></a> <a href="#local_t_77"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_o_74"><span class="LIDENT">o</span></a> <span class="WITH">with</span> <span class="LIDENT">fields</span> <span class="EQUAL">=</span> <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span> <a href="#local_subst_field_75"><span class="LIDENT">subst_field</span></a> <a href="#local_o_74"><span class="LIDENT">o</span></a><span class="DOT">.</span><span class="LIDENT">fields</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-substitute_vars_poly_variant"><span class="LIDENT">substitute_vars_poly_variant</span></span> <span id="local_vars_78"><span class="LIDENT">vars</span></span> <span id="local_v_79"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">TypeExpr</span><span class="DOT">.</span><span class="UIDENT">Polymorphic_variant</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_subst_element_80"><span class="LIDENT">subst_element</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Type</span> <span id="local_t_81"><span class="LIDENT">t</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Type</span> <span class="LPAREN">(</span><a href="#val-substitute_vars"><span class="LIDENT">substitute_vars</span></a> <a href="#local_vars_78"><span class="LIDENT">vars</span></a> <a href="#local_t_81"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Constructor</span> <span id="local_c_82"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_arguments_83"><span class="LIDENT">arguments</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>          <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span> <span class="LPAREN">(</span><a href="#val-substitute_vars"><span class="LIDENT">substitute_vars</span></a> <a href="#local_vars_78"><span class="LIDENT">vars</span></a><span class="RPAREN">)</span> <a href="#local_c_82"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="UIDENT">Constructor</span><span class="DOT">.</span><span class="LIDENT">arguments</span><span class="EOL">
</span>        <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Constructor</span> <span class="LBRACE">{</span> <a href="#local_c_82"><span class="LIDENT">c</span></a> <span class="WITH">with</span> <a href="#local_arguments_83"><span class="LIDENT">arguments</span></a> <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_v_79"><span class="LIDENT">v</span></a> <span class="WITH">with</span> <span class="LIDENT">elements</span> <span class="EQUAL">=</span> <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span> <a href="#local_subst_element_80"><span class="LIDENT">subst_element</span></a> <a href="#local_v_79"><span class="LIDENT">v</span></a><span class="DOT">.</span><span class="LIDENT">elements</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-resolved_module_path"><span class="LIDENT">resolved_module_path</span></span> <span class="COLON">:</span><span class="EOL">
</span>    <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="UIDENT">Resolved</span><span class="DOT">.</span><span class="LIDENT">module_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="UIDENT">Resolved</span><span class="DOT">.</span><span class="LIDENT">module_</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_s_84"><span class="LIDENT">s</span></span> <span id="local_p_85"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_p_85"><span class="LIDENT">p</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <span id="local_id_86"><span class="LIDENT">id</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="IF">if</span> <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">mem</span> <a href="#local_id_86"><span class="LIDENT">id</span></a> <a href="#local_s_84"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">path_invalidating_modules</span> <span class="THEN">then</span> <span class="LIDENT">raise</span> <span class="UIDENT">Invalidated</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="MATCH">match</span><span class="EOL">
</span>        <span class="TRY">try</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="UIDENT">PathModuleMap</span><span class="DOT">.</span><span class="LIDENT">find</span> <span class="LPAREN">(</span><a href="#local_id_86"><span class="LIDENT">id</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_module</span><span class="RPAREN">)</span> <a href="#local_s_84"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">module_</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="WITH">with</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>      <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Renamed</span> <span id="local_x_87"><span class="LIDENT">x</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <a href="#local_x_87"><span class="LIDENT">x</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Prefixed</span> <span class="LPAREN">(</span><span id="local__p_88"><span class="LIDENT">_p</span></span><span class="COMMA">,</span> <span id="local_rp_89"><span class="LIDENT">rp</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_rp_89"><span class="LIDENT">rp</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Substituted</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Substituted</span> <a href="#local_p_85"><span class="LIDENT">p</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_p_85"><span class="LIDENT">p</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Gpath</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_p_85"><span class="LIDENT">p</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Apply</span> <span class="LPAREN">(</span><span id="local_p1_90"><span class="LIDENT">p1</span></span><span class="COMMA">,</span> <span id="local_p2_91"><span class="LIDENT">p2</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="BACKQUOTE">`</span><span class="UIDENT">Apply</span> <span class="LPAREN">(</span><a href="#val-resolved_module_path"><span class="LIDENT">resolved_module_path</span></a> <a href="#local_s_84"><span class="LIDENT">s</span></a> <a href="#local_p1_90"><span class="LIDENT">p1</span></a><span class="COMMA">,</span> <a href="#val-resolved_module_path"><span class="LIDENT">resolved_module_path</span></a> <a href="#local_s_84"><span class="LIDENT">s</span></a> <a href="#local_p2_91"><span class="LIDENT">p2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Substituted</span> <span id="local_p_92"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Substituted</span> <span class="LPAREN">(</span><a href="#val-resolved_module_path"><span class="LIDENT">resolved_module_path</span></a> <a href="#local_s_84"><span class="LIDENT">s</span></a> <a href="#local_p_92"><span class="LIDENT">p</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Module</span> <span class="LPAREN">(</span><span id="local_p_93"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_n_94"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Module</span> <span class="LPAREN">(</span><a href="#val-resolved_parent_path"><span class="LIDENT">resolved_parent_path</span></a> <a href="#local_s_84"><span class="LIDENT">s</span></a> <a href="#local_p_93"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#local_n_94"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Alias</span> <span class="LPAREN">(</span><span id="local_p1_95"><span class="LIDENT">p1</span></span><span class="COMMA">,</span> <span id="local_p2_96"><span class="LIDENT">p2</span></span><span class="COMMA">,</span> <span id="local_p3opt_97"><span class="LIDENT">p3opt</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_p2'_98"><span class="LIDENT">p2'</span></span> <span class="EQUAL">=</span> <a href="#val-module_path"><span class="LIDENT">module_path</span></a> <a href="#local_s_84"><span class="LIDENT">s</span></a> <a href="#local_p2_96"><span class="LIDENT">p2</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_up2'_99"><span class="LIDENT">up2'</span></span> <span class="EQUAL">=</span> <span class="TRY">try</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="LIDENT">unresolve_module_path</span> <a href="#local_p2'_98"><span class="LIDENT">p2'</span></a> <span class="WITH">with</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_p2'_98"><span class="LIDENT">p2'</span></a> <span class="IN">in</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_p3opt'_100"><span class="LIDENT">p3opt'</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="#local_p3opt_97"><span class="LIDENT">p3opt</span></a> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Some</span> <span id="local_p3_101"><span class="LIDENT">p3</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="#val-resolved_module_path"><span class="LIDENT">resolved_module_path</span></a> <a href="#local_s_84"><span class="LIDENT">s</span></a> <a href="#local_p3_101"><span class="LIDENT">p3</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>      <span class="IN">in</span><span class="EOL">
</span>      <span class="BACKQUOTE">`</span><span class="UIDENT">Alias</span> <span class="LPAREN">(</span><a href="#val-resolved_module_path"><span class="LIDENT">resolved_module_path</span></a> <a href="#local_s_84"><span class="LIDENT">s</span></a> <a href="#local_p1_95"><span class="LIDENT">p1</span></a><span class="COMMA">,</span> <a href="#local_up2'_99"><span class="LIDENT">up2'</span></a><span class="COMMA">,</span> <a href="#local_p3opt'_100"><span class="LIDENT">p3opt'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Subst</span> <span class="LPAREN">(</span><span id="local_p1_102"><span class="LIDENT">p1</span></span><span class="COMMA">,</span> <span id="local_p2_103"><span class="LIDENT">p2</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_p1_104"><span class="LIDENT">p1</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="#val-resolved_module_type_path"><span class="LIDENT">resolved_module_type_path</span></a> <a href="#local_s_84"><span class="LIDENT">s</span></a> <a href="#local_p1_102"><span class="LIDENT">p1</span></a> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Replaced</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>            <span class="COMMENT">(* the left hand side of Subst is a named module type inside a module,
               it cannot be substituted away *)</span><span class="EOL">
</span>            <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Not_replaced</span> <span id="local_p1_105"><span class="LIDENT">p1</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_p1_105"><span class="LIDENT">p1</span></a><span class="EOL">
</span>      <span class="IN">in</span><span class="EOL">
</span>      <span class="BACKQUOTE">`</span><span class="UIDENT">Subst</span> <span class="LPAREN">(</span><a href="#local_p1_104"><span class="LIDENT">p1</span></a><span class="COMMA">,</span> <a href="#val-resolved_module_path"><span class="LIDENT">resolved_module_path</span></a> <a href="#local_s_84"><span class="LIDENT">s</span></a> <a href="#local_p2_103"><span class="LIDENT">p2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Hidden</span> <span id="local_p1_106"><span class="LIDENT">p1</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Hidden</span> <span class="LPAREN">(</span><a href="#val-resolved_module_path"><span class="LIDENT">resolved_module_path</span></a> <a href="#local_s_84"><span class="LIDENT">s</span></a> <a href="#local_p1_106"><span class="LIDENT">p1</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Canonical</span> <span class="LPAREN">(</span><span id="local_p1_107"><span class="LIDENT">p1</span></span><span class="COMMA">,</span> <span id="local_p2_108"><span class="LIDENT">p2</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Canonical</span> <span class="LPAREN">(</span><a href="#val-resolved_module_path"><span class="LIDENT">resolved_module_path</span></a> <a href="#local_s_84"><span class="LIDENT">s</span></a> <a href="#local_p1_107"><span class="LIDENT">p1</span></a><span class="COMMA">,</span> <a href="#local_p2_108"><span class="LIDENT">p2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">OpaqueModule</span> <span id="local_m_109"><span class="LIDENT">m</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_s_84"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">unresolve_opaque_paths</span> <span class="THEN">then</span> <span class="LIDENT">raise</span> <span class="UIDENT">Invalidated</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="BACKQUOTE">`</span><span class="UIDENT">OpaqueModule</span> <span class="LPAREN">(</span><a href="#val-resolved_module_path"><span class="LIDENT">resolved_module_path</span></a> <a href="#local_s_84"><span class="LIDENT">s</span></a> <a href="#local_m_109"><span class="LIDENT">m</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-resolved_parent_path"><span class="LIDENT">resolved_parent_path</span></span> <span id="local_s_110"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Module</span> <span id="local_m_111"><span class="LIDENT">m</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Module</span> <span class="LPAREN">(</span><a href="#val-resolved_module_path"><span class="LIDENT">resolved_module_path</span></a> <a href="#local_s_110"><span class="LIDENT">s</span></a> <a href="#local_m_111"><span class="LIDENT">m</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">ModuleType</span> <span id="local_m_112"><span class="LIDENT">m</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_p_113"><span class="LIDENT">p</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="#val-resolved_module_type_path"><span class="LIDENT">resolved_module_type_path</span></a> <a href="#local_s_110"><span class="LIDENT">s</span></a> <a href="#local_m_112"><span class="LIDENT">m</span></a> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Replaced</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Not_replaced</span> <span id="local_p1_114"><span class="LIDENT">p1</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_p1_114"><span class="LIDENT">p1</span></a><span class="EOL">
</span>      <span class="IN">in</span><span class="EOL">
</span>      <span class="BACKQUOTE">`</span><span class="UIDENT">ModuleType</span> <a href="#local_p_113"><span class="LIDENT">p</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">FragmentRoot</span> <span class="AS">as</span> <span id="local_x_115"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_115"><span class="LIDENT">x</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-module_path"><span class="LIDENT">module_path</span></span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="LIDENT">module_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="LIDENT">module_</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_s_116"><span class="LIDENT">s</span></span> <span id="local_p_117"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_p_117"><span class="LIDENT">p</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Resolved</span> <span id="local_p'_118"><span class="LIDENT">p'</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="TRY">try</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Resolved</span> <span class="LPAREN">(</span><a href="#val-resolved_module_path"><span class="LIDENT">resolved_module_path</span></a> <a href="#local_s_116"><span class="LIDENT">s</span></a> <a href="#local_p'_118"><span class="LIDENT">p'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Invalidated</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_path'_119"><span class="LIDENT">path'</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="LIDENT">unresolve_resolved_module_path</span> <a href="#local_p'_118"><span class="LIDENT">p'</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#val-module_path"><span class="LIDENT">module_path</span></a> <a href="#local_s_116"><span class="LIDENT">s</span></a> <a href="#local_path'_119"><span class="LIDENT">path'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Dot</span> <span class="LPAREN">(</span><span id="local_p'_120"><span class="LIDENT">p'</span></span><span class="COMMA">,</span> <span id="local_str_121"><span class="LIDENT">str</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Dot</span> <span class="LPAREN">(</span><a href="#val-module_path"><span class="LIDENT">module_path</span></a> <a href="#local_s_116"><span class="LIDENT">s</span></a> <a href="#local_p'_120"><span class="LIDENT">p'</span></a><span class="COMMA">,</span> <a href="#local_str_121"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Module</span> <span class="LPAREN">(</span><span id="local_p'_122"><span class="LIDENT">p'</span></span><span class="COMMA">,</span> <span id="local_str_123"><span class="LIDENT">str</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Module</span> <span class="LPAREN">(</span><a href="#val-resolved_parent_path"><span class="LIDENT">resolved_parent_path</span></a> <a href="#local_s_116"><span class="LIDENT">s</span></a> <a href="#local_p'_122"><span class="LIDENT">p'</span></a><span class="COMMA">,</span> <a href="#local_str_123"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Apply</span> <span class="LPAREN">(</span><span id="local_p1_124"><span class="LIDENT">p1</span></span><span class="COMMA">,</span> <span id="local_p2_125"><span class="LIDENT">p2</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Apply</span> <span class="LPAREN">(</span><a href="#val-module_path"><span class="LIDENT">module_path</span></a> <a href="#local_s_116"><span class="LIDENT">s</span></a> <a href="#local_p1_124"><span class="LIDENT">p1</span></a><span class="COMMA">,</span> <a href="#val-module_path"><span class="LIDENT">module_path</span></a> <a href="#local_s_116"><span class="LIDENT">s</span></a> <a href="#local_p2_125"><span class="LIDENT">p2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <span class="LPAREN">(</span><span id="local_id_126"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_b_127"><span class="LIDENT">b</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="MATCH">match</span><span class="EOL">
</span>        <span class="TRY">try</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="UIDENT">PathModuleMap</span><span class="DOT">.</span><span class="LIDENT">find</span> <span class="LPAREN">(</span><a href="#local_id_126"><span class="LIDENT">id</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_module</span><span class="RPAREN">)</span> <a href="#local_s_116"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">module_</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="WITH">with</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>      <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Prefixed</span> <span class="LPAREN">(</span><span id="local_p_128"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local__rp_129"><span class="LIDENT">_rp</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_p_128"><span class="LIDENT">p</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Renamed</span> <span id="local_x_130"><span class="LIDENT">x</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <span class="LPAREN">(</span><a href="#local_x_130"><span class="LIDENT">x</span></a><span class="COMMA">,</span> <a href="#local_b_127"><span class="LIDENT">b</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Substituted</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Substituted</span> <a href="#local_p_117"><span class="LIDENT">p</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <span class="LPAREN">(</span><a href="#local_id_126"><span class="LIDENT">id</span></a><span class="COMMA">,</span> <a href="#local_b_127"><span class="LIDENT">b</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Identifier</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_p_117"><span class="LIDENT">p</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Substituted</span> <span id="local_p_131"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Substituted</span> <span class="LPAREN">(</span><a href="#val-module_path"><span class="LIDENT">module_path</span></a> <a href="#local_s_116"><span class="LIDENT">s</span></a> <a href="#local_p_131"><span class="LIDENT">p</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Forward</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_p_117"><span class="LIDENT">p</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Root</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_p_117"><span class="LIDENT">p</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-resolved_module_type_path"><span class="LIDENT">resolved_module_type_path</span></span> <span class="COLON">:</span><span class="EOL">
</span>    <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="UIDENT">Resolved</span><span class="DOT">.</span><span class="LIDENT">module_type</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="UIDENT">Resolved</span><span class="DOT">.</span><span class="LIDENT">module_type</span><span class="COMMA">,</span> <span class="UIDENT">ModuleType</span><span class="DOT">.</span><span class="LIDENT">expr</span><span class="RPAREN">)</span> <span class="LIDENT">or_replaced</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_s_132"><span class="LIDENT">s</span></span> <span id="local_p_133"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_p_133"><span class="LIDENT">p</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <span id="local_id_134"><span class="LIDENT">id</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="IF">if</span> <span class="UIDENT">ModuleTypeMap</span><span class="DOT">.</span><span class="LIDENT">mem</span> <a href="#local_id_134"><span class="LIDENT">id</span></a> <a href="#local_s_132"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">module_type_replacement</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="UIDENT">Replaced</span> <span class="LPAREN">(</span><span class="UIDENT">ModuleTypeMap</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_id_134"><span class="LIDENT">id</span></a> <a href="#local_s_132"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">module_type_replacement</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="MATCH">match</span> <span class="UIDENT">ModuleTypeMap</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_id_134"><span class="LIDENT">id</span></a> <a href="#local_s_132"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">module_type</span> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Prefixed</span> <span class="LPAREN">(</span><span id="local__p_135"><span class="LIDENT">_p</span></span><span class="COMMA">,</span> <span id="local_rp_136"><span class="LIDENT">rp</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <a href="#local_rp_136"><span class="LIDENT">rp</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Renamed</span> <span id="local_x_137"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <a href="#local_x_137"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="EXCEPTION">exception</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <a href="#local_id_134"><span class="LIDENT">id</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Gpath</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <a href="#local_p_133"><span class="LIDENT">p</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Substituted</span> <span id="local_p_138"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#val-resolved_module_type_path"><span class="LIDENT">resolved_module_type_path</span></a> <a href="#local_s_132"><span class="LIDENT">s</span></a> <a href="#local_p_138"><span class="LIDENT">p</span></a> <span class="INFIXOP0">|&gt;</span> <a href="#val-map_replaced"><span class="LIDENT">map_replaced</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_p_139"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Substituted</span> <a href="#local_p_139"><span class="LIDENT">p</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">ModuleType</span> <span class="LPAREN">(</span><span id="local_p_140"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_n_141"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="UIDENT">Not_replaced</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">ModuleType</span> <span class="LPAREN">(</span><a href="#val-resolved_parent_path"><span class="LIDENT">resolved_parent_path</span></a> <a href="#local_s_132"><span class="LIDENT">s</span></a> <a href="#local_p_140"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#local_n_141"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">CanonicalModuleType</span> <span class="LPAREN">(</span><span id="local_mt1_142"><span class="LIDENT">mt1</span></span><span class="COMMA">,</span> <span id="local_mt2_143"><span class="LIDENT">mt2</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#val-resolved_module_type_path"><span class="LIDENT">resolved_module_type_path</span></a> <a href="#local_s_132"><span class="LIDENT">s</span></a> <a href="#local_mt1_142"><span class="LIDENT">mt1</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Not_replaced</span> <span id="local_mt1'_144"><span class="LIDENT">mt1'</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">CanonicalModuleType</span> <span class="LPAREN">(</span><a href="#local_mt1'_144"><span class="LIDENT">mt1'</span></a><span class="COMMA">,</span> <a href="#local_mt2_143"><span class="LIDENT">mt2</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_x_145"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_145"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">OpaqueModuleType</span> <span id="local_m_146"><span class="LIDENT">m</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#local_s_132"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">unresolve_opaque_paths</span> <span class="THEN">then</span> <span class="LIDENT">raise</span> <span class="UIDENT">Invalidated</span><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <a href="#val-resolved_module_type_path"><span class="LIDENT">resolved_module_type_path</span></a> <a href="#local_s_132"><span class="LIDENT">s</span></a> <a href="#local_m_146"><span class="LIDENT">m</span></a><span class="EOL">
</span>        <span class="INFIXOP0">|&gt;</span> <a href="#val-map_replaced"><span class="LIDENT">map_replaced</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_x_147"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">OpaqueModuleType</span> <a href="#local_x_147"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">SubstT</span> <span class="LPAREN">(</span><span id="local_p1_148"><span class="LIDENT">p1</span></span><span class="COMMA">,</span> <span id="local_p2_149"><span class="LIDENT">p2</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="MATCH">match</span><span class="EOL">
</span>        <span class="LPAREN">(</span><a href="#val-resolved_module_type_path"><span class="LIDENT">resolved_module_type_path</span></a> <a href="#local_s_132"><span class="LIDENT">s</span></a> <a href="#local_p1_148"><span class="LIDENT">p1</span></a><span class="COMMA">,</span> <a href="#val-resolved_module_type_path"><span class="LIDENT">resolved_module_type_path</span></a> <a href="#local_s_132"><span class="LIDENT">s</span></a> <a href="#local_p2_149"><span class="LIDENT">p2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Not_replaced</span> <span id="local_p1_150"><span class="LIDENT">p1</span></span><span class="COMMA">,</span> <span class="UIDENT">Not_replaced</span> <span id="local_p2_151"><span class="LIDENT">p2</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">SubstT</span> <span class="LPAREN">(</span><a href="#local_p1_150"><span class="LIDENT">p1</span></a><span class="COMMA">,</span> <a href="#local_p2_151"><span class="LIDENT">p2</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Replaced</span> <span id="local_mt_152"><span class="LIDENT">mt</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">Replaced</span> <span id="local_mt_153"><span class="LIDENT">mt</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Replaced</span> <a href="#local_mt_153"><span class="LIDENT">mt</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">AliasModuleType</span> <span class="LPAREN">(</span><span id="local_p1_154"><span class="LIDENT">p1</span></span><span class="COMMA">,</span> <span id="local_p2_155"><span class="LIDENT">p2</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="MATCH">match</span><span class="EOL">
</span>        <span class="LPAREN">(</span><a href="#val-resolved_module_type_path"><span class="LIDENT">resolved_module_type_path</span></a> <a href="#local_s_132"><span class="LIDENT">s</span></a> <a href="#local_p1_154"><span class="LIDENT">p1</span></a><span class="COMMA">,</span> <a href="#val-resolved_module_type_path"><span class="LIDENT">resolved_module_type_path</span></a> <a href="#local_s_132"><span class="LIDENT">s</span></a> <a href="#local_p2_155"><span class="LIDENT">p2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Not_replaced</span> <span id="local_p1_156"><span class="LIDENT">p1</span></span><span class="COMMA">,</span> <span class="UIDENT">Not_replaced</span> <span id="local_p2_157"><span class="LIDENT">p2</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="UIDENT">Not_replaced</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">AliasModuleType</span> <span class="LPAREN">(</span><a href="#local_p1_156"><span class="LIDENT">p1</span></a><span class="COMMA">,</span> <a href="#local_p2_157"><span class="LIDENT">p2</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Replaced</span> <span id="local_mt_158"><span class="LIDENT">mt</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span> <span class="BAR">|</span> <span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UIDENT">Replaced</span> <span id="local_mt_159"><span class="LIDENT">mt</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Replaced</span> <a href="#local_mt_159"><span class="LIDENT">mt</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-module_type_path"><span class="LIDENT">module_type_path</span></span> <span class="COLON">:</span><span class="EOL">
</span>    <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="LIDENT">module_type</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="LIDENT">module_type</span> <span class="LIDENT">module_type_or_replaced</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_s_160"><span class="LIDENT">s</span></span> <span id="local_p_161"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_p_161"><span class="LIDENT">p</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Resolved</span> <span id="local_r_162"><span class="LIDENT">r</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="TRY">try</span> <a href="#val-resolved_module_type_path"><span class="LIDENT">resolved_module_type_path</span></a> <a href="#local_s_160"><span class="LIDENT">s</span></a> <a href="#local_r_162"><span class="LIDENT">r</span></a> <span class="INFIXOP0">|&gt;</span> <a href="#val-map_replaced"><span class="LIDENT">map_replaced</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_r_163"><span class="LIDENT">r</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Resolved</span> <a href="#local_r_163"><span class="LIDENT">r</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Invalidated</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_path'_164"><span class="LIDENT">path'</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="LIDENT">unresolve_resolved_module_type_path</span> <a href="#local_r_162"><span class="LIDENT">r</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#val-module_type_path"><span class="LIDENT">module_type_path</span></a> <a href="#local_s_160"><span class="LIDENT">s</span></a> <a href="#local_path'_164"><span class="LIDENT">path'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Substituted</span> <span id="local_p_165"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#val-module_type_path"><span class="LIDENT">module_type_path</span></a> <a href="#local_s_160"><span class="LIDENT">s</span></a> <a href="#local_p_165"><span class="LIDENT">p</span></a> <span class="INFIXOP0">|&gt;</span> <a href="#val-map_replaced"><span class="LIDENT">map_replaced</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_r_166"><span class="LIDENT">r</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Substituted</span> <a href="#local_r_166"><span class="LIDENT">r</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <span class="LPAREN">(</span><span id="local_id_167"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_b_168"><span class="LIDENT">b</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="IF">if</span> <span class="UIDENT">ModuleTypeMap</span><span class="DOT">.</span><span class="LIDENT">mem</span> <a href="#local_id_167"><span class="LIDENT">id</span></a> <a href="#local_s_160"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">module_type_replacement</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="UIDENT">Replaced</span> <span class="LPAREN">(</span><span class="UIDENT">ModuleTypeMap</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_id_167"><span class="LIDENT">id</span></a> <a href="#local_s_160"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">module_type_replacement</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_r_169"><span class="LIDENT">r</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>          <span class="MATCH">match</span><span class="EOL">
</span>            <span class="TRY">try</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="UIDENT">ModuleTypeMap</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_id_167"><span class="LIDENT">id</span></a> <a href="#local_s_160"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">module_type</span><span class="RPAREN">)</span> <span class="WITH">with</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>          <span class="WITH">with</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Prefixed</span> <span class="LPAREN">(</span><span id="local_p_170"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local__rp_171"><span class="LIDENT">_rp</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_p_170"><span class="LIDENT">p</span></a><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Renamed</span> <span id="local_x_172"><span class="LIDENT">x</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <span class="LPAREN">(</span><a href="#local_x_172"><span class="LIDENT">x</span></a><span class="COMMA">,</span> <a href="#local_b_168"><span class="LIDENT">b</span></a><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <span class="LPAREN">(</span><a href="#local_id_167"><span class="LIDENT">id</span></a><span class="COMMA">,</span> <a href="#local_b_168"><span class="LIDENT">b</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="IN">in</span><span class="EOL">
</span>        <span class="UIDENT">Not_replaced</span> <a href="#local_r_169"><span class="LIDENT">r</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Identifier</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <a href="#local_p_161"><span class="LIDENT">p</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Dot</span> <span class="LPAREN">(</span><span id="local_p_173"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_n_174"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Dot</span> <span class="LPAREN">(</span><a href="#val-module_path"><span class="LIDENT">module_path</span></a> <a href="#local_s_160"><span class="LIDENT">s</span></a> <a href="#local_p_173"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#local_n_174"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">ModuleType</span> <span class="LPAREN">(</span><span id="local_p'_175"><span class="LIDENT">p'</span></span><span class="COMMA">,</span> <span id="local_str_176"><span class="LIDENT">str</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="UIDENT">Not_replaced</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">ModuleType</span> <span class="LPAREN">(</span><a href="#val-resolved_parent_path"><span class="LIDENT">resolved_parent_path</span></a> <a href="#local_s_160"><span class="LIDENT">s</span></a> <a href="#local_p'_175"><span class="LIDENT">p'</span></a><span class="COMMA">,</span> <a href="#local_str_176"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-resolved_type_path"><span class="LIDENT">resolved_type_path</span></span> <span class="COLON">:</span><span class="EOL">
</span>    <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="UIDENT">Resolved</span><span class="DOT">.</span><span class="LIDENT">type_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="UIDENT">Resolved</span><span class="DOT">.</span><span class="LIDENT">type_</span><span class="COMMA">,</span> <span class="UIDENT">TypeExpr</span><span class="DOT">.</span><span class="LIDENT">t</span> <span class="STAR">*</span> <span class="UIDENT">TypeDecl</span><span class="DOT">.</span><span class="UIDENT">Equation</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="LIDENT">or_replaced</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_s_177"><span class="LIDENT">s</span></span> <span id="local_p_178"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_p_178"><span class="LIDENT">p</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <span id="local_id_179"><span class="LIDENT">id</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="IF">if</span> <span class="UIDENT">PathTypeMap</span><span class="DOT">.</span><span class="LIDENT">mem</span> <a href="#local_id_179"><span class="LIDENT">id</span></a> <a href="#local_s_177"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">type_replacement</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="UIDENT">Replaced</span> <span class="LPAREN">(</span><span class="UIDENT">PathTypeMap</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_id_179"><span class="LIDENT">id</span></a> <a href="#local_s_177"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">type_replacement</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="MATCH">match</span><span class="EOL">
</span>          <span class="TRY">try</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="UIDENT">PathTypeMap</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_id_179"><span class="LIDENT">id</span></a> <a href="#local_s_177"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">type_</span><span class="RPAREN">)</span> <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>        <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Prefixed</span> <span class="LPAREN">(</span><span id="local__p_180"><span class="LIDENT">_p</span></span><span class="COMMA">,</span> <span id="local_rp_181"><span class="LIDENT">rp</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <a href="#local_rp_181"><span class="LIDENT">rp</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Renamed</span> <span id="local_x_182"><span class="LIDENT">x</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <a href="#local_x_182"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <a href="#local_id_179"><span class="LIDENT">id</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">CanonicalType</span> <span class="LPAREN">(</span><span id="local_t1_183"><span class="LIDENT">t1</span></span><span class="COMMA">,</span> <span id="local_t2_184"><span class="LIDENT">t2</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#val-resolved_type_path"><span class="LIDENT">resolved_type_path</span></a> <a href="#local_s_177"><span class="LIDENT">s</span></a> <a href="#local_t1_183"><span class="LIDENT">t1</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Not_replaced</span> <span id="local_t1'_185"><span class="LIDENT">t1'</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">CanonicalType</span> <span class="LPAREN">(</span><a href="#local_t1'_185"><span class="LIDENT">t1'</span></a><span class="COMMA">,</span> <a href="#local_t2_184"><span class="LIDENT">t2</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_x_186"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_186"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Gpath</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <a href="#local_p_178"><span class="LIDENT">p</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Substituted</span> <span id="local_p_187"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#val-resolved_type_path"><span class="LIDENT">resolved_type_path</span></a> <a href="#local_s_177"><span class="LIDENT">s</span></a> <a href="#local_p_187"><span class="LIDENT">p</span></a> <span class="INFIXOP0">|&gt;</span> <a href="#val-map_replaced"><span class="LIDENT">map_replaced</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_p_188"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Substituted</span> <a href="#local_p_188"><span class="LIDENT">p</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Type</span> <span class="LPAREN">(</span><span id="local_p_189"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_n_190"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Type</span> <span class="LPAREN">(</span><a href="#val-resolved_parent_path"><span class="LIDENT">resolved_parent_path</span></a> <a href="#local_s_177"><span class="LIDENT">s</span></a> <a href="#local_p_189"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#local_n_190"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">ClassType</span> <span class="LPAREN">(</span><span id="local_p_191"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_n_192"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">ClassType</span> <span class="LPAREN">(</span><a href="#val-resolved_parent_path"><span class="LIDENT">resolved_parent_path</span></a> <a href="#local_s_177"><span class="LIDENT">s</span></a> <a href="#local_p_191"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#local_n_192"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Class</span> <span class="LPAREN">(</span><span id="local_p_193"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_n_194"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Class</span> <span class="LPAREN">(</span><a href="#val-resolved_parent_path"><span class="LIDENT">resolved_parent_path</span></a> <a href="#local_s_177"><span class="LIDENT">s</span></a> <a href="#local_p_193"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#local_n_194"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-type_path"><span class="LIDENT">type_path</span></span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="LIDENT">type_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="LIDENT">type_</span> <span class="LIDENT">type_or_replaced</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_s_195"><span class="LIDENT">s</span></span> <span id="local_p_196"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_p_196"><span class="LIDENT">p</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Resolved</span> <span id="local_r_197"><span class="LIDENT">r</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="TRY">try</span> <a href="#val-resolved_type_path"><span class="LIDENT">resolved_type_path</span></a> <a href="#local_s_195"><span class="LIDENT">s</span></a> <a href="#local_r_197"><span class="LIDENT">r</span></a> <span class="INFIXOP0">|&gt;</span> <a href="#val-map_replaced"><span class="LIDENT">map_replaced</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_r_198"><span class="LIDENT">r</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Resolved</span> <a href="#local_r_198"><span class="LIDENT">r</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Invalidated</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_path'_199"><span class="LIDENT">path'</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="LIDENT">unresolve_resolved_type_path</span> <a href="#local_r_197"><span class="LIDENT">r</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#val-type_path"><span class="LIDENT">type_path</span></a> <a href="#local_s_195"><span class="LIDENT">s</span></a> <a href="#local_path'_199"><span class="LIDENT">path'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Substituted</span> <span id="local_p_200"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#val-type_path"><span class="LIDENT">type_path</span></a> <a href="#local_s_195"><span class="LIDENT">s</span></a> <a href="#local_p_200"><span class="LIDENT">p</span></a> <span class="INFIXOP0">|&gt;</span> <a href="#val-map_replaced"><span class="LIDENT">map_replaced</span></a> <span class="LPAREN">(</span><span class="FUN">fun</span> <span id="local_r_201"><span class="LIDENT">r</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Substituted</span> <a href="#local_r_201"><span class="LIDENT">r</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <span class="LPAREN">(</span><span id="local_id_202"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_b_203"><span class="LIDENT">b</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="IF">if</span> <span class="UIDENT">PathTypeMap</span><span class="DOT">.</span><span class="LIDENT">mem</span> <a href="#local_id_202"><span class="LIDENT">id</span></a> <a href="#local_s_195"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">type_replacement</span> <span class="THEN">then</span><span class="EOL">
</span>        <span class="UIDENT">Replaced</span> <span class="LPAREN">(</span><span class="UIDENT">PathTypeMap</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_id_202"><span class="LIDENT">id</span></a> <a href="#local_s_195"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">type_replacement</span><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="ELSE">else</span><span class="EOL">
</span>        <span class="MATCH">match</span><span class="EOL">
</span>          <span class="TRY">try</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="UIDENT">PathTypeMap</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_id_202"><span class="LIDENT">id</span></a> <a href="#local_s_195"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">type_</span><span class="RPAREN">)</span> <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>        <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Prefixed</span> <span class="LPAREN">(</span><span id="local_p_204"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local__rp_205"><span class="LIDENT">_rp</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <a href="#local_p_204"><span class="LIDENT">p</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Renamed</span> <span id="local_x_206"><span class="LIDENT">x</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <span class="LPAREN">(</span><a href="#local_x_206"><span class="LIDENT">x</span></a><span class="COMMA">,</span> <a href="#local_b_203"><span class="LIDENT">b</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <span class="LPAREN">(</span><a href="#local_id_202"><span class="LIDENT">id</span></a><span class="COMMA">,</span> <a href="#local_b_203"><span class="LIDENT">b</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Identifier</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <a href="#local_p_196"><span class="LIDENT">p</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Dot</span> <span class="LPAREN">(</span><span id="local_p_207"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_n_208"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Dot</span> <span class="LPAREN">(</span><a href="#val-module_path"><span class="LIDENT">module_path</span></a> <a href="#local_s_195"><span class="LIDENT">s</span></a> <a href="#local_p_207"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#local_n_208"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Type</span> <span class="LPAREN">(</span><span id="local_p_209"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_n_210"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Type</span> <span class="LPAREN">(</span><a href="#val-resolved_parent_path"><span class="LIDENT">resolved_parent_path</span></a> <a href="#local_s_195"><span class="LIDENT">s</span></a> <a href="#local_p_209"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#local_n_210"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Class</span> <span class="LPAREN">(</span><span id="local_p_211"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_n_212"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Class</span> <span class="LPAREN">(</span><a href="#val-resolved_parent_path"><span class="LIDENT">resolved_parent_path</span></a> <a href="#local_s_195"><span class="LIDENT">s</span></a> <a href="#local_p_211"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#local_n_212"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">ClassType</span> <span class="LPAREN">(</span><span id="local_p_213"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_n_214"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Not_replaced</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">ClassType</span> <span class="LPAREN">(</span><a href="#val-resolved_parent_path"><span class="LIDENT">resolved_parent_path</span></a> <a href="#local_s_195"><span class="LIDENT">s</span></a> <a href="#local_p_213"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#local_n_214"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-resolved_class_type_path"><span class="LIDENT">resolved_class_type_path</span></span> <span class="COLON">:</span><span class="EOL">
</span>    <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="UIDENT">Resolved</span><span class="DOT">.</span><span class="LIDENT">class_type</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="UIDENT">Resolved</span><span class="DOT">.</span><span class="LIDENT">class_type</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_s_215"><span class="LIDENT">s</span></span> <span id="local_p_216"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_p_216"><span class="LIDENT">p</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <span id="local_id_217"><span class="LIDENT">id</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="MATCH">match</span><span class="EOL">
</span>        <span class="TRY">try</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="UIDENT">PathClassTypeMap</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_id_217"><span class="LIDENT">id</span></a> <a href="#local_s_215"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">class_type</span><span class="RPAREN">)</span> <span class="WITH">with</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>      <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Prefixed</span> <span class="LPAREN">(</span><span id="local__p_218"><span class="LIDENT">_p</span></span><span class="COMMA">,</span> <span id="local_rp_219"><span class="LIDENT">rp</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_rp_219"><span class="LIDENT">rp</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Renamed</span> <span id="local_x_220"><span class="LIDENT">x</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <a href="#local_x_220"><span class="LIDENT">x</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <a href="#local_id_217"><span class="LIDENT">id</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Gpath</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_p_216"><span class="LIDENT">p</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Substituted</span> <span id="local_p_221"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Substituted</span> <span class="LPAREN">(</span><a href="#val-resolved_class_type_path"><span class="LIDENT">resolved_class_type_path</span></a> <a href="#local_s_215"><span class="LIDENT">s</span></a> <a href="#local_p_221"><span class="LIDENT">p</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">ClassType</span> <span class="LPAREN">(</span><span id="local_p_222"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_n_223"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">ClassType</span> <span class="LPAREN">(</span><a href="#val-resolved_parent_path"><span class="LIDENT">resolved_parent_path</span></a> <a href="#local_s_215"><span class="LIDENT">s</span></a> <a href="#local_p_222"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#local_n_223"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Class</span> <span class="LPAREN">(</span><span id="local_p_224"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_n_225"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Class</span> <span class="LPAREN">(</span><a href="#val-resolved_parent_path"><span class="LIDENT">resolved_parent_path</span></a> <a href="#local_s_215"><span class="LIDENT">s</span></a> <a href="#local_p_224"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#local_n_225"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-class_type_path"><span class="LIDENT">class_type_path</span></span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="LIDENT">class_type</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="LIDENT">class_type</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_s_226"><span class="LIDENT">s</span></span> <span id="local_p_227"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_p_227"><span class="LIDENT">p</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Resolved</span> <span id="local_r_228"><span class="LIDENT">r</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="TRY">try</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Resolved</span> <span class="LPAREN">(</span><a href="#val-resolved_class_type_path"><span class="LIDENT">resolved_class_type_path</span></a> <a href="#local_s_226"><span class="LIDENT">s</span></a> <a href="#local_r_228"><span class="LIDENT">r</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Invalidated</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_path'_229"><span class="LIDENT">path'</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="LIDENT">unresolve_resolved_class_type_path</span> <a href="#local_r_228"><span class="LIDENT">r</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#val-class_type_path"><span class="LIDENT">class_type_path</span></a> <a href="#local_s_226"><span class="LIDENT">s</span></a> <a href="#local_path'_229"><span class="LIDENT">path'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <span class="LPAREN">(</span><span id="local_id_230"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_b_231"><span class="LIDENT">b</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="MATCH">match</span><span class="EOL">
</span>        <span class="TRY">try</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="UIDENT">PathClassTypeMap</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_id_230"><span class="LIDENT">id</span></a> <a href="#local_s_226"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">class_type</span><span class="RPAREN">)</span> <span class="WITH">with</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>      <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Prefixed</span> <span class="LPAREN">(</span><span id="local_p_232"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local__rp_233"><span class="LIDENT">_rp</span></span><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_p_232"><span class="LIDENT">p</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Renamed</span> <span id="local_x_234"><span class="LIDENT">x</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <span class="LPAREN">(</span><a href="#local_x_234"><span class="LIDENT">x</span></a><span class="COMMA">,</span> <a href="#local_b_231"><span class="LIDENT">b</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <span class="LPAREN">(</span><a href="#local_id_230"><span class="LIDENT">id</span></a><span class="COMMA">,</span> <a href="#local_b_231"><span class="LIDENT">b</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Identifier</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_p_227"><span class="LIDENT">p</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Substituted</span> <span id="local_p_235"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Substituted</span> <span class="LPAREN">(</span><a href="#val-class_type_path"><span class="LIDENT">class_type_path</span></a> <a href="#local_s_226"><span class="LIDENT">s</span></a> <a href="#local_p_235"><span class="LIDENT">p</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Dot</span> <span class="LPAREN">(</span><span id="local_p_236"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_n_237"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Dot</span> <span class="LPAREN">(</span><a href="#val-module_path"><span class="LIDENT">module_path</span></a> <a href="#local_s_226"><span class="LIDENT">s</span></a> <a href="#local_p_236"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#local_n_237"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Class</span> <span class="LPAREN">(</span><span id="local_p_238"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_n_239"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Class</span> <span class="LPAREN">(</span><a href="#val-resolved_parent_path"><span class="LIDENT">resolved_parent_path</span></a> <a href="#local_s_226"><span class="LIDENT">s</span></a> <a href="#local_p_238"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#local_n_239"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">ClassType</span> <span class="LPAREN">(</span><span id="local_p_240"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_n_241"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">ClassType</span> <span class="LPAREN">(</span><a href="#val-resolved_parent_path"><span class="LIDENT">resolved_parent_path</span></a> <a href="#local_s_226"><span class="LIDENT">s</span></a> <a href="#local_p_240"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#local_n_241"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-resolved_signature_fragment"><span class="LIDENT">resolved_signature_fragment</span></span> <span class="COLON">:</span><span class="EOL">
</span>    <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cfrag</span><span class="DOT">.</span><span class="LIDENT">resolved_signature</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cfrag</span><span class="DOT">.</span><span class="LIDENT">resolved_signature</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_t_242"><span class="LIDENT">t</span></span> <span id="local_r_243"><span class="LIDENT">r</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_r_243"><span class="LIDENT">r</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Root</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">ModuleType</span> <span id="local_p_244"><span class="LIDENT">p</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_p_245"><span class="LIDENT">p</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="#val-resolved_module_type_path"><span class="LIDENT">resolved_module_type_path</span></a> <a href="#local_t_242"><span class="LIDENT">t</span></a> <a href="#local_p_244"><span class="LIDENT">p</span></a> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Not_replaced</span> <span id="local_p_246"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_p_246"><span class="LIDENT">p</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Replaced</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>      <span class="IN">in</span><span class="EOL">
</span>      <span class="BACKQUOTE">`</span><span class="UIDENT">Root</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">ModuleType</span> <a href="#local_p_245"><span class="LIDENT">p</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Root</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Module</span> <span id="local_p_247"><span class="LIDENT">p</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Root</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Module</span> <span class="LPAREN">(</span><a href="#val-resolved_module_path"><span class="LIDENT">resolved_module_path</span></a> <a href="#local_t_242"><span class="LIDENT">t</span></a> <a href="#local_p_247"><span class="LIDENT">p</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Subst</span> <span class="UNDERSCORE">_</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Alias</span> <span class="UNDERSCORE">_</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">OpaqueModule</span> <span class="UNDERSCORE">_</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Module</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="AS">as</span> <span id="local_x_248"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LPAREN">(</span><a href="#val-resolved_module_fragment"><span class="LIDENT">resolved_module_fragment</span></a> <a href="#local_t_242"><span class="LIDENT">t</span></a> <a href="#local_x_248"><span class="LIDENT">x</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Cfrag</span><span class="DOT">.</span><span class="LIDENT">resolved_signature</span><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-resolved_module_fragment"><span class="LIDENT">resolved_module_fragment</span></span> <span class="COLON">:</span><span class="EOL">
</span>    <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cfrag</span><span class="DOT">.</span><span class="LIDENT">resolved_module</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cfrag</span><span class="DOT">.</span><span class="LIDENT">resolved_module</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_t_249"><span class="LIDENT">t</span></span> <span id="local_r_250"><span class="LIDENT">r</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_r_250"><span class="LIDENT">r</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Subst</span> <span class="LPAREN">(</span><span id="local_mty_251"><span class="LIDENT">mty</span></span><span class="COMMA">,</span> <span id="local_f_252"><span class="LIDENT">f</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_p_253"><span class="LIDENT">p</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="#val-resolved_module_type_path"><span class="LIDENT">resolved_module_type_path</span></a> <a href="#local_t_249"><span class="LIDENT">t</span></a> <a href="#local_mty_251"><span class="LIDENT">mty</span></a> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Not_replaced</span> <span id="local_p_254"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_p_254"><span class="LIDENT">p</span></a><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Replaced</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>            <span class="COMMENT">(* the left hand side of subst is a named module type inside a module,
               it cannot be substituted *)</span><span class="EOL">
</span>            <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>      <span class="IN">in</span><span class="EOL">
</span>      <span class="BACKQUOTE">`</span><span class="UIDENT">Subst</span> <span class="LPAREN">(</span><a href="#local_p_253"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#val-resolved_module_fragment"><span class="LIDENT">resolved_module_fragment</span></a> <a href="#local_t_249"><span class="LIDENT">t</span></a> <a href="#local_f_252"><span class="LIDENT">f</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Alias</span> <span class="LPAREN">(</span><span id="local_m_255"><span class="LIDENT">m</span></span><span class="COMMA">,</span> <span id="local_f_256"><span class="LIDENT">f</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="BACKQUOTE">`</span><span class="UIDENT">Alias</span> <span class="LPAREN">(</span><a href="#val-resolved_module_path"><span class="LIDENT">resolved_module_path</span></a> <a href="#local_t_249"><span class="LIDENT">t</span></a> <a href="#local_m_255"><span class="LIDENT">m</span></a><span class="COMMA">,</span> <a href="#val-resolved_module_fragment"><span class="LIDENT">resolved_module_fragment</span></a> <a href="#local_t_249"><span class="LIDENT">t</span></a> <a href="#local_f_256"><span class="LIDENT">f</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Module</span> <span class="LPAREN">(</span><span id="local_sg_257"><span class="LIDENT">sg</span></span><span class="COMMA">,</span> <span id="local_n_258"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Module</span> <span class="LPAREN">(</span><a href="#val-resolved_signature_fragment"><span class="LIDENT">resolved_signature_fragment</span></a> <a href="#local_t_249"><span class="LIDENT">t</span></a> <a href="#local_sg_257"><span class="LIDENT">sg</span></a><span class="COMMA">,</span> <a href="#local_n_258"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">OpaqueModule</span> <span id="local_m_259"><span class="LIDENT">m</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">OpaqueModule</span> <span class="LPAREN">(</span><a href="#val-resolved_module_fragment"><span class="LIDENT">resolved_module_fragment</span></a> <a href="#local_t_249"><span class="LIDENT">t</span></a> <a href="#local_m_259"><span class="LIDENT">m</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-resolved_module_type_fragment"><span class="LIDENT">resolved_module_type_fragment</span></span> <span class="COLON">:</span><span class="EOL">
</span>    <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cfrag</span><span class="DOT">.</span><span class="LIDENT">resolved_module_type</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cfrag</span><span class="DOT">.</span><span class="LIDENT">resolved_module_type</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_t_260"><span class="LIDENT">t</span></span> <span id="local_r_261"><span class="LIDENT">r</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_r_261"><span class="LIDENT">r</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">ModuleType</span> <span class="LPAREN">(</span><span id="local_s_262"><span class="LIDENT">s</span></span><span class="COMMA">,</span> <span id="local_n_263"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">ModuleType</span> <span class="LPAREN">(</span><a href="#val-resolved_signature_fragment"><span class="LIDENT">resolved_signature_fragment</span></a> <a href="#local_t_260"><span class="LIDENT">t</span></a> <a href="#local_s_262"><span class="LIDENT">s</span></a><span class="COMMA">,</span> <a href="#local_n_263"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-resolved_type_fragment"><span class="LIDENT">resolved_type_fragment</span></span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cfrag</span><span class="DOT">.</span><span class="LIDENT">resolved_type</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cfrag</span><span class="DOT">.</span><span class="LIDENT">resolved_type</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_t_264"><span class="LIDENT">t</span></span> <span id="local_r_265"><span class="LIDENT">r</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_r_265"><span class="LIDENT">r</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Type</span> <span class="LPAREN">(</span><span id="local_s_266"><span class="LIDENT">s</span></span><span class="COMMA">,</span> <span id="local_n_267"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Type</span> <span class="LPAREN">(</span><a href="#val-resolved_signature_fragment"><span class="LIDENT">resolved_signature_fragment</span></a> <a href="#local_t_264"><span class="LIDENT">t</span></a> <a href="#local_s_266"><span class="LIDENT">s</span></a><span class="COMMA">,</span> <a href="#local_n_267"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">ClassType</span> <span class="LPAREN">(</span><span id="local_s_268"><span class="LIDENT">s</span></span><span class="COMMA">,</span> <span id="local_n_269"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">ClassType</span> <span class="LPAREN">(</span><a href="#val-resolved_signature_fragment"><span class="LIDENT">resolved_signature_fragment</span></a> <a href="#local_t_264"><span class="LIDENT">t</span></a> <a href="#local_s_268"><span class="LIDENT">s</span></a><span class="COMMA">,</span> <a href="#local_n_269"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Class</span> <span class="LPAREN">(</span><span id="local_s_270"><span class="LIDENT">s</span></span><span class="COMMA">,</span> <span id="local_n_271"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Class</span> <span class="LPAREN">(</span><a href="#val-resolved_signature_fragment"><span class="LIDENT">resolved_signature_fragment</span></a> <a href="#local_t_264"><span class="LIDENT">t</span></a> <a href="#local_s_270"><span class="LIDENT">s</span></a><span class="COMMA">,</span> <a href="#local_n_271"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-signature_fragment"><span class="LIDENT">signature_fragment</span></span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cfrag</span><span class="DOT">.</span><span class="LIDENT">signature</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cfrag</span><span class="DOT">.</span><span class="LIDENT">signature</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_t_272"><span class="LIDENT">t</span></span> <span id="local_r_273"><span class="LIDENT">r</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_r_273"><span class="LIDENT">r</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Resolved</span> <span id="local_f_274"><span class="LIDENT">f</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Resolved</span> <span class="LPAREN">(</span><a href="#val-resolved_signature_fragment"><span class="LIDENT">resolved_signature_fragment</span></a> <a href="#local_t_272"><span class="LIDENT">t</span></a> <a href="#local_f_274"><span class="LIDENT">f</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Dot</span> <span class="LPAREN">(</span><span id="local_sg_275"><span class="LIDENT">sg</span></span><span class="COMMA">,</span> <span id="local_n_276"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Dot</span> <span class="LPAREN">(</span><a href="#val-signature_fragment"><span class="LIDENT">signature_fragment</span></a> <a href="#local_t_272"><span class="LIDENT">t</span></a> <a href="#local_sg_275"><span class="LIDENT">sg</span></a><span class="COMMA">,</span> <a href="#local_n_276"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Root</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Root</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-module_fragment"><span class="LIDENT">module_fragment</span></span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cfrag</span><span class="DOT">.</span><span class="LIDENT">module_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cfrag</span><span class="DOT">.</span><span class="LIDENT">module_</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_t_277"><span class="LIDENT">t</span></span> <span id="local_r_278"><span class="LIDENT">r</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_r_278"><span class="LIDENT">r</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Resolved</span> <span id="local_r_279"><span class="LIDENT">r</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="TRY">try</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Resolved</span> <span class="LPAREN">(</span><a href="#val-resolved_module_fragment"><span class="LIDENT">resolved_module_fragment</span></a> <a href="#local_t_277"><span class="LIDENT">t</span></a> <a href="#local_r_279"><span class="LIDENT">r</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Invalidated</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_frag'_280"><span class="LIDENT">frag'</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Cfrag</span><span class="DOT">.</span><span class="LIDENT">unresolve_module</span> <a href="#local_r_279"><span class="LIDENT">r</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#val-module_fragment"><span class="LIDENT">module_fragment</span></a> <a href="#local_t_277"><span class="LIDENT">t</span></a> <a href="#local_frag'_280"><span class="LIDENT">frag'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Dot</span> <span class="LPAREN">(</span><span id="local_sg_281"><span class="LIDENT">sg</span></span><span class="COMMA">,</span> <span id="local_n_282"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Dot</span> <span class="LPAREN">(</span><a href="#val-signature_fragment"><span class="LIDENT">signature_fragment</span></a> <a href="#local_t_277"><span class="LIDENT">t</span></a> <a href="#local_sg_281"><span class="LIDENT">sg</span></a><span class="COMMA">,</span> <a href="#local_n_282"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-module_type_fragment"><span class="LIDENT">module_type_fragment</span></span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cfrag</span><span class="DOT">.</span><span class="LIDENT">module_type</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cfrag</span><span class="DOT">.</span><span class="LIDENT">module_type</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_t_283"><span class="LIDENT">t</span></span> <span id="local_r_284"><span class="LIDENT">r</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_r_284"><span class="LIDENT">r</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Resolved</span> <span id="local_r_285"><span class="LIDENT">r</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="TRY">try</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Resolved</span> <span class="LPAREN">(</span><a href="#val-resolved_module_type_fragment"><span class="LIDENT">resolved_module_type_fragment</span></a> <a href="#local_t_283"><span class="LIDENT">t</span></a> <a href="#local_r_285"><span class="LIDENT">r</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Invalidated</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_frag'_286"><span class="LIDENT">frag'</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Cfrag</span><span class="DOT">.</span><span class="LIDENT">unresolve_module_type</span> <a href="#local_r_285"><span class="LIDENT">r</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#val-module_type_fragment"><span class="LIDENT">module_type_fragment</span></a> <a href="#local_t_283"><span class="LIDENT">t</span></a> <a href="#local_frag'_286"><span class="LIDENT">frag'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Dot</span> <span class="LPAREN">(</span><span id="local_sg_287"><span class="LIDENT">sg</span></span><span class="COMMA">,</span> <span id="local_n_288"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Dot</span> <span class="LPAREN">(</span><a href="#val-signature_fragment"><span class="LIDENT">signature_fragment</span></a> <a href="#local_t_283"><span class="LIDENT">t</span></a> <a href="#local_sg_287"><span class="LIDENT">sg</span></a><span class="COMMA">,</span> <a href="#local_n_288"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-type_fragment"><span class="LIDENT">type_fragment</span></span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cfrag</span><span class="DOT">.</span><span class="LIDENT">type_</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cfrag</span><span class="DOT">.</span><span class="LIDENT">type_</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_t_289"><span class="LIDENT">t</span></span> <span id="local_r_290"><span class="LIDENT">r</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_r_290"><span class="LIDENT">r</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Resolved</span> <span id="local_r_291"><span class="LIDENT">r</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="TRY">try</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Resolved</span> <span class="LPAREN">(</span><a href="#val-resolved_type_fragment"><span class="LIDENT">resolved_type_fragment</span></a> <a href="#local_t_289"><span class="LIDENT">t</span></a> <a href="#local_r_291"><span class="LIDENT">r</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">Invalidated</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <span class="LET">let</span> <span id="local_frag'_292"><span class="LIDENT">frag'</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Cfrag</span><span class="DOT">.</span><span class="LIDENT">unresolve_type</span> <a href="#local_r_291"><span class="LIDENT">r</span></a> <span class="IN">in</span><span class="EOL">
</span>        <a href="#val-type_fragment"><span class="LIDENT">type_fragment</span></a> <a href="#local_t_289"><span class="LIDENT">t</span></a> <a href="#local_frag'_292"><span class="LIDENT">frag'</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Dot</span> <span class="LPAREN">(</span><span id="local_sg_293"><span class="LIDENT">sg</span></span><span class="COMMA">,</span> <span id="local_n_294"><span class="LIDENT">n</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Dot</span> <span class="LPAREN">(</span><a href="#val-signature_fragment"><span class="LIDENT">signature_fragment</span></a> <a href="#local_t_289"><span class="LIDENT">t</span></a> <a href="#local_sg_293"><span class="LIDENT">sg</span></a><span class="COMMA">,</span> <a href="#local_n_294"><span class="LIDENT">n</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-option_"><span class="LIDENT">option_</span></span> <span id="local_conv_295"><span class="LIDENT">conv</span></span> <span id="local_s_296"><span class="LIDENT">s</span></span> <span id="local_x_297"><span class="LIDENT">x</span></span> <span class="EQUAL">=</span> <span class="MATCH">match</span> <a href="#local_x_297"><span class="LIDENT">x</span></a> <span class="WITH">with</span> <span class="UIDENT">Some</span> <span id="local_x_298"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="#local_conv_295"><span class="LIDENT">conv</span></a> <a href="#local_s_296"><span class="LIDENT">s</span></a> <a href="#local_x_298"><span class="LIDENT">x</span></a><span class="RPAREN">)</span> <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span id="val-list"><span class="LIDENT">list</span></span> <span id="local_conv_299"><span class="LIDENT">conv</span></span> <span id="local_s_300"><span class="LIDENT">s</span></span> <span id="local_xs_301"><span class="LIDENT">xs</span></span> <span class="EQUAL">=</span> <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span> <span class="LPAREN">(</span><a href="#local_conv_299"><span class="LIDENT">conv</span></a> <a href="#local_s_300"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <a href="#local_xs_301"><span class="LIDENT">xs</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="LET">let</span> <span class="REC">rec</span> <span id="val-type_"><span class="LIDENT">type_</span></span> <span id="local_s_302"><span class="LIDENT">s</span></span> <span id="local_t_303"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">TypeDecl</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_representation_304"><span class="LIDENT">representation</span></span> <span class="EQUAL">=</span> <a href="#val-option_"><span class="LIDENT">option_</span></a> <a href="#val-type_decl_representation"><span class="LIDENT">type_decl_representation</span></a> <a href="#local_s_302"><span class="LIDENT">s</span></a> <a href="#local_t_303"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">representation</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_t_303"><span class="LIDENT">t</span></a> <span class="WITH">with</span> <span class="LIDENT">equation</span> <span class="EQUAL">=</span> <a href="#val-type_decl_equation"><span class="LIDENT">type_decl_equation</span></a> <a href="#local_s_302"><span class="LIDENT">s</span></a> <a href="#local_t_303"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">equation</span><span class="SEMI">;</span> <a href="#local_representation_304"><span class="LIDENT">representation</span></a> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-type_decl_representation"><span class="LIDENT">type_decl_representation</span></span> <span id="local_s_305"><span class="LIDENT">s</span></span> <span id="local_t_306"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">TypeDecl</span><span class="DOT">.</span><span class="UIDENT">Representation</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_t_306"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Variant</span> <span id="local_cs_307"><span class="LIDENT">cs</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Variant</span> <span class="LPAREN">(</span><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span> <span class="LPAREN">(</span><a href="#val-type_decl_constructor"><span class="LIDENT">type_decl_constructor</span></a> <a href="#local_s_305"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <a href="#local_cs_307"><span class="LIDENT">cs</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Record</span> <span id="local_fs_308"><span class="LIDENT">fs</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Record</span> <span class="LPAREN">(</span><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span> <span class="LPAREN">(</span><a href="#val-type_decl_field"><span class="LIDENT">type_decl_field</span></a> <a href="#local_s_305"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <a href="#local_fs_308"><span class="LIDENT">fs</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Extensible</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_t_306"><span class="LIDENT">t</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-type_decl_constructor"><span class="LIDENT">type_decl_constructor</span></span> <span id="local_s_309"><span class="LIDENT">s</span></span> <span id="local_t_310"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">TypeDecl</span><span class="DOT">.</span><span class="UIDENT">Constructor</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_args_311"><span class="LIDENT">args</span></span> <span class="EQUAL">=</span> <a href="#val-type_decl_constructor_arg"><span class="LIDENT">type_decl_constructor_arg</span></a> <a href="#local_s_309"><span class="LIDENT">s</span></a> <a href="#local_t_310"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">args</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_res_312"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span> <a href="#val-option_"><span class="LIDENT">option_</span></a> <a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_309"><span class="LIDENT">s</span></a> <a href="#local_t_310"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">res</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_t_310"><span class="LIDENT">t</span></a> <span class="WITH">with</span> <a href="#local_args_311"><span class="LIDENT">args</span></a><span class="SEMI">;</span> <a href="#local_res_312"><span class="LIDENT">res</span></a> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-type_poly_var"><span class="LIDENT">type_poly_var</span></span> <span id="local_s_313"><span class="LIDENT">s</span></span> <span id="local_v_314"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">TypeExpr</span><span class="DOT">.</span><span class="UIDENT">Polymorphic_variant</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_map_constr_315"><span class="LIDENT">map_constr</span></span> <span id="local_c_316"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Constructor</span> <span class="IN">in</span><span class="EOL">
</span>    <span class="LBRACE">{</span><span class="EOL">
</span>      <span class="LIDENT">name</span> <span class="EQUAL">=</span> <a href="#local_c_316"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">name</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">constant</span> <span class="EQUAL">=</span> <a href="#local_c_316"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">constant</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">arguments</span> <span class="EQUAL">=</span> <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span> <span class="LPAREN">(</span><a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_313"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <a href="#local_c_316"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">arguments</span><span class="SEMI">;</span><span class="EOL">
</span>      <span class="LIDENT">doc</span> <span class="EQUAL">=</span> <a href="#local_c_316"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">doc</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_map_element_317"><span class="LIDENT">map_element</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Type</span> <span id="local_t_318"><span class="LIDENT">t</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>        <span class="MATCH">match</span> <a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_313"><span class="LIDENT">s</span></a> <a href="#local_t_318"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>        <span class="BAR">|</span> <span class="UIDENT">Polymorphic_variant</span> <span id="local_v_319"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_v_319"><span class="LIDENT">v</span></a><span class="DOT">.</span><span class="LIDENT">elements</span><span class="EOL">
</span>        <span class="BAR">|</span> <span id="local_x_320"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LBRACKET">[</span> <span class="UIDENT">Type</span> <a href="#local_x_320"><span class="LIDENT">x</span></a> <span class="RBRACKET">]</span><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Constructor</span> <span id="local_c_321"><span class="LIDENT">c</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LBRACKET">[</span> <span class="UIDENT">Constructor</span> <span class="LPAREN">(</span><a href="#local_map_constr_315"><span class="LIDENT">map_constr</span></a> <a href="#local_c_321"><span class="LIDENT">c</span></a><span class="RPAREN">)</span> <span class="RBRACKET">]</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <span class="LIDENT">kind</span> <span class="EQUAL">=</span> <a href="#local_v_314"><span class="LIDENT">v</span></a><span class="DOT">.</span><span class="LIDENT">kind</span><span class="SEMI">;</span> <span class="LIDENT">elements</span> <span class="EQUAL">=</span> <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">flatten</span> <span class="LPAREN">(</span><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span> <a href="#local_map_element_317"><span class="LIDENT">map_element</span></a> <a href="#local_v_314"><span class="LIDENT">v</span></a><span class="DOT">.</span><span class="LIDENT">elements</span><span class="RPAREN">)</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-type_object"><span class="LIDENT">type_object</span></span> <span id="local_s_322"><span class="LIDENT">s</span></span> <span id="local_o_323"><span class="LIDENT">o</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">TypeExpr</span><span class="DOT">.</span><span class="UIDENT">Object</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_map_field_324"><span class="LIDENT">map_field</span></span> <span class="EQUAL">=</span> <span class="FUNCTION">function</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Method</span> <span id="local_m_325"><span class="LIDENT">m</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Method</span> <span class="LBRACE">{</span> <a href="#local_m_325"><span class="LIDENT">m</span></a> <span class="WITH">with</span> <span class="LIDENT">type_</span> <span class="EQUAL">=</span> <a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_322"><span class="LIDENT">s</span></a> <a href="#local_m_325"><span class="LIDENT">m</span></a><span class="DOT">.</span><span class="LIDENT">type_</span> <span class="RBRACE">}</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Inherit</span> <span id="local_t_326"><span class="LIDENT">t</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Inherit</span> <span class="LPAREN">(</span><a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_322"><span class="LIDENT">s</span></a> <a href="#local_t_326"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <span class="LIDENT">fields</span> <span class="EQUAL">=</span> <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span> <a href="#local_map_field_324"><span class="LIDENT">map_field</span></a> <a href="#local_o_323"><span class="LIDENT">o</span></a><span class="DOT">.</span><span class="LIDENT">fields</span><span class="SEMI">;</span> <span class="LIDENT">open_</span> <span class="EQUAL">=</span> <a href="#local_o_323"><span class="LIDENT">o</span></a><span class="DOT">.</span><span class="LIDENT">open_</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-type_package"><span class="LIDENT">type_package</span></span> <span id="local_s_327"><span class="LIDENT">s</span></span> <span id="local_p_328"><span class="LIDENT">p</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">TypeExpr</span><span class="DOT">.</span><span class="UIDENT">Package</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_sub_329"><span class="LIDENT">sub</span></span> <span class="LPAREN">(</span><span id="local_x_330"><span class="LIDENT">x</span></span><span class="COMMA">,</span> <span id="local_y_331"><span class="LIDENT">y</span></span><span class="RPAREN">)</span> <span class="EQUAL">=</span> <span class="LPAREN">(</span><a href="#val-type_fragment"><span class="LIDENT">type_fragment</span></a> <a href="#local_s_327"><span class="LIDENT">s</span></a> <a href="#local_x_330"><span class="LIDENT">x</span></a><span class="COMMA">,</span> <a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_327"><span class="LIDENT">s</span></a> <a href="#local_y_331"><span class="LIDENT">y</span></a><span class="RPAREN">)</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span><span class="EOL">
</span>    <span class="LIDENT">path</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="LPAREN">(</span><span class="MATCH">match</span> <a href="#val-module_type_path"><span class="LIDENT">module_type_path</span></a> <a href="#local_s_327"><span class="LIDENT">s</span></a> <a href="#local_p_328"><span class="LIDENT">p</span></a><span class="DOT">.</span><span class="LIDENT">path</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Not_replaced</span> <span id="local_p_332"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_p_332"><span class="LIDENT">p</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Replaced</span> <span class="LPAREN">(</span><span class="UIDENT">Path</span> <span id="local_p_333"><span class="LIDENT">p</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_p_333"><span class="LIDENT">p</span></a><span class="DOT">.</span><span class="LIDENT">p_path</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Replaced</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="COMMENT">(* substituting away a packed module type by a non-path module type is a type error *)</span><span class="EOL">
</span>          <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">substitutions</span> <span class="EQUAL">=</span> <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span> <a href="#local_sub_329"><span class="LIDENT">sub</span></a> <a href="#local_p_328"><span class="LIDENT">p</span></a><span class="DOT">.</span><span class="LIDENT">substitutions</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-type_expr"><span class="LIDENT">type_expr</span></span> <span id="local_s_334"><span class="LIDENT">s</span></span> <span id="local_t_335"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">TypeExpr</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_t_335"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Var</span> <span id="local_s_336"><span class="LIDENT">s</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Var</span> <a href="#local_s_336"><span class="LIDENT">s</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Any</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Any</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Alias</span> <span class="LPAREN">(</span><span id="local_t_337"><span class="LIDENT">t</span></span><span class="COMMA">,</span> <span id="local_str_338"><span class="LIDENT">str</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Alias</span> <span class="LPAREN">(</span><a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_334"><span class="LIDENT">s</span></a> <a href="#local_t_337"><span class="LIDENT">t</span></a><span class="COMMA">,</span> <a href="#local_str_338"><span class="LIDENT">str</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Arrow</span> <span class="LPAREN">(</span><span id="local_lbl_339"><span class="LIDENT">lbl</span></span><span class="COMMA">,</span> <span id="local_t1_340"><span class="LIDENT">t1</span></span><span class="COMMA">,</span> <span id="local_t2_341"><span class="LIDENT">t2</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Arrow</span> <span class="LPAREN">(</span><a href="#local_lbl_339"><span class="LIDENT">lbl</span></a><span class="COMMA">,</span> <a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_334"><span class="LIDENT">s</span></a> <a href="#local_t1_340"><span class="LIDENT">t1</span></a><span class="COMMA">,</span> <a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_334"><span class="LIDENT">s</span></a> <a href="#local_t2_341"><span class="LIDENT">t2</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Tuple</span> <span id="local_ts_342"><span class="LIDENT">ts</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Tuple</span> <span class="LPAREN">(</span><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span> <span class="LPAREN">(</span><a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_334"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <a href="#local_ts_342"><span class="LIDENT">ts</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Constr</span> <span class="LPAREN">(</span><span id="local_p_343"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_ts_344"><span class="LIDENT">ts</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#val-type_path"><span class="LIDENT">type_path</span></a> <a href="#local_s_334"><span class="LIDENT">s</span></a> <a href="#local_p_343"><span class="LIDENT">p</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Replaced</span> <span class="LPAREN">(</span><span id="local_t_345"><span class="LIDENT">t</span></span><span class="COMMA">,</span> <span id="local_eq_346"><span class="LIDENT">eq</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_mk_var_347"><span class="LIDENT">mk_var</span></span> <span id="local_acc_348"><span class="LIDENT">acc</span></span> <span id="local_pexpr_349"><span class="LIDENT">pexpr</span></span> <span id="local_param_350"><span class="LIDENT">param</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>            <span class="MATCH">match</span> <a href="#local_param_350"><span class="LIDENT">param</span></a><span class="DOT">.</span><span class="UIDENT">Odoc_model</span><span class="DOT">.</span><span class="UIDENT">Lang</span><span class="DOT">.</span><span class="UIDENT">TypeDecl</span><span class="DOT">.</span><span class="LIDENT">desc</span> <span class="WITH">with</span><span class="EOL">
</span>            <span class="BAR">|</span> <span class="UIDENT">Any</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_acc_348"><span class="LIDENT">acc</span></a><span class="EOL">
</span>            <span class="BAR">|</span> <span class="UIDENT">Var</span> <span id="local_n_351"><span class="LIDENT">n</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><a href="#local_n_351"><span class="LIDENT">n</span></a><span class="COMMA">,</span> <a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_334"><span class="LIDENT">s</span></a> <a href="#local_pexpr_349"><span class="LIDENT">pexpr</span></a><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="#local_acc_348"><span class="LIDENT">acc</span></a><span class="EOL">
</span>          <span class="IN">in</span><span class="EOL">
</span>          <span class="LET">let</span> <span id="local_vars_352"><span class="LIDENT">vars</span></span> <span class="EQUAL">=</span> <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">fold_left2</span> <a href="#local_mk_var_347"><span class="LIDENT">mk_var</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <a href="#local_ts_344"><span class="LIDENT">ts</span></a> <a href="#local_eq_346"><span class="LIDENT">eq</span></a><span class="DOT">.</span><span class="LIDENT">params</span> <span class="IN">in</span><span class="EOL">
</span>          <a href="#val-substitute_vars"><span class="LIDENT">substitute_vars</span></a> <a href="#local_vars_352"><span class="LIDENT">vars</span></a> <a href="#local_t_345"><span class="LIDENT">t</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Not_replaced</span> <span id="local_p_353"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Constr</span> <span class="LPAREN">(</span><a href="#local_p_353"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span> <span class="LPAREN">(</span><a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_334"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <a href="#local_ts_344"><span class="LIDENT">ts</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Polymorphic_variant</span> <span id="local_v_354"><span class="LIDENT">v</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Polymorphic_variant</span> <span class="LPAREN">(</span><a href="#val-type_poly_var"><span class="LIDENT">type_poly_var</span></a> <a href="#local_s_334"><span class="LIDENT">s</span></a> <a href="#local_v_354"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Object</span> <span id="local_o_355"><span class="LIDENT">o</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Object</span> <span class="LPAREN">(</span><a href="#val-type_object"><span class="LIDENT">type_object</span></a> <a href="#local_s_334"><span class="LIDENT">s</span></a> <a href="#local_o_355"><span class="LIDENT">o</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Class</span> <span class="LPAREN">(</span><span id="local_p_356"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_ts_357"><span class="LIDENT">ts</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Class</span> <span class="LPAREN">(</span><a href="#val-class_type_path"><span class="LIDENT">class_type_path</span></a> <a href="#local_s_334"><span class="LIDENT">s</span></a> <a href="#local_p_356"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span> <span class="LPAREN">(</span><a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_334"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <a href="#local_ts_357"><span class="LIDENT">ts</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Poly</span> <span class="LPAREN">(</span><span id="local_strs_358"><span class="LIDENT">strs</span></span><span class="COMMA">,</span> <span id="local_ts_359"><span class="LIDENT">ts</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Poly</span> <span class="LPAREN">(</span><a href="#local_strs_358"><span class="LIDENT">strs</span></a><span class="COMMA">,</span> <a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_334"><span class="LIDENT">s</span></a> <a href="#local_ts_359"><span class="LIDENT">ts</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Package</span> <span id="local_p_360"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Package</span> <span class="LPAREN">(</span><a href="#val-type_package"><span class="LIDENT">type_package</span></a> <a href="#local_s_334"><span class="LIDENT">s</span></a> <a href="#local_p_360"><span class="LIDENT">p</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-simple_expansion"><span class="LIDENT">simple_expansion</span></span> <span class="COLON">:</span><span class="EOL">
</span>    <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">ModuleType</span><span class="DOT">.</span><span class="LIDENT">simple_expansion</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>    <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">ModuleType</span><span class="DOT">.</span><span class="LIDENT">simple_expansion</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_s_361"><span class="LIDENT">s</span></span> <span id="local_t_362"><span class="LIDENT">t</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">ModuleType</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_t_362"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Signature</span> <span id="local_sg_363"><span class="LIDENT">sg</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Signature</span> <span class="LPAREN">(</span><a href="#val-signature"><span class="LIDENT">signature</span></a> <a href="#local_s_361"><span class="LIDENT">s</span></a> <a href="#local_sg_363"><span class="LIDENT">sg</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Functor</span> <span class="LPAREN">(</span><span id="local_arg_364"><span class="LIDENT">arg</span></span><span class="COMMA">,</span> <span id="local_sg_365"><span class="LIDENT">sg</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Functor</span> <span class="LPAREN">(</span><a href="#val-functor_parameter"><span class="LIDENT">functor_parameter</span></a> <a href="#local_s_361"><span class="LIDENT">s</span></a> <a href="#local_arg_364"><span class="LIDENT">arg</span></a><span class="COMMA">,</span> <a href="#val-simple_expansion"><span class="LIDENT">simple_expansion</span></a> <a href="#local_s_361"><span class="LIDENT">s</span></a> <a href="#local_sg_365"><span class="LIDENT">sg</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-module_type"><span class="LIDENT">module_type</span></span> <span id="local_s_366"><span class="LIDENT">s</span></span> <span id="local_t_367"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">ModuleType</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_expr_368"><span class="LIDENT">expr</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_t_367"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">expr</span> <span class="WITH">with</span> <span class="UIDENT">Some</span> <span id="local_m_369"><span class="LIDENT">m</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="#val-module_type_expr"><span class="LIDENT">module_type_expr</span></a> <a href="#local_s_366"><span class="LIDENT">s</span></a> <a href="#local_m_369"><span class="LIDENT">m</span></a><span class="RPAREN">)</span> <span class="BAR">|</span> <span class="UIDENT">None</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">None</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_expr_368"><span class="LIDENT">expr</span></a><span class="SEMI">;</span> <span class="LIDENT">locs</span> <span class="EQUAL">=</span> <a href="#local_t_367"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">locs</span><span class="SEMI">;</span> <span class="LIDENT">doc</span> <span class="EQUAL">=</span> <a href="#local_t_367"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">doc</span><span class="SEMI">;</span> <span class="LIDENT">canonical</span> <span class="EQUAL">=</span> <a href="#local_t_367"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">canonical</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-module_type_substitution"><span class="LIDENT">module_type_substitution</span></span> <span id="local_s_370"><span class="LIDENT">s</span></span> <span id="local_t_371"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">ModuleTypeSubstitution</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_manifest_372"><span class="LIDENT">manifest</span></span> <span class="EQUAL">=</span> <a href="#val-module_type_expr"><span class="LIDENT">module_type_expr</span></a> <a href="#local_s_370"><span class="LIDENT">s</span></a> <a href="#local_t_371"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">manifest</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_manifest_372"><span class="LIDENT">manifest</span></a><span class="SEMI">;</span> <span class="LIDENT">doc</span> <span class="EQUAL">=</span> <a href="#local_t_371"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">doc</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-functor_parameter"><span class="LIDENT">functor_parameter</span></span> <span id="local_s_373"><span class="LIDENT">s</span></span> <span id="local_t_374"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">FunctorParameter</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_t_374"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Named</span> <span id="local_arg_375"><span class="LIDENT">arg</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Named</span> <span class="LBRACE">{</span> <a href="#local_arg_375"><span class="LIDENT">arg</span></a> <span class="WITH">with</span> <span class="LIDENT">expr</span> <span class="EQUAL">=</span> <a href="#val-module_type_expr"><span class="LIDENT">module_type_expr</span></a> <a href="#local_s_373"><span class="LIDENT">s</span></a> <a href="#local_arg_375"><span class="LIDENT">arg</span></a><span class="DOT">.</span><span class="LIDENT">expr</span> <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Unit</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Unit</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-module_type_type_of_desc"><span class="LIDENT">module_type_type_of_desc</span></span> <span id="local_s_376"><span class="LIDENT">s</span></span> <span id="local_t_377"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">ModuleType</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_t_377"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">ModPath</span> <span id="local_p_378"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#val-mto_module_path_invalidated"><span class="LIDENT">mto_module_path_invalidated</span></a> <a href="#local_s_376"><span class="LIDENT">s</span></a> <a href="#local_p_378"><span class="LIDENT">p</span></a> <span class="THEN">then</span> <span class="LIDENT">raise</span> <span class="UIDENT">MTOInvalidated</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="UIDENT">ModPath</span> <span class="LPAREN">(</span><a href="#val-module_path"><span class="LIDENT">module_path</span></a> <a href="#local_s_376"><span class="LIDENT">s</span></a> <a href="#local_p_378"><span class="LIDENT">p</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">StructInclude</span> <span id="local_p_379"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="IF">if</span> <a href="#val-mto_module_path_invalidated"><span class="LIDENT">mto_module_path_invalidated</span></a> <a href="#local_s_376"><span class="LIDENT">s</span></a> <a href="#local_p_379"><span class="LIDENT">p</span></a> <span class="THEN">then</span> <span class="LIDENT">raise</span> <span class="UIDENT">MTOInvalidated</span><span class="EOL">
</span>      <span class="ELSE">else</span> <span class="UIDENT">StructInclude</span> <span class="LPAREN">(</span><a href="#val-module_path"><span class="LIDENT">module_path</span></a> <a href="#local_s_376"><span class="LIDENT">s</span></a> <a href="#local_p_379"><span class="LIDENT">p</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-module_type_type_of_desc_noexn"><span class="LIDENT">module_type_type_of_desc_noexn</span></span> <span id="local_s_380"><span class="LIDENT">s</span></span> <span id="local_t_381"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">ModuleType</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_t_381"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">ModPath</span> <span id="local_p_382"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">ModPath</span> <span class="LPAREN">(</span><a href="#val-module_path"><span class="LIDENT">module_path</span></a> <a href="#local_s_380"><span class="LIDENT">s</span></a> <a href="#local_p_382"><span class="LIDENT">p</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">StructInclude</span> <span id="local_p_383"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">StructInclude</span> <span class="LPAREN">(</span><a href="#val-module_path"><span class="LIDENT">module_path</span></a> <a href="#local_s_380"><span class="LIDENT">s</span></a> <a href="#local_p_383"><span class="LIDENT">p</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-mto_module_path_invalidated"><span class="LIDENT">mto_module_path_invalidated</span></span> <span class="COLON">:</span> <span class="LIDENT">t</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Cpath</span><span class="DOT">.</span><span class="LIDENT">module_</span> <span class="MINUSGREATER">-&gt;</span> <span class="LIDENT">bool</span> <span class="EQUAL">=</span><span class="EOL">
</span> <span class="FUN">fun</span> <span id="local_s_384"><span class="LIDENT">s</span></span> <span id="local_p_385"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_p_385"><span class="LIDENT">p</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Resolved</span> <span id="local_p'_386"><span class="LIDENT">p'</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#val-mto_resolved_module_path_invalidated"><span class="LIDENT">mto_resolved_module_path_invalidated</span></a> <a href="#local_s_384"><span class="LIDENT">s</span></a> <a href="#local_p'_386"><span class="LIDENT">p'</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Substituted</span> <span id="local_p'_387"><span class="LIDENT">p'</span></span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Dot</span> <span class="LPAREN">(</span><span id="local_p'_388"><span class="LIDENT">p'</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#val-mto_module_path_invalidated"><span class="LIDENT">mto_module_path_invalidated</span></a> <a href="#local_s_384"><span class="LIDENT">s</span></a> <a href="#local_p'_388"><span class="LIDENT">p'</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Module</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Module</span> <span id="local_p'_389"><span class="LIDENT">p'</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#val-mto_resolved_module_path_invalidated"><span class="LIDENT">mto_resolved_module_path_invalidated</span></a> <a href="#local_s_384"><span class="LIDENT">s</span></a> <a href="#local_p'_389"><span class="LIDENT">p'</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Module</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Apply</span> <span class="LPAREN">(</span><span id="local_p1_390"><span class="LIDENT">p1</span></span><span class="COMMA">,</span> <span id="local_p2_391"><span class="LIDENT">p2</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#val-mto_module_path_invalidated"><span class="LIDENT">mto_module_path_invalidated</span></a> <a href="#local_s_384"><span class="LIDENT">s</span></a> <a href="#local_p1_390"><span class="LIDENT">p1</span></a> <span class="BARBAR">||</span> <a href="#val-mto_module_path_invalidated"><span class="LIDENT">mto_module_path_invalidated</span></a> <a href="#local_s_384"><span class="LIDENT">s</span></a> <a href="#local_p2_391"><span class="LIDENT">p2</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <span class="LPAREN">(</span><span id="local_id_392"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">mem</span> <a href="#local_id_392"><span class="LIDENT">id</span></a> <a href="#local_s_384"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">module_type_of_invalidating_modules</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Identifier</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Forward</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Root</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-mto_resolved_module_path_invalidated"><span class="LIDENT">mto_resolved_module_path_invalidated</span></span> <span id="local_s_393"><span class="LIDENT">s</span></span> <span id="local_p_394"><span class="LIDENT">p</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_p_394"><span class="LIDENT">p</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Local</span> <span id="local_id_395"><span class="LIDENT">id</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">mem</span> <a href="#local_id_395"><span class="LIDENT">id</span></a> <a href="#local_s_393"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">module_type_of_invalidating_modules</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Gpath</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Apply</span> <span class="LPAREN">(</span><span id="local_p1_396"><span class="LIDENT">p1</span></span><span class="COMMA">,</span> <span id="local_p2_397"><span class="LIDENT">p2</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#val-mto_resolved_module_path_invalidated"><span class="LIDENT">mto_resolved_module_path_invalidated</span></a> <a href="#local_s_393"><span class="LIDENT">s</span></a> <a href="#local_p1_396"><span class="LIDENT">p1</span></a><span class="EOL">
</span>      <span class="BARBAR">||</span> <a href="#val-mto_resolved_module_path_invalidated"><span class="LIDENT">mto_resolved_module_path_invalidated</span></a> <a href="#local_s_393"><span class="LIDENT">s</span></a> <a href="#local_p2_397"><span class="LIDENT">p2</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Module</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">Module</span> <span id="local_p_398"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Substituted</span> <span id="local_p_399"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <a href="#val-mto_resolved_module_path_invalidated"><span class="LIDENT">mto_resolved_module_path_invalidated</span></a> <a href="#local_s_393"><span class="LIDENT">s</span></a> <a href="#local_p_399"><span class="LIDENT">p</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Module</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Alias</span> <span class="LPAREN">(</span><span id="local_p1_400"><span class="LIDENT">p1</span></span><span class="COMMA">,</span> <span id="local__p2_401"><span class="LIDENT">_p2</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#val-mto_resolved_module_path_invalidated"><span class="LIDENT">mto_resolved_module_path_invalidated</span></a> <a href="#local_s_393"><span class="LIDENT">s</span></a> <a href="#local_p1_400"><span class="LIDENT">p1</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Subst</span> <span class="LPAREN">(</span><span id="local__p1_402"><span class="LIDENT">_p1</span></span><span class="COMMA">,</span> <span id="local_p2_403"><span class="LIDENT">p2</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#val-mto_resolved_module_path_invalidated"><span class="LIDENT">mto_resolved_module_path_invalidated</span></a> <a href="#local_s_393"><span class="LIDENT">s</span></a> <a href="#local_p2_403"><span class="LIDENT">p2</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Hidden</span> <span id="local_p_404"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#val-mto_resolved_module_path_invalidated"><span class="LIDENT">mto_resolved_module_path_invalidated</span></a> <a href="#local_s_393"><span class="LIDENT">s</span></a> <a href="#local_p_404"><span class="LIDENT">p</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Canonical</span> <span class="LPAREN">(</span><span id="local_p1_405"><span class="LIDENT">p1</span></span><span class="COMMA">,</span> <span id="local__p2_406"><span class="LIDENT">_p2</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#val-mto_resolved_module_path_invalidated"><span class="LIDENT">mto_resolved_module_path_invalidated</span></a> <a href="#local_s_393"><span class="LIDENT">s</span></a> <a href="#local_p1_405"><span class="LIDENT">p1</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">OpaqueModule</span> <span id="local_p_407"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#val-mto_resolved_module_path_invalidated"><span class="LIDENT">mto_resolved_module_path_invalidated</span></a> <a href="#local_s_393"><span class="LIDENT">s</span></a> <a href="#local_p_407"><span class="LIDENT">p</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-u_module_type_expr"><span class="LIDENT">u_module_type_expr</span></span> <span id="local_s_408"><span class="LIDENT">s</span></span> <span id="local_t_409"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">ModuleType</span><span class="DOT">.</span><span class="UIDENT">U</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_t_409"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Path</span> <span id="local_p_410"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#val-module_type_path"><span class="LIDENT">module_type_path</span></a> <a href="#local_s_408"><span class="LIDENT">s</span></a> <a href="#local_p_410"><span class="LIDENT">p</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Not_replaced</span> <span id="local_p_411"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Path</span> <a href="#local_p_411"><span class="LIDENT">p</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Replaced</span> <span id="local_eqn_412"><span class="LIDENT">eqn</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <span class="MATCH">match</span> <a href="#local_eqn_412"><span class="LIDENT">eqn</span></a> <span class="WITH">with</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">Path</span> <span id="local_p_413"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Path</span> <a href="#local_p_413"><span class="LIDENT">p</span></a><span class="DOT">.</span><span class="LIDENT">p_path</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">Signature</span> <span id="local_s_414"><span class="LIDENT">s</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Signature</span> <a href="#local_s_414"><span class="LIDENT">s</span></a><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">TypeOf</span> <span id="local_t_415"><span class="LIDENT">t</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">TypeOf</span> <a href="#local_t_415"><span class="LIDENT">t</span></a><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">With</span> <span id="local_w_416"><span class="LIDENT">w</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">With</span> <span class="LPAREN">(</span><a href="#local_w_416"><span class="LIDENT">w</span></a><span class="DOT">.</span><span class="LIDENT">w_substitutions</span><span class="COMMA">,</span> <a href="#local_w_416"><span class="LIDENT">w</span></a><span class="DOT">.</span><span class="LIDENT">w_expr</span><span class="RPAREN">)</span><span class="EOL">
</span>          <span class="BAR">|</span> <span class="UIDENT">Functor</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>              <span class="COMMENT">(* non functor cannot be substituted away to a functor *)</span><span class="EOL">
</span>              <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Signature</span> <span id="local_sg_417"><span class="LIDENT">sg</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Signature</span> <span class="LPAREN">(</span><a href="#val-signature"><span class="LIDENT">signature</span></a> <a href="#local_s_408"><span class="LIDENT">s</span></a> <a href="#local_sg_417"><span class="LIDENT">sg</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">With</span> <span class="LPAREN">(</span><span id="local_subs_418"><span class="LIDENT">subs</span></span><span class="COMMA">,</span> <span id="local_e_419"><span class="LIDENT">e</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="UIDENT">With</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span> <span class="LPAREN">(</span><a href="#val-with_module_type_substitution"><span class="LIDENT">with_module_type_substitution</span></a> <a href="#local_s_408"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <a href="#local_subs_418"><span class="LIDENT">subs</span></a><span class="COMMA">,</span> <a href="#val-u_module_type_expr"><span class="LIDENT">u_module_type_expr</span></a> <a href="#local_s_408"><span class="LIDENT">s</span></a> <a href="#local_e_419"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">TypeOf</span> <span class="LBRACE">{</span> <span id="local_t_desc_420"><span class="LIDENT">t_desc</span></span><span class="SEMI">;</span> <span class="LIDENT">t_expansion</span> <span class="EQUAL">=</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="UIDENT">Signature</span> <span id="local_e_421"><span class="LIDENT">e</span></span><span class="RPAREN">)</span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="TRY">try</span><span class="EOL">
</span>        <span class="UIDENT">TypeOf</span><span class="EOL">
</span>          <span class="LBRACE">{</span><span class="EOL">
</span>            <span class="LIDENT">t_desc</span> <span class="EQUAL">=</span> <a href="#val-module_type_type_of_desc"><span class="LIDENT">module_type_type_of_desc</span></a> <a href="#local_s_408"><span class="LIDENT">s</span></a> <a href="#local_t_desc_420"><span class="LIDENT">t_desc</span></a><span class="SEMI">;</span><span class="EOL">
</span>            <span class="LIDENT">t_expansion</span> <span class="EQUAL">=</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="UIDENT">Signature</span> <span class="LPAREN">(</span><a href="#val-apply_sig_map_sg"><span class="LIDENT">apply_sig_map_sg</span></a> <a href="#local_s_408"><span class="LIDENT">s</span></a> <a href="#local_e_421"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>          <span class="RBRACE">}</span><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">MTOInvalidated</span> <span class="MINUSGREATER">-&gt;</span> <a href="#val-u_module_type_expr"><span class="LIDENT">u_module_type_expr</span></a> <a href="#local_s_408"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><span class="UIDENT">Signature</span> <a href="#local_e_421"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">TypeOf</span> <span class="LBRACE">{</span> <span class="LIDENT">t_expansion</span> <span class="EQUAL">=</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><span class="UIDENT">Functor</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">TypeOf</span> <span class="LBRACE">{</span> <span id="local_t_desc_422"><span class="LIDENT">t_desc</span></span><span class="SEMI">;</span> <span class="LIDENT">t_expansion</span> <span class="EQUAL">=</span> <span class="UIDENT">None</span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="UIDENT">TypeOf</span><span class="EOL">
</span>        <span class="LBRACE">{</span> <span class="LIDENT">t_desc</span> <span class="EQUAL">=</span> <a href="#val-module_type_type_of_desc_noexn"><span class="LIDENT">module_type_type_of_desc_noexn</span></a> <a href="#local_s_408"><span class="LIDENT">s</span></a> <a href="#local_t_desc_422"><span class="LIDENT">t_desc</span></a><span class="SEMI">;</span> <span class="LIDENT">t_expansion</span> <span class="EQUAL">=</span> <span class="UIDENT">None</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-module_type_of_simple_expansion"><span class="LIDENT">module_type_of_simple_expansion</span></span> <span class="COLON">:</span><span class="EOL">
</span>    <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">ModuleType</span><span class="DOT">.</span><span class="LIDENT">simple_expansion</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">ModuleType</span><span class="DOT">.</span><span class="LIDENT">expr</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Signature</span> <span id="local_sg_423"><span class="LIDENT">sg</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Signature</span> <a href="#local_sg_423"><span class="LIDENT">sg</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Functor</span> <span class="LPAREN">(</span><span id="local_arg_424"><span class="LIDENT">arg</span></span><span class="COMMA">,</span> <span id="local_e_425"><span class="LIDENT">e</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Functor</span> <span class="LPAREN">(</span><a href="#local_arg_424"><span class="LIDENT">arg</span></a><span class="COMMA">,</span> <a href="#val-module_type_of_simple_expansion"><span class="LIDENT">module_type_of_simple_expansion</span></a> <a href="#local_e_425"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-module_type_expr"><span class="LIDENT">module_type_expr</span></span> <span id="local_s_426"><span class="LIDENT">s</span></span> <span id="local_t_427"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">ModuleType</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_t_427"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Path</span> <span class="LBRACE">{</span> <span id="local_p_path_429"><span class="LIDENT">p_path</span></span><span class="SEMI">;</span> <span id="local_p_expansion_428"><span class="LIDENT">p_expansion</span></span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="MATCH">match</span> <a href="#val-module_type_path"><span class="LIDENT">module_type_path</span></a> <a href="#local_s_426"><span class="LIDENT">s</span></a> <a href="#local_p_path_429"><span class="LIDENT">p_path</span></a> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Not_replaced</span> <span id="local_p_path_430"><span class="LIDENT">p_path</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="UIDENT">Path</span> <span class="LBRACE">{</span> <a href="#local_p_path_430"><span class="LIDENT">p_path</span></a><span class="SEMI">;</span> <span class="LIDENT">p_expansion</span> <span class="EQUAL">=</span> <a href="#val-option_"><span class="LIDENT">option_</span></a> <a href="#val-simple_expansion"><span class="LIDENT">simple_expansion</span></a> <a href="#local_s_426"><span class="LIDENT">s</span></a> <a href="#local_p_expansion_428"><span class="LIDENT">p_expansion</span></a> <span class="RBRACE">}</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">Replaced</span> <span id="local_s_431"><span class="LIDENT">s</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_s_431"><span class="LIDENT">s</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Signature</span> <span id="local_sg_432"><span class="LIDENT">sg</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Signature</span> <span class="LPAREN">(</span><a href="#val-signature"><span class="LIDENT">signature</span></a> <a href="#local_s_426"><span class="LIDENT">s</span></a> <a href="#local_sg_432"><span class="LIDENT">sg</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Functor</span> <span class="LPAREN">(</span><span id="local_arg_433"><span class="LIDENT">arg</span></span><span class="COMMA">,</span> <span id="local_expr_434"><span class="LIDENT">expr</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="UIDENT">Functor</span> <span class="LPAREN">(</span><a href="#val-functor_parameter"><span class="LIDENT">functor_parameter</span></a> <a href="#local_s_426"><span class="LIDENT">s</span></a> <a href="#local_arg_433"><span class="LIDENT">arg</span></a><span class="COMMA">,</span> <a href="#val-module_type_expr"><span class="LIDENT">module_type_expr</span></a> <a href="#local_s_426"><span class="LIDENT">s</span></a> <a href="#local_expr_434"><span class="LIDENT">expr</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">With</span> <span class="LBRACE">{</span> <span id="local_w_substitutions_435"><span class="LIDENT">w_substitutions</span></span><span class="SEMI">;</span> <span id="local_w_expansion_436"><span class="LIDENT">w_expansion</span></span><span class="SEMI">;</span> <span id="local_w_expr_437"><span class="LIDENT">w_expr</span></span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="UIDENT">With</span><span class="EOL">
</span>        <span class="LBRACE">{</span><span class="EOL">
</span>          <span class="LIDENT">w_substitutions</span> <span class="EQUAL">=</span><span class="EOL">
</span>            <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span> <span class="LPAREN">(</span><a href="#val-with_module_type_substitution"><span class="LIDENT">with_module_type_substitution</span></a> <a href="#local_s_426"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <a href="#local_w_substitutions_435"><span class="LIDENT">w_substitutions</span></a><span class="SEMI">;</span><span class="EOL">
</span>          <span class="LIDENT">w_expansion</span> <span class="EQUAL">=</span> <a href="#val-option_"><span class="LIDENT">option_</span></a> <a href="#val-simple_expansion"><span class="LIDENT">simple_expansion</span></a> <a href="#local_s_426"><span class="LIDENT">s</span></a> <a href="#local_w_expansion_436"><span class="LIDENT">w_expansion</span></a><span class="SEMI">;</span><span class="EOL">
</span>          <span class="LIDENT">w_expr</span> <span class="EQUAL">=</span> <a href="#val-u_module_type_expr"><span class="LIDENT">u_module_type_expr</span></a> <a href="#local_s_426"><span class="LIDENT">s</span></a> <a href="#local_w_expr_437"><span class="LIDENT">w_expr</span></a><span class="SEMI">;</span><span class="EOL">
</span>        <span class="RBRACE">}</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">TypeOf</span> <span class="LBRACE">{</span> <span id="local_t_desc_438"><span class="LIDENT">t_desc</span></span><span class="SEMI">;</span> <span class="LIDENT">t_expansion</span> <span class="EQUAL">=</span> <span class="UIDENT">Some</span> <span id="local_e_439"><span class="LIDENT">e</span></span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>      <span class="TRY">try</span><span class="EOL">
</span>        <span class="UIDENT">TypeOf</span><span class="EOL">
</span>          <span class="LBRACE">{</span><span class="EOL">
</span>            <span class="LIDENT">t_desc</span> <span class="EQUAL">=</span> <a href="#val-module_type_type_of_desc"><span class="LIDENT">module_type_type_of_desc</span></a> <a href="#local_s_426"><span class="LIDENT">s</span></a> <a href="#local_t_desc_438"><span class="LIDENT">t_desc</span></a><span class="SEMI">;</span><span class="EOL">
</span>            <span class="LIDENT">t_expansion</span> <span class="EQUAL">=</span> <span class="UIDENT">Some</span> <span class="LPAREN">(</span><a href="#val-simple_expansion"><span class="LIDENT">simple_expansion</span></a> <a href="#local_s_426"><span class="LIDENT">s</span></a> <a href="#local_e_439"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="SEMI">;</span><span class="EOL">
</span>          <span class="RBRACE">}</span><span class="EOL">
</span>      <span class="WITH">with</span> <span class="UIDENT">MTOInvalidated</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#val-module_type_expr"><span class="LIDENT">module_type_expr</span></a> <a href="#local_s_426"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><a href="#val-module_type_of_simple_expansion"><span class="LIDENT">module_type_of_simple_expansion</span></a> <a href="#local_e_439"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">TypeOf</span> <span class="LBRACE">{</span> <span id="local_t_desc_440"><span class="LIDENT">t_desc</span></span><span class="SEMI">;</span> <span class="LIDENT">t_expansion</span> <span class="EQUAL">=</span> <span class="UIDENT">None</span> <span class="RBRACE">}</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="UIDENT">TypeOf</span><span class="EOL">
</span>        <span class="LBRACE">{</span> <span class="LIDENT">t_desc</span> <span class="EQUAL">=</span> <a href="#val-module_type_type_of_desc_noexn"><span class="LIDENT">module_type_type_of_desc_noexn</span></a> <a href="#local_s_426"><span class="LIDENT">s</span></a> <a href="#local_t_desc_440"><span class="LIDENT">t_desc</span></a><span class="SEMI">;</span> <span class="LIDENT">t_expansion</span> <span class="EQUAL">=</span> <span class="UIDENT">None</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-with_module_type_substitution"><span class="LIDENT">with_module_type_substitution</span></span> <span id="local_s_441"><span class="LIDENT">s</span></span> <span id="local_sub_442"><span class="LIDENT">sub</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">ModuleType</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_sub_442"><span class="LIDENT">sub</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">ModuleEq</span> <span class="LPAREN">(</span><span id="local_f_443"><span class="LIDENT">f</span></span><span class="COMMA">,</span> <span id="local_m_444"><span class="LIDENT">m</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">ModuleEq</span> <span class="LPAREN">(</span><a href="#val-module_fragment"><span class="LIDENT">module_fragment</span></a> <a href="#local_s_441"><span class="LIDENT">s</span></a> <a href="#local_f_443"><span class="LIDENT">f</span></a><span class="COMMA">,</span> <a href="#val-module_decl"><span class="LIDENT">module_decl</span></a> <a href="#local_s_441"><span class="LIDENT">s</span></a> <a href="#local_m_444"><span class="LIDENT">m</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">ModuleSubst</span> <span class="LPAREN">(</span><span id="local_f_445"><span class="LIDENT">f</span></span><span class="COMMA">,</span> <span id="local_p_446"><span class="LIDENT">p</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">ModuleSubst</span> <span class="LPAREN">(</span><a href="#val-module_fragment"><span class="LIDENT">module_fragment</span></a> <a href="#local_s_441"><span class="LIDENT">s</span></a> <a href="#local_f_445"><span class="LIDENT">f</span></a><span class="COMMA">,</span> <a href="#val-module_path"><span class="LIDENT">module_path</span></a> <a href="#local_s_441"><span class="LIDENT">s</span></a> <a href="#local_p_446"><span class="LIDENT">p</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">TypeEq</span> <span class="LPAREN">(</span><span id="local_f_447"><span class="LIDENT">f</span></span><span class="COMMA">,</span> <span id="local_eq_448"><span class="LIDENT">eq</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">TypeEq</span> <span class="LPAREN">(</span><a href="#val-type_fragment"><span class="LIDENT">type_fragment</span></a> <a href="#local_s_441"><span class="LIDENT">s</span></a> <a href="#local_f_447"><span class="LIDENT">f</span></a><span class="COMMA">,</span> <a href="#val-type_decl_equation"><span class="LIDENT">type_decl_equation</span></a> <a href="#local_s_441"><span class="LIDENT">s</span></a> <a href="#local_eq_448"><span class="LIDENT">eq</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">TypeSubst</span> <span class="LPAREN">(</span><span id="local_f_449"><span class="LIDENT">f</span></span><span class="COMMA">,</span> <span id="local_eq_450"><span class="LIDENT">eq</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">TypeSubst</span> <span class="LPAREN">(</span><a href="#val-type_fragment"><span class="LIDENT">type_fragment</span></a> <a href="#local_s_441"><span class="LIDENT">s</span></a> <a href="#local_f_449"><span class="LIDENT">f</span></a><span class="COMMA">,</span> <a href="#val-type_decl_equation"><span class="LIDENT">type_decl_equation</span></a> <a href="#local_s_441"><span class="LIDENT">s</span></a> <a href="#local_eq_450"><span class="LIDENT">eq</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">ModuleTypeEq</span> <span class="LPAREN">(</span><span id="local_f_451"><span class="LIDENT">f</span></span><span class="COMMA">,</span> <span id="local_eq_452"><span class="LIDENT">eq</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="UIDENT">ModuleTypeEq</span> <span class="LPAREN">(</span><a href="#val-module_type_fragment"><span class="LIDENT">module_type_fragment</span></a> <a href="#local_s_441"><span class="LIDENT">s</span></a> <a href="#local_f_451"><span class="LIDENT">f</span></a><span class="COMMA">,</span> <a href="#val-module_type_expr"><span class="LIDENT">module_type_expr</span></a> <a href="#local_s_441"><span class="LIDENT">s</span></a> <a href="#local_eq_452"><span class="LIDENT">eq</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">ModuleTypeSubst</span> <span class="LPAREN">(</span><span id="local_f_453"><span class="LIDENT">f</span></span><span class="COMMA">,</span> <span id="local_eq_454"><span class="LIDENT">eq</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="UIDENT">ModuleTypeSubst</span> <span class="LPAREN">(</span><a href="#val-module_type_fragment"><span class="LIDENT">module_type_fragment</span></a> <a href="#local_s_441"><span class="LIDENT">s</span></a> <a href="#local_f_453"><span class="LIDENT">f</span></a><span class="COMMA">,</span> <a href="#val-module_type_expr"><span class="LIDENT">module_type_expr</span></a> <a href="#local_s_441"><span class="LIDENT">s</span></a> <a href="#local_eq_454"><span class="LIDENT">eq</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-module_decl"><span class="LIDENT">module_decl</span></span> <span id="local_s_455"><span class="LIDENT">s</span></span> <span id="local_t_456"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_t_456"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Alias</span> <span class="LPAREN">(</span><span id="local_p_457"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_e_458"><span class="LIDENT">e</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Alias</span> <span class="LPAREN">(</span><a href="#val-module_path"><span class="LIDENT">module_path</span></a> <a href="#local_s_455"><span class="LIDENT">s</span></a> <a href="#local_p_457"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <a href="#val-option_"><span class="LIDENT">option_</span></a> <a href="#val-simple_expansion"><span class="LIDENT">simple_expansion</span></a> <a href="#local_s_455"><span class="LIDENT">s</span></a> <a href="#local_e_458"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">ModuleType</span> <span id="local_t_459"><span class="LIDENT">t</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">ModuleType</span> <span class="LPAREN">(</span><a href="#val-module_type_expr"><span class="LIDENT">module_type_expr</span></a> <a href="#local_s_455"><span class="LIDENT">s</span></a> <a href="#local_t_459"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-include_decl"><span class="LIDENT">include_decl</span></span> <span id="local_s_460"><span class="LIDENT">s</span></span> <span id="local_t_461"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_t_461"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Include</span><span class="DOT">.</span><span class="UIDENT">Alias</span> <span id="local_p_462"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Include</span><span class="DOT">.</span><span class="UIDENT">Alias</span> <span class="LPAREN">(</span><a href="#val-module_path"><span class="LIDENT">module_path</span></a> <a href="#local_s_460"><span class="LIDENT">s</span></a> <a href="#local_p_462"><span class="LIDENT">p</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">ModuleType</span> <span id="local_t_463"><span class="LIDENT">t</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">ModuleType</span> <span class="LPAREN">(</span><a href="#val-u_module_type_expr"><span class="LIDENT">u_module_type_expr</span></a> <a href="#local_s_460"><span class="LIDENT">s</span></a> <a href="#local_t_463"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-module_"><span class="LIDENT">module_</span></span> <span id="local_s_464"><span class="LIDENT">s</span></span> <span id="local_t_465"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">Module</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_type__466"><span class="LIDENT">type_</span></span> <span class="EQUAL">=</span> <a href="#val-module_decl"><span class="LIDENT">module_decl</span></a> <a href="#local_s_464"><span class="LIDENT">s</span></a> <a href="#local_t_465"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">type_</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_canonical_467"><span class="LIDENT">canonical</span></span> <span class="EQUAL">=</span> <a href="#local_t_465"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">canonical</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_t_465"><span class="LIDENT">t</span></a> <span class="WITH">with</span> <a href="#local_type__466"><span class="LIDENT">type_</span></a><span class="SEMI">;</span> <a href="#local_canonical_467"><span class="LIDENT">canonical</span></a> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-module_substitution"><span class="LIDENT">module_substitution</span></span> <span id="local_s_468"><span class="LIDENT">s</span></span> <span id="local_m_469"><span class="LIDENT">m</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">ModuleSubstitution</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_manifest_470"><span class="LIDENT">manifest</span></span> <span class="EQUAL">=</span> <a href="#val-module_path"><span class="LIDENT">module_path</span></a> <a href="#local_s_468"><span class="LIDENT">s</span></a> <a href="#local_m_469"><span class="LIDENT">m</span></a><span class="DOT">.</span><span class="LIDENT">manifest</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_manifest_470"><span class="LIDENT">manifest</span></a><span class="SEMI">;</span> <span class="LIDENT">doc</span> <span class="EQUAL">=</span> <a href="#local_m_469"><span class="LIDENT">m</span></a><span class="DOT">.</span><span class="LIDENT">doc</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-type_decl_field"><span class="LIDENT">type_decl_field</span></span> <span id="local_s_471"><span class="LIDENT">s</span></span> <span id="local_f_472"><span class="LIDENT">f</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">TypeDecl</span><span class="DOT">.</span><span class="UIDENT">Field</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_f_472"><span class="LIDENT">f</span></a> <span class="WITH">with</span> <span class="LIDENT">type_</span> <span class="EQUAL">=</span> <a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_471"><span class="LIDENT">s</span></a> <a href="#local_f_472"><span class="LIDENT">f</span></a><span class="DOT">.</span><span class="LIDENT">type_</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-type_decl_constructor_arg"><span class="LIDENT">type_decl_constructor_arg</span></span> <span id="local_s_473"><span class="LIDENT">s</span></span> <span id="local_a_474"><span class="LIDENT">a</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">TypeDecl</span><span class="DOT">.</span><span class="UIDENT">Constructor</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="MATCH">match</span> <a href="#local_a_474"><span class="LIDENT">a</span></a> <span class="WITH">with</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Tuple</span> <span id="local_ts_475"><span class="LIDENT">ts</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Tuple</span> <span class="LPAREN">(</span><a href="#val-list"><span class="LIDENT">list</span></a> <a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_473"><span class="LIDENT">s</span></a> <a href="#local_ts_475"><span class="LIDENT">ts</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Record</span> <span id="local_fs_476"><span class="LIDENT">fs</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Record</span> <span class="LPAREN">(</span><a href="#val-list"><span class="LIDENT">list</span></a> <a href="#val-type_decl_field"><span class="LIDENT">type_decl_field</span></a> <a href="#local_s_473"><span class="LIDENT">s</span></a> <a href="#local_fs_476"><span class="LIDENT">fs</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-type_decl_equation"><span class="LIDENT">type_decl_equation</span></span> <span id="local_s_477"><span class="LIDENT">s</span></span> <span id="local_t_478"><span class="LIDENT">t</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">TypeDecl</span><span class="DOT">.</span><span class="UIDENT">Equation</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span><span class="EOL">
</span>    <a href="#local_t_478"><span class="LIDENT">t</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="LIDENT">manifest</span> <span class="EQUAL">=</span> <a href="#val-option_"><span class="LIDENT">option_</span></a> <a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_477"><span class="LIDENT">s</span></a> <a href="#local_t_478"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">manifest</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">constraints</span> <span class="EQUAL">=</span><span class="EOL">
</span>      <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span id="local_x_479"><span class="LIDENT">x</span></span><span class="COMMA">,</span> <span id="local_y_480"><span class="LIDENT">y</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_477"><span class="LIDENT">s</span></a> <a href="#local_x_479"><span class="LIDENT">x</span></a><span class="COMMA">,</span> <a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_477"><span class="LIDENT">s</span></a> <a href="#local_y_480"><span class="LIDENT">y</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <a href="#local_t_478"><span class="LIDENT">t</span></a><span class="DOT">.</span><span class="LIDENT">constraints</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-exception_"><span class="LIDENT">exception_</span></span> <span id="local_s_481"><span class="LIDENT">s</span></span> <span id="local_e_482"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">Exception</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_res_483"><span class="LIDENT">res</span></span> <span class="EQUAL">=</span> <a href="#val-option_"><span class="LIDENT">option_</span></a> <a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_481"><span class="LIDENT">s</span></a> <a href="#local_e_482"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">res</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_args_484"><span class="LIDENT">args</span></span> <span class="EQUAL">=</span> <a href="#val-type_decl_constructor_arg"><span class="LIDENT">type_decl_constructor_arg</span></a> <a href="#local_s_481"><span class="LIDENT">s</span></a> <a href="#local_e_482"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">args</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_e_482"><span class="LIDENT">e</span></a> <span class="WITH">with</span> <a href="#local_args_484"><span class="LIDENT">args</span></a><span class="SEMI">;</span> <a href="#local_res_483"><span class="LIDENT">res</span></a> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-extension_constructor"><span class="LIDENT">extension_constructor</span></span> <span id="local_s_485"><span class="LIDENT">s</span></span> <span id="local_c_486"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">Extension</span><span class="DOT">.</span><span class="UIDENT">Constructor</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span><span class="EOL">
</span>    <a href="#local_c_486"><span class="LIDENT">c</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="LIDENT">args</span> <span class="EQUAL">=</span> <a href="#val-type_decl_constructor_arg"><span class="LIDENT">type_decl_constructor_arg</span></a> <a href="#local_s_485"><span class="LIDENT">s</span></a> <a href="#local_c_486"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">args</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">res</span> <span class="EQUAL">=</span> <a href="#val-option_"><span class="LIDENT">option_</span></a> <a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_485"><span class="LIDENT">s</span></a> <a href="#local_c_486"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">res</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-extension"><span class="LIDENT">extension</span></span> <span id="local_s_487"><span class="LIDENT">s</span></span> <span id="local_e_488"><span class="LIDENT">e</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">Extension</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_type_path_489"><span class="LIDENT">type_path</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#val-type_path"><span class="LIDENT">type_path</span></a> <a href="#local_s_487"><span class="LIDENT">s</span></a> <a href="#local_e_488"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">type_path</span> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Not_replaced</span> <span id="local_p_490"><span class="LIDENT">p</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_p_490"><span class="LIDENT">p</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Replaced</span> <span class="LPAREN">(</span><span class="UIDENT">TypeExpr</span><span class="DOT">.</span><span class="UIDENT">Constr</span> <span class="LPAREN">(</span><span id="local_p_491"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_p_491"><span class="LIDENT">p</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Replaced</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="COMMENT">(* What else is possible ? *)</span> <span class="ASSERT">assert</span> <span class="FALSE">false</span><span class="EOL">
</span>  <span class="AND">and</span> <span id="local_constructors_492"><span class="LIDENT">constructors</span></span> <span class="EQUAL">=</span> <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span> <span class="LPAREN">(</span><a href="#val-extension_constructor"><span class="LIDENT">extension_constructor</span></a> <a href="#local_s_487"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <a href="#local_e_488"><span class="LIDENT">e</span></a><span class="DOT">.</span><span class="LIDENT">constructors</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_e_488"><span class="LIDENT">e</span></a> <span class="WITH">with</span> <a href="#local_type_path_489"><span class="LIDENT">type_path</span></a><span class="SEMI">;</span> <a href="#local_constructors_492"><span class="LIDENT">constructors</span></a> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-include_"><span class="LIDENT">include_</span></span> <span id="local_s_493"><span class="LIDENT">s</span></span> <span id="local_i_494"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">Include</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span><span class="EOL">
</span>    <a href="#local_i_494"><span class="LIDENT">i</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="LIDENT">decl</span> <span class="EQUAL">=</span> <a href="#val-include_decl"><span class="LIDENT">include_decl</span></a> <a href="#local_s_493"><span class="LIDENT">s</span></a> <a href="#local_i_494"><span class="LIDENT">i</span></a><span class="DOT">.</span><span class="LIDENT">decl</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">strengthened</span> <span class="EQUAL">=</span> <a href="#val-option_"><span class="LIDENT">option_</span></a> <a href="#val-module_path"><span class="LIDENT">module_path</span></a> <a href="#local_s_493"><span class="LIDENT">s</span></a> <a href="#local_i_494"><span class="LIDENT">i</span></a><span class="DOT">.</span><span class="LIDENT">strengthened</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">expansion_</span> <span class="EQUAL">=</span> <a href="#val-apply_sig_map_sg"><span class="LIDENT">apply_sig_map_sg</span></a> <a href="#local_s_493"><span class="LIDENT">s</span></a> <a href="#local_i_494"><span class="LIDENT">i</span></a><span class="DOT">.</span><span class="LIDENT">expansion_</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-open_"><span class="LIDENT">open_</span></span> <span id="local_s_495"><span class="LIDENT">s</span></span> <span id="local_o_496"><span class="LIDENT">o</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">Open</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <span class="LIDENT">expansion</span> <span class="EQUAL">=</span> <a href="#val-apply_sig_map_sg"><span class="LIDENT">apply_sig_map_sg</span></a> <a href="#local_s_495"><span class="LIDENT">s</span></a> <a href="#local_o_496"><span class="LIDENT">o</span></a><span class="DOT">.</span><span class="LIDENT">expansion</span><span class="SEMI">;</span> <span class="LIDENT">doc</span> <span class="EQUAL">=</span> <a href="#local_o_496"><span class="LIDENT">o</span></a><span class="DOT">.</span><span class="LIDENT">doc</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-value"><span class="LIDENT">value</span></span> <span id="local_s_497"><span class="LIDENT">s</span></span> <span id="local_v_498"><span class="LIDENT">v</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">Value</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_v_498"><span class="LIDENT">v</span></a> <span class="WITH">with</span> <span class="LIDENT">type_</span> <span class="EQUAL">=</span> <a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_497"><span class="LIDENT">s</span></a> <a href="#local_v_498"><span class="LIDENT">v</span></a><span class="DOT">.</span><span class="LIDENT">type_</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-class_"><span class="LIDENT">class_</span></span> <span id="local_s_499"><span class="LIDENT">s</span></span> <span id="local_c_500"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">Class</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_expansion_501"><span class="LIDENT">expansion</span></span> <span class="EQUAL">=</span> <a href="#val-option_"><span class="LIDENT">option_</span></a> <a href="#val-class_signature"><span class="LIDENT">class_signature</span></a> <a href="#local_s_499"><span class="LIDENT">s</span></a> <a href="#local_c_500"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">expansion</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_c_500"><span class="LIDENT">c</span></a> <span class="WITH">with</span> <span class="LIDENT">type_</span> <span class="EQUAL">=</span> <a href="#val-class_decl"><span class="LIDENT">class_decl</span></a> <a href="#local_s_499"><span class="LIDENT">s</span></a> <a href="#local_c_500"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">type_</span><span class="SEMI">;</span> <a href="#local_expansion_501"><span class="LIDENT">expansion</span></a> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-class_decl"><span class="LIDENT">class_decl</span></span> <span id="local_s_502"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">Class</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">ClassType</span> <span id="local_e_503"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">ClassType</span> <span class="LPAREN">(</span><a href="#val-class_type_expr"><span class="LIDENT">class_type_expr</span></a> <a href="#local_s_502"><span class="LIDENT">s</span></a> <a href="#local_e_503"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Arrow</span> <span class="LPAREN">(</span><span id="local_lbl_504"><span class="LIDENT">lbl</span></span><span class="COMMA">,</span> <span id="local_t_505"><span class="LIDENT">t</span></span><span class="COMMA">,</span> <span id="local_d_506"><span class="LIDENT">d</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Arrow</span> <span class="LPAREN">(</span><a href="#local_lbl_504"><span class="LIDENT">lbl</span></a><span class="COMMA">,</span> <a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_502"><span class="LIDENT">s</span></a> <a href="#local_t_505"><span class="LIDENT">t</span></a><span class="COMMA">,</span> <a href="#val-class_decl"><span class="LIDENT">class_decl</span></a> <a href="#local_s_502"><span class="LIDENT">s</span></a> <a href="#local_d_506"><span class="LIDENT">d</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-class_type_expr"><span class="LIDENT">class_type_expr</span></span> <span id="local_s_507"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">ClassType</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Constr</span> <span class="LPAREN">(</span><span id="local_p_508"><span class="LIDENT">p</span></span><span class="COMMA">,</span> <span id="local_ts_509"><span class="LIDENT">ts</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Constr</span> <span class="LPAREN">(</span><a href="#val-class_type_path"><span class="LIDENT">class_type_path</span></a> <a href="#local_s_507"><span class="LIDENT">s</span></a> <a href="#local_p_508"><span class="LIDENT">p</span></a><span class="COMMA">,</span> <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span> <span class="LPAREN">(</span><a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_507"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <a href="#local_ts_509"><span class="LIDENT">ts</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Signature</span> <span id="local_sg_510"><span class="LIDENT">sg</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Signature</span> <span class="LPAREN">(</span><a href="#val-class_signature"><span class="LIDENT">class_signature</span></a> <a href="#local_s_507"><span class="LIDENT">s</span></a> <a href="#local_sg_510"><span class="LIDENT">sg</span></a><span class="RPAREN">)</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-class_type"><span class="LIDENT">class_type</span></span> <span id="local_s_511"><span class="LIDENT">s</span></span> <span id="local_c_512"><span class="LIDENT">c</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">ClassType</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_expansion_513"><span class="LIDENT">expansion</span></span> <span class="EQUAL">=</span> <a href="#val-option_"><span class="LIDENT">option_</span></a> <a href="#val-class_signature"><span class="LIDENT">class_signature</span></a> <a href="#local_s_511"><span class="LIDENT">s</span></a> <a href="#local_c_512"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">expansion</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_c_512"><span class="LIDENT">c</span></a> <span class="WITH">with</span> <span class="LIDENT">expr</span> <span class="EQUAL">=</span> <a href="#val-class_type_expr"><span class="LIDENT">class_type_expr</span></a> <a href="#local_s_511"><span class="LIDENT">s</span></a> <a href="#local_c_512"><span class="LIDENT">c</span></a><span class="DOT">.</span><span class="LIDENT">expr</span><span class="SEMI">;</span> <a href="#local_expansion_513"><span class="LIDENT">expansion</span></a> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-class_signature_item"><span class="LIDENT">class_signature_item</span></span> <span id="local_s_514"><span class="LIDENT">s</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">ClassSignature</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Method</span> <span class="LPAREN">(</span><span id="local_id_515"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_m_516"><span class="LIDENT">m</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Method</span> <span class="LPAREN">(</span><a href="#local_id_515"><span class="LIDENT">id</span></a><span class="COMMA">,</span> <a href="#val-method_"><span class="LIDENT">method_</span></a> <a href="#local_s_514"><span class="LIDENT">s</span></a> <a href="#local_m_516"><span class="LIDENT">m</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">InstanceVariable</span> <span class="LPAREN">(</span><span id="local_id_517"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_i_518"><span class="LIDENT">i</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">InstanceVariable</span> <span class="LPAREN">(</span><a href="#local_id_517"><span class="LIDENT">id</span></a><span class="COMMA">,</span> <a href="#val-instance_variable"><span class="LIDENT">instance_variable</span></a> <a href="#local_s_514"><span class="LIDENT">s</span></a> <a href="#local_i_518"><span class="LIDENT">i</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Constraint</span> <span id="local_cst_519"><span class="LIDENT">cst</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Constraint</span> <span class="LPAREN">(</span><a href="#val-class_constraint"><span class="LIDENT">class_constraint</span></a> <a href="#local_s_514"><span class="LIDENT">s</span></a> <a href="#local_cst_519"><span class="LIDENT">cst</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Inherit</span> <span id="local_e_520"><span class="LIDENT">e</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Inherit</span> <span class="LPAREN">(</span><a href="#val-inherit_"><span class="LIDENT">inherit_</span></a> <a href="#local_s_514"><span class="LIDENT">s</span></a> <a href="#local_e_520"><span class="LIDENT">e</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Comment</span> <span class="UNDERSCORE">_</span> <span class="AS">as</span> <span id="local_y_521"><span class="LIDENT">y</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_y_521"><span class="LIDENT">y</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-class_signature"><span class="LIDENT">class_signature</span></span> <span id="local_s_522"><span class="LIDENT">s</span></span> <span id="local_sg_523"><span class="LIDENT">sg</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">ClassSignature</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span><span class="EOL">
</span>    <a href="#local_sg_523"><span class="LIDENT">sg</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="LIDENT">self</span> <span class="EQUAL">=</span> <a href="#val-option_"><span class="LIDENT">option_</span></a> <a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_522"><span class="LIDENT">s</span></a> <a href="#local_sg_523"><span class="LIDENT">sg</span></a><span class="DOT">.</span><span class="LIDENT">self</span><span class="SEMI">;</span><span class="EOL">
</span>    <span class="LIDENT">items</span> <span class="EQUAL">=</span> <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span> <span class="LPAREN">(</span><a href="#val-class_signature_item"><span class="LIDENT">class_signature_item</span></a> <a href="#local_s_522"><span class="LIDENT">s</span></a><span class="RPAREN">)</span> <a href="#local_sg_523"><span class="LIDENT">sg</span></a><span class="DOT">.</span><span class="LIDENT">items</span><span class="SEMI">;</span><span class="EOL">
</span>  <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-method_"><span class="LIDENT">method_</span></span> <span id="local_s_524"><span class="LIDENT">s</span></span> <span id="local_m_525"><span class="LIDENT">m</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">Method</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_m_525"><span class="LIDENT">m</span></a> <span class="WITH">with</span> <span class="LIDENT">type_</span> <span class="EQUAL">=</span> <a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_524"><span class="LIDENT">s</span></a> <a href="#local_m_525"><span class="LIDENT">m</span></a><span class="DOT">.</span><span class="LIDENT">type_</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-instance_variable"><span class="LIDENT">instance_variable</span></span> <span id="local_s_526"><span class="LIDENT">s</span></span> <span id="local_i_527"><span class="LIDENT">i</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">InstanceVariable</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_i_527"><span class="LIDENT">i</span></a> <span class="WITH">with</span> <span class="LIDENT">type_</span> <span class="EQUAL">=</span> <a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_526"><span class="LIDENT">s</span></a> <a href="#local_i_527"><span class="LIDENT">i</span></a><span class="DOT">.</span><span class="LIDENT">type_</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-class_constraint"><span class="LIDENT">class_constraint</span></span> <span id="local_s_528"><span class="LIDENT">s</span></span> <span id="local_cst_529"><span class="LIDENT">cst</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">ClassSignature</span><span class="DOT">.</span><span class="UIDENT">Constraint</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_cst_529"><span class="LIDENT">cst</span></a> <span class="WITH">with</span> <span class="LIDENT">left</span> <span class="EQUAL">=</span> <a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_528"><span class="LIDENT">s</span></a> <a href="#local_cst_529"><span class="LIDENT">cst</span></a><span class="DOT">.</span><span class="LIDENT">left</span><span class="SEMI">;</span> <span class="LIDENT">right</span> <span class="EQUAL">=</span> <a href="#val-type_expr"><span class="LIDENT">type_expr</span></a> <a href="#local_s_528"><span class="LIDENT">s</span></a> <a href="#local_cst_529"><span class="LIDENT">cst</span></a><span class="DOT">.</span><span class="LIDENT">right</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-inherit_"><span class="LIDENT">inherit_</span></span> <span id="local_s_530"><span class="LIDENT">s</span></span> <span id="local_ih_531"><span class="LIDENT">ih</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">ClassSignature</span><span class="DOT">.</span><span class="UIDENT">Inherit</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_ih_531"><span class="LIDENT">ih</span></a> <span class="WITH">with</span> <span class="LIDENT">expr</span> <span class="EQUAL">=</span> <a href="#val-class_type_expr"><span class="LIDENT">class_type_expr</span></a> <a href="#local_s_530"><span class="LIDENT">s</span></a> <a href="#local_ih_531"><span class="LIDENT">ih</span></a><span class="DOT">.</span><span class="LIDENT">expr</span> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-rename_bound_idents"><span class="LIDENT">rename_bound_idents</span></span> <span id="local_s_532"><span class="LIDENT">s</span></span> <span id="local_sg_533"><span class="LIDENT">sg</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">Signature</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_new_module_id_534"><span class="LIDENT">new_module_id</span></span> <span id="local_id_535"><span class="LIDENT">id</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="TRY">try</span><span class="EOL">
</span>      <span class="MATCH">match</span> <span class="UIDENT">PathModuleMap</span><span class="DOT">.</span><span class="LIDENT">find</span> <span class="LPAREN">(</span><a href="#local_id_535"><span class="LIDENT">id</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_module</span><span class="RPAREN">)</span> <a href="#local_s_532"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">module_</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Renamed</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">LModule</span> <span class="UNDERSCORE">_</span> <span class="AS">as</span> <span id="local_x_536"><span class="LIDENT">x</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_536"><span class="LIDENT">x</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Prefixed</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>          <span class="COMMENT">(* This is unusual but can happen when we have TypeOf expressions. It means
             we're already prefixing this module path, hence we can essentially rename
             it to whatever we like because it's never going to be referred to. *)</span><span class="EOL">
</span>          <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="UIDENT">Rename</span><span class="DOT">.</span><span class="LIDENT">module_</span> <a href="#local_id_535"><span class="LIDENT">id</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="failwith">failwith</span> <span class="STRING">&quot;Error&quot;</span><span class="EOL">
</span>    <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="UIDENT">Rename</span><span class="DOT">.</span><span class="LIDENT">module_</span> <a href="#local_id_535"><span class="LIDENT">id</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_new_module_type_id_537"><span class="LIDENT">new_module_type_id</span></span> <span id="local_id_538"><span class="LIDENT">id</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="TRY">try</span><span class="EOL">
</span>      <span class="MATCH">match</span> <span class="UIDENT">ModuleTypeMap</span><span class="DOT">.</span><span class="LIDENT">find</span> <a href="#local_id_538"><span class="LIDENT">id</span></a> <a href="#local_s_532"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">module_type</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Renamed</span> <span id="local_x_539"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_539"><span class="LIDENT">x</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Prefixed</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="UIDENT">Rename</span><span class="DOT">.</span><span class="LIDENT">module_type</span> <a href="#local_id_538"><span class="LIDENT">id</span></a><span class="EOL">
</span>    <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="UIDENT">Rename</span><span class="DOT">.</span><span class="LIDENT">module_type</span> <a href="#local_id_538"><span class="LIDENT">id</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_new_type_id_540"><span class="LIDENT">new_type_id</span></span> <span id="local_id_541"><span class="LIDENT">id</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="TRY">try</span><span class="EOL">
</span>      <span class="MATCH">match</span> <span class="UIDENT">PathTypeMap</span><span class="DOT">.</span><span class="LIDENT">find</span> <span class="LPAREN">(</span><a href="#local_id_541"><span class="LIDENT">id</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_type</span><span class="RPAREN">)</span> <a href="#local_s_532"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">type_</span> <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Renamed</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">LType</span> <span class="UNDERSCORE">_</span> <span class="AS">as</span> <span id="local_x_542"><span class="LIDENT">x</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_542"><span class="LIDENT">x</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Prefixed</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="UIDENT">Rename</span><span class="DOT">.</span><span class="LIDENT">type_</span> <a href="#local_id_541"><span class="LIDENT">id</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="failwith">failwith</span> <span class="STRING">&quot;Error&quot;</span><span class="EOL">
</span>    <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="UIDENT">Rename</span><span class="DOT">.</span><span class="LIDENT">type_</span> <a href="#local_id_541"><span class="LIDENT">id</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_new_class_id_543"><span class="LIDENT">new_class_id</span></span> <span id="local_id_544"><span class="LIDENT">id</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="TRY">try</span><span class="EOL">
</span>      <span class="MATCH">match</span><span class="EOL">
</span>        <span class="UIDENT">PathClassTypeMap</span><span class="DOT">.</span><span class="LIDENT">find</span> <span class="LPAREN">(</span><a href="#local_id_544"><span class="LIDENT">id</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_class_type</span><span class="RPAREN">)</span> <a href="#local_s_532"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">class_type</span><span class="EOL">
</span>      <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Renamed</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">LClass</span> <span class="UNDERSCORE">_</span> <span class="AS">as</span> <span id="local_x_545"><span class="LIDENT">x</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_545"><span class="LIDENT">x</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Prefixed</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="UIDENT">Rename</span><span class="DOT">.</span><span class="LIDENT">class_</span> <a href="#local_id_544"><span class="LIDENT">id</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="failwith">failwith</span> <span class="STRING">&quot;Error&quot;</span><span class="EOL">
</span>    <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="UIDENT">Rename</span><span class="DOT">.</span><span class="LIDENT">class_</span> <a href="#local_id_544"><span class="LIDENT">id</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_new_class_type_id_546"><span class="LIDENT">new_class_type_id</span></span> <span id="local_id_547"><span class="LIDENT">id</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="TRY">try</span><span class="EOL">
</span>      <span class="MATCH">match</span><span class="EOL">
</span>        <span class="UIDENT">PathClassTypeMap</span><span class="DOT">.</span><span class="LIDENT">find</span> <span class="LPAREN">(</span><a href="#local_id_547"><span class="LIDENT">id</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_class_type</span><span class="RPAREN">)</span> <a href="#local_s_532"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">class_type</span><span class="EOL">
</span>      <span class="WITH">with</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Renamed</span> <span class="LPAREN">(</span><span class="BACKQUOTE">`</span><span class="UIDENT">LClassType</span> <span class="UNDERSCORE">_</span> <span class="AS">as</span> <span id="local_x_548"><span class="LIDENT">x</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_548"><span class="LIDENT">x</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Prefixed</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="UIDENT">Rename</span><span class="DOT">.</span><span class="LIDENT">class_type</span> <a href="#local_id_547"><span class="LIDENT">id</span></a><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <span class="failwith">failwith</span> <span class="STRING">&quot;Error!&quot;</span><span class="EOL">
</span>    <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="UIDENT">Rename</span><span class="DOT">.</span><span class="LIDENT">class_type</span> <a href="#local_id_547"><span class="LIDENT">id</span></a><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="FUNCTION">function</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><a href="#local_s_532"><span class="LIDENT">s</span></a><span class="COMMA">,</span> <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev</span> <a href="#local_sg_533"><span class="LIDENT">sg</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Module</span> <span class="LPAREN">(</span><span id="local_id_549"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_r_550"><span class="LIDENT">r</span></span><span class="COMMA">,</span> <span id="local_m_551"><span class="LIDENT">m</span></span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span id="local_rest_552"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_id'_553"><span class="LIDENT">id'</span></span> <span class="EQUAL">=</span> <a href="#local_new_module_id_534"><span class="LIDENT">new_module_id</span></a> <a href="#local_id_549"><span class="LIDENT">id</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="#val-rename_bound_idents"><span class="LIDENT">rename_bound_idents</span></a><span class="EOL">
</span>        <span class="LPAREN">(</span><a href="#val-rename_module"><span class="LIDENT">rename_module</span></a> <span class="LPAREN">(</span><a href="#local_id_549"><span class="LIDENT">id</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_module</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_id'_553"><span class="LIDENT">id'</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_module</span><span class="RPAREN">)</span> <a href="#local_s_532"><span class="LIDENT">s</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="UIDENT">Module</span> <span class="LPAREN">(</span><a href="#local_id'_553"><span class="LIDENT">id'</span></a><span class="COMMA">,</span> <a href="#local_r_550"><span class="LIDENT">r</span></a><span class="COMMA">,</span> <a href="#local_m_551"><span class="LIDENT">m</span></a><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="#local_sg_533"><span class="LIDENT">sg</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_rest_552"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">ModuleSubstitution</span> <span class="LPAREN">(</span><span id="local_id_554"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_m_555"><span class="LIDENT">m</span></span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span id="local_rest_556"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_id'_557"><span class="LIDENT">id'</span></span> <span class="EQUAL">=</span> <a href="#local_new_module_id_534"><span class="LIDENT">new_module_id</span></a> <a href="#local_id_554"><span class="LIDENT">id</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="#val-rename_bound_idents"><span class="LIDENT">rename_bound_idents</span></a><span class="EOL">
</span>        <span class="LPAREN">(</span><a href="#val-rename_module"><span class="LIDENT">rename_module</span></a> <span class="LPAREN">(</span><a href="#local_id_554"><span class="LIDENT">id</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_module</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_id'_557"><span class="LIDENT">id'</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_module</span><span class="RPAREN">)</span> <a href="#local_s_532"><span class="LIDENT">s</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="UIDENT">ModuleSubstitution</span> <span class="LPAREN">(</span><a href="#local_id'_557"><span class="LIDENT">id'</span></a><span class="COMMA">,</span> <a href="#local_m_555"><span class="LIDENT">m</span></a><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="#local_sg_533"><span class="LIDENT">sg</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_rest_556"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">ModuleType</span> <span class="LPAREN">(</span><span id="local_id_558"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_mt_559"><span class="LIDENT">mt</span></span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span id="local_rest_560"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_id'_561"><span class="LIDENT">id'</span></span> <span class="EQUAL">=</span> <a href="#local_new_module_type_id_537"><span class="LIDENT">new_module_type_id</span></a> <a href="#local_id_558"><span class="LIDENT">id</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="#val-rename_bound_idents"><span class="LIDENT">rename_bound_idents</span></a><span class="EOL">
</span>        <span class="LPAREN">(</span><a href="#val-rename_module_type"><span class="LIDENT">rename_module_type</span></a> <a href="#local_id_558"><span class="LIDENT">id</span></a> <a href="#local_id'_561"><span class="LIDENT">id'</span></a> <a href="#local_s_532"><span class="LIDENT">s</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="UIDENT">ModuleType</span> <span class="LPAREN">(</span><a href="#local_id'_561"><span class="LIDENT">id'</span></a><span class="COMMA">,</span> <a href="#local_mt_559"><span class="LIDENT">mt</span></a><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="#local_sg_533"><span class="LIDENT">sg</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_rest_560"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">ModuleTypeSubstitution</span> <span class="LPAREN">(</span><span id="local_id_562"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_mt_563"><span class="LIDENT">mt</span></span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span id="local_rest_564"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_id'_565"><span class="LIDENT">id'</span></span> <span class="EQUAL">=</span> <a href="#local_new_module_type_id_537"><span class="LIDENT">new_module_type_id</span></a> <a href="#local_id_562"><span class="LIDENT">id</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="#val-rename_bound_idents"><span class="LIDENT">rename_bound_idents</span></a><span class="EOL">
</span>        <span class="LPAREN">(</span><a href="#val-rename_module_type"><span class="LIDENT">rename_module_type</span></a> <a href="#local_id_562"><span class="LIDENT">id</span></a> <a href="#local_id'_565"><span class="LIDENT">id'</span></a> <a href="#local_s_532"><span class="LIDENT">s</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="UIDENT">ModuleTypeSubstitution</span> <span class="LPAREN">(</span><a href="#local_id'_565"><span class="LIDENT">id'</span></a><span class="COMMA">,</span> <a href="#local_mt_563"><span class="LIDENT">mt</span></a><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="#local_sg_533"><span class="LIDENT">sg</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_rest_564"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Type</span> <span class="LPAREN">(</span><span id="local_id_566"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_r_567"><span class="LIDENT">r</span></span><span class="COMMA">,</span> <span id="local_t_568"><span class="LIDENT">t</span></span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span id="local_rest_569"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_id'_570"><span class="LIDENT">id'</span></span> <span class="EQUAL">=</span> <a href="#local_new_type_id_540"><span class="LIDENT">new_type_id</span></a> <a href="#local_id_566"><span class="LIDENT">id</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="#val-rename_bound_idents"><span class="LIDENT">rename_bound_idents</span></a><span class="EOL">
</span>        <span class="LPAREN">(</span><a href="#val-rename_type"><span class="LIDENT">rename_type</span></a> <span class="LPAREN">(</span><a href="#local_id_566"><span class="LIDENT">id</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_type</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_id'_570"><span class="LIDENT">id'</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_type</span><span class="RPAREN">)</span> <a href="#local_s_532"><span class="LIDENT">s</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="UIDENT">Type</span> <span class="LPAREN">(</span><a href="#local_id'_570"><span class="LIDENT">id'</span></a><span class="COMMA">,</span> <a href="#local_r_567"><span class="LIDENT">r</span></a><span class="COMMA">,</span> <a href="#local_t_568"><span class="LIDENT">t</span></a><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="#local_sg_533"><span class="LIDENT">sg</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_rest_569"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">TypeSubstitution</span> <span class="LPAREN">(</span><span id="local_id_571"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_t_572"><span class="LIDENT">t</span></span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span id="local_rest_573"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_id'_574"><span class="LIDENT">id'</span></span> <span class="EQUAL">=</span> <a href="#local_new_type_id_540"><span class="LIDENT">new_type_id</span></a> <a href="#local_id_571"><span class="LIDENT">id</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="#val-rename_bound_idents"><span class="LIDENT">rename_bound_idents</span></a><span class="EOL">
</span>        <span class="LPAREN">(</span><a href="#val-rename_type"><span class="LIDENT">rename_type</span></a> <span class="LPAREN">(</span><a href="#local_id_571"><span class="LIDENT">id</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_type</span><span class="RPAREN">)</span> <span class="LPAREN">(</span><a href="#local_id'_574"><span class="LIDENT">id'</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_type</span><span class="RPAREN">)</span> <a href="#local_s_532"><span class="LIDENT">s</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="UIDENT">TypeSubstitution</span> <span class="LPAREN">(</span><a href="#local_id'_574"><span class="LIDENT">id'</span></a><span class="COMMA">,</span> <a href="#local_t_572"><span class="LIDENT">t</span></a><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="#local_sg_533"><span class="LIDENT">sg</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_rest_573"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Exception</span> <span class="LPAREN">(</span><span id="local_id_575"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_e_576"><span class="LIDENT">e</span></span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span id="local_rest_577"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_id'_578"><span class="LIDENT">id'</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="UIDENT">Rename</span><span class="DOT">.</span><span class="LIDENT">exception_</span> <a href="#local_id_575"><span class="LIDENT">id</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="#val-rename_bound_idents"><span class="LIDENT">rename_bound_idents</span></a> <a href="#local_s_532"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><span class="UIDENT">Exception</span> <span class="LPAREN">(</span><a href="#local_id'_578"><span class="LIDENT">id'</span></a><span class="COMMA">,</span> <a href="#local_e_576"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="#local_sg_533"><span class="LIDENT">sg</span></a><span class="RPAREN">)</span> <a href="#local_rest_577"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">TypExt</span> <span id="local_e_579"><span class="LIDENT">e</span></span> <span class="COLONCOLON">::</span> <span id="local_rest_580"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#val-rename_bound_idents"><span class="LIDENT">rename_bound_idents</span></a> <a href="#local_s_532"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><span class="UIDENT">TypExt</span> <a href="#local_e_579"><span class="LIDENT">e</span></a> <span class="COLONCOLON">::</span> <a href="#local_sg_533"><span class="LIDENT">sg</span></a><span class="RPAREN">)</span> <a href="#local_rest_580"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Value</span> <span class="LPAREN">(</span><span id="local_id_581"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_v_582"><span class="LIDENT">v</span></span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span id="local_rest_583"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_id'_584"><span class="LIDENT">id'</span></span> <span class="EQUAL">=</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="UIDENT">Rename</span><span class="DOT">.</span><span class="LIDENT">value</span> <a href="#local_id_581"><span class="LIDENT">id</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="#val-rename_bound_idents"><span class="LIDENT">rename_bound_idents</span></a> <a href="#local_s_532"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><span class="UIDENT">Value</span> <span class="LPAREN">(</span><a href="#local_id'_584"><span class="LIDENT">id'</span></a><span class="COMMA">,</span> <a href="#local_v_582"><span class="LIDENT">v</span></a><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="#local_sg_533"><span class="LIDENT">sg</span></a><span class="RPAREN">)</span> <a href="#local_rest_583"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Class</span> <span class="LPAREN">(</span><span id="local_id_585"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_r_586"><span class="LIDENT">r</span></span><span class="COMMA">,</span> <span id="local_c_587"><span class="LIDENT">c</span></span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span id="local_rest_588"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_id'_589"><span class="LIDENT">id'</span></span> <span class="EQUAL">=</span> <a href="#local_new_class_id_543"><span class="LIDENT">new_class_id</span></a> <a href="#local_id_585"><span class="LIDENT">id</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="#val-rename_bound_idents"><span class="LIDENT">rename_bound_idents</span></a><span class="EOL">
</span>        <span class="LPAREN">(</span><a href="#val-rename_class_type"><span class="LIDENT">rename_class_type</span></a><span class="EOL">
</span>           <span class="LPAREN">(</span><a href="#local_id_585"><span class="LIDENT">id</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_class_type</span><span class="RPAREN">)</span><span class="EOL">
</span>           <span class="LPAREN">(</span><a href="#local_id'_589"><span class="LIDENT">id'</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_class_type</span><span class="RPAREN">)</span><span class="EOL">
</span>           <a href="#local_s_532"><span class="LIDENT">s</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="UIDENT">Class</span> <span class="LPAREN">(</span><a href="#local_id'_589"><span class="LIDENT">id'</span></a><span class="COMMA">,</span> <a href="#local_r_586"><span class="LIDENT">r</span></a><span class="COMMA">,</span> <a href="#local_c_587"><span class="LIDENT">c</span></a><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="#local_sg_533"><span class="LIDENT">sg</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_rest_588"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">ClassType</span> <span class="LPAREN">(</span><span id="local_id_590"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_r_591"><span class="LIDENT">r</span></span><span class="COMMA">,</span> <span id="local_c_592"><span class="LIDENT">c</span></span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span id="local_rest_593"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_id'_594"><span class="LIDENT">id'</span></span> <span class="EQUAL">=</span> <a href="#local_new_class_type_id_546"><span class="LIDENT">new_class_type_id</span></a> <a href="#local_id_590"><span class="LIDENT">id</span></a> <span class="IN">in</span><span class="EOL">
</span>      <a href="#val-rename_bound_idents"><span class="LIDENT">rename_bound_idents</span></a><span class="EOL">
</span>        <span class="LPAREN">(</span><a href="#val-rename_class_type"><span class="LIDENT">rename_class_type</span></a><span class="EOL">
</span>           <span class="LPAREN">(</span><a href="#local_id_590"><span class="LIDENT">id</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_class_type</span><span class="RPAREN">)</span><span class="EOL">
</span>           <span class="LPAREN">(</span><a href="#local_id'_594"><span class="LIDENT">id'</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_class_type</span><span class="RPAREN">)</span><span class="EOL">
</span>           <a href="#local_s_532"><span class="LIDENT">s</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="UIDENT">ClassType</span> <span class="LPAREN">(</span><a href="#local_id'_594"><span class="LIDENT">id'</span></a><span class="COMMA">,</span> <a href="#local_r_591"><span class="LIDENT">r</span></a><span class="COMMA">,</span> <a href="#local_c_592"><span class="LIDENT">c</span></a><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="#local_sg_533"><span class="LIDENT">sg</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_rest_593"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Include</span> <span class="LPAREN">(</span><span class="LBRACE">{</span> <span id="local_expansion__596"><span class="LIDENT">expansion_</span></span><span class="SEMI">;</span> <span class="UNDERSCORE">_</span> <span class="RBRACE">}</span> <span class="AS">as</span> <span id="local_i_595"><span class="LIDENT">i</span></span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span id="local_rest_597"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_s_598"><span class="LIDENT">s</span></span><span class="COMMA">,</span> <span id="local_items_599"><span class="LIDENT">items</span></span> <span class="EQUAL">=</span> <a href="#val-rename_bound_idents"><span class="LIDENT">rename_bound_idents</span></a> <a href="#local_s_532"><span class="LIDENT">s</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <a href="#local_expansion__596"><span class="LIDENT">expansion_</span></a><span class="DOT">.</span><span class="LIDENT">items</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#val-rename_bound_idents"><span class="LIDENT">rename_bound_idents</span></a> <a href="#local_s_598"><span class="LIDENT">s</span></a><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="UIDENT">Include</span> <span class="LBRACE">{</span> <a href="#local_i_595"><span class="LIDENT">i</span></a> <span class="WITH">with</span> <span class="LIDENT">expansion_</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_expansion__596"><span class="LIDENT">expansion_</span></a> <span class="WITH">with</span> <a href="#local_items_599"><span class="LIDENT">items</span></a><span class="SEMI">;</span> <span class="LIDENT">removed</span> <span class="EQUAL">=</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="RBRACE">}</span> <span class="RBRACE">}</span><span class="EOL">
</span>        <span class="COLONCOLON">::</span> <a href="#local_sg_533"><span class="LIDENT">sg</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_rest_597"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="UIDENT">Open</span> <span class="LBRACE">{</span> <span id="local_expansion_600"><span class="LIDENT">expansion</span></span><span class="SEMI">;</span> <span id="local_doc_601"><span class="LIDENT">doc</span></span> <span class="RBRACE">}</span> <span class="COLONCOLON">::</span> <span id="local_rest_602"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>      <span class="LET">let</span> <span id="local_s_603"><span class="LIDENT">s</span></span><span class="COMMA">,</span> <span id="local_items_604"><span class="LIDENT">items</span></span> <span class="EQUAL">=</span> <a href="#val-rename_bound_idents"><span class="LIDENT">rename_bound_idents</span></a> <a href="#local_s_532"><span class="LIDENT">s</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <a href="#local_expansion_600"><span class="LIDENT">expansion</span></a><span class="DOT">.</span><span class="LIDENT">items</span> <span class="IN">in</span><span class="EOL">
</span>      <a href="#val-rename_bound_idents"><span class="LIDENT">rename_bound_idents</span></a> <a href="#local_s_603"><span class="LIDENT">s</span></a><span class="EOL">
</span>        <span class="LPAREN">(</span><span class="UIDENT">Open</span> <span class="LBRACE">{</span> <span class="LIDENT">expansion</span> <span class="EQUAL">=</span> <span class="LBRACE">{</span> <a href="#local_expansion_600"><span class="LIDENT">expansion</span></a> <span class="WITH">with</span> <a href="#local_items_604"><span class="LIDENT">items</span></a><span class="SEMI">;</span> <span class="LIDENT">removed</span> <span class="EQUAL">=</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="RBRACE">}</span><span class="SEMI">;</span> <a href="#local_doc_601"><span class="LIDENT">doc</span></a> <span class="RBRACE">}</span> <span class="COLONCOLON">::</span> <a href="#local_sg_533"><span class="LIDENT">sg</span></a><span class="RPAREN">)</span><span class="EOL">
</span>        <a href="#local_rest_602"><span class="LIDENT">rest</span></a><span class="EOL">
</span>  <span class="BAR">|</span> <span class="LPAREN">(</span><span class="UIDENT">Comment</span> <span class="UNDERSCORE">_</span> <span class="AS">as</span> <span id="local_item_605"><span class="LIDENT">item</span></span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span id="local_rest_606"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#val-rename_bound_idents"><span class="LIDENT">rename_bound_idents</span></a> <a href="#local_s_532"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><a href="#local_item_605"><span class="LIDENT">item</span></a> <span class="COLONCOLON">::</span> <a href="#local_sg_533"><span class="LIDENT">sg</span></a><span class="RPAREN">)</span> <a href="#local_rest_606"><span class="LIDENT">rest</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-removed_items"><span class="LIDENT">removed_items</span></span> <span id="local_s_607"><span class="LIDENT">s</span></span> <span id="local_items_608"><span class="LIDENT">items</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">Signature</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">map</span><span class="EOL">
</span>    <span class="LPAREN">(</span><span class="FUNCTION">function</span><span class="EOL">
</span>      <span class="BAR">|</span> <span class="UIDENT">RModule</span> <span class="LPAREN">(</span><span id="local_id_610"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span class="UNDERSCORE">_</span><span class="RPAREN">)</span> <span class="AS">as</span> <span id="local_x_609"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <span class="LPAREN">(</span><span class="EOL">
</span>          <span class="TRY">try</span><span class="EOL">
</span>            <span class="MATCH">match</span> <span class="UIDENT">PathModuleMap</span><span class="DOT">.</span><span class="LIDENT">find</span> <span class="LPAREN">(</span><a href="#local_id_610"><span class="LIDENT">id</span></a> <span class="COLONGREATER">:&gt;</span> <span class="UIDENT">Ident</span><span class="DOT">.</span><span class="LIDENT">path_module</span><span class="RPAREN">)</span> <a href="#local_s_607"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">module_</span> <span class="WITH">with</span><span class="EOL">
</span>            <span class="BAR">|</span> <span class="BACKQUOTE">`</span><span class="UIDENT">Prefixed</span> <span class="LPAREN">(</span><span class="UNDERSCORE">_</span><span class="COMMA">,</span> <span id="local_x_611"><span class="LIDENT">x</span></span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">RModule</span> <span class="LPAREN">(</span><a href="#local_id_610"><span class="LIDENT">id</span></a><span class="COMMA">,</span> <a href="#local_x_611"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span>            <span class="BAR">|</span> <span class="UNDERSCORE">_</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_609"><span class="LIDENT">x</span></a><span class="EOL">
</span>          <span class="WITH">with</span> <span class="UIDENT">Not_found</span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_609"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span>      <span class="BAR">|</span> <span id="local_x_612"><span class="LIDENT">x</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_x_612"><span class="LIDENT">x</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <a href="#local_items_608"><span class="LIDENT">items</span></a><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-signature"><span class="LIDENT">signature</span></span> <span id="local_s_613"><span class="LIDENT">s</span></span> <span id="local_sg_614"><span class="LIDENT">sg</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_s_615"><span class="LIDENT">s</span></span><span class="COMMA">,</span> <span id="local_items_616"><span class="LIDENT">items</span></span> <span class="EQUAL">=</span> <a href="#val-rename_bound_idents"><span class="LIDENT">rename_bound_idents</span></a> <a href="#local_s_613"><span class="LIDENT">s</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <a href="#local_sg_614"><span class="LIDENT">sg</span></a><span class="DOT">.</span><span class="LIDENT">items</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_items_617"><span class="LIDENT">items</span></span><span class="COMMA">,</span> <span id="local_removed_618"><span class="LIDENT">removed</span></span><span class="COMMA">,</span> <span id="local_dont_recompile_619"><span class="LIDENT">dont_recompile</span></span> <span class="EQUAL">=</span> <a href="#val-apply_sig_map"><span class="LIDENT">apply_sig_map</span></a> <a href="#local_s_615"><span class="LIDENT">s</span></a> <a href="#local_items_616"><span class="LIDENT">items</span></a> <a href="#local_sg_614"><span class="LIDENT">sg</span></a><span class="DOT">.</span><span class="LIDENT">removed</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_sg_614"><span class="LIDENT">sg</span></a> <span class="WITH">with</span> <a href="#local_items_617"><span class="LIDENT">items</span></a><span class="SEMI">;</span> <a href="#local_removed_618"><span class="LIDENT">removed</span></a><span class="SEMI">;</span> <span class="LIDENT">compiled</span> <span class="EQUAL">=</span> <a href="#local_sg_614"><span class="LIDENT">sg</span></a><span class="DOT">.</span><span class="LIDENT">compiled</span> <span class="AMPERAMPER">&amp;&amp;</span> <a href="#local_dont_recompile_619"><span class="LIDENT">dont_recompile</span></a> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-apply_sig_map_sg"><span class="LIDENT">apply_sig_map_sg</span></span> <span id="local_s_620"><span class="LIDENT">s</span></span> <span class="LPAREN">(</span><span id="local_sg_621"><span class="LIDENT">sg</span></span> <span class="COLON">:</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">Signature</span><span class="DOT">.</span><span class="LIDENT">t</span><span class="RPAREN">)</span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_items_622"><span class="LIDENT">items</span></span><span class="COMMA">,</span> <span id="local_removed_623"><span class="LIDENT">removed</span></span><span class="COMMA">,</span> <span id="local_dont_recompile_624"><span class="LIDENT">dont_recompile</span></span> <span class="EQUAL">=</span> <a href="#val-apply_sig_map"><span class="LIDENT">apply_sig_map</span></a> <a href="#local_s_620"><span class="LIDENT">s</span></a> <a href="#local_sg_621"><span class="LIDENT">sg</span></a><span class="DOT">.</span><span class="LIDENT">items</span> <a href="#local_sg_621"><span class="LIDENT">sg</span></a><span class="DOT">.</span><span class="LIDENT">removed</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LBRACE">{</span> <a href="#local_sg_621"><span class="LIDENT">sg</span></a> <span class="WITH">with</span> <a href="#local_items_622"><span class="LIDENT">items</span></a><span class="SEMI">;</span> <a href="#local_removed_623"><span class="LIDENT">removed</span></a><span class="SEMI">;</span> <span class="LIDENT">compiled</span> <span class="EQUAL">=</span> <a href="#local_sg_621"><span class="LIDENT">sg</span></a><span class="DOT">.</span><span class="LIDENT">compiled</span> <span class="AMPERAMPER">&amp;&amp;</span> <a href="#local_dont_recompile_624"><span class="LIDENT">dont_recompile</span></a> <span class="RBRACE">}</span><span class="EOL">
</span><span class="EOL">
</span><span class="AND">and</span> <span id="val-apply_sig_map"><span class="LIDENT">apply_sig_map</span></span> <span id="local_s_625"><span class="LIDENT">s</span></span> <span id="local_items_626"><span class="LIDENT">items</span></span> <span id="local_removed_627"><span class="LIDENT">removed</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="OPEN">open</span> <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">Signature</span> <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span class="REC">rec</span> <span id="local_inner_628"><span class="LIDENT">inner</span></span> <span id="local_items_629"><span class="LIDENT">items</span></span> <span id="local_acc_630"><span class="LIDENT">acc</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="MATCH">match</span> <a href="#local_items_629"><span class="LIDENT">items</span></a> <span class="WITH">with</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="LBRACKET">[</span><span class="RBRACKET">]</span> <span class="MINUSGREATER">-&gt;</span> <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">rev</span> <a href="#local_acc_630"><span class="LIDENT">acc</span></a><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Module</span> <span class="LPAREN">(</span><span id="local_id_631"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_r_632"><span class="LIDENT">r</span></span><span class="COMMA">,</span> <span id="local_m_633"><span class="LIDENT">m</span></span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span id="local_rest_634"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_inner_628"><span class="LIDENT">inner</span></a> <a href="#local_rest_634"><span class="LIDENT">rest</span></a><span class="EOL">
</span>          <span class="LPAREN">(</span><span class="UIDENT">Module</span><span class="EOL">
</span>             <span class="LPAREN">(</span> <a href="#local_id_631"><span class="LIDENT">id</span></a><span class="COMMA">,</span><span class="EOL">
</span>               <a href="#local_r_632"><span class="LIDENT">r</span></a><span class="COMMA">,</span><span class="EOL">
</span>               <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">Delayed</span><span class="DOT">.</span><span class="LIDENT">put</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>                   <a href="#val-module_"><span class="LIDENT">module_</span></a> <a href="#local_s_625"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">Delayed</span><span class="DOT">.</span><span class="LIDENT">get</span> <a href="#local_m_633"><span class="LIDENT">m</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="RPAREN">)</span><span class="EOL">
</span>          <span class="COLONCOLON">::</span> <a href="#local_acc_630"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">ModuleSubstitution</span> <span class="LPAREN">(</span><span id="local_id_635"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_m_636"><span class="LIDENT">m</span></span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span id="local_rest_637"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_inner_628"><span class="LIDENT">inner</span></a> <a href="#local_rest_637"><span class="LIDENT">rest</span></a> <span class="LPAREN">(</span><span class="UIDENT">ModuleSubstitution</span> <span class="LPAREN">(</span><a href="#local_id_635"><span class="LIDENT">id</span></a><span class="COMMA">,</span> <a href="#val-module_substitution"><span class="LIDENT">module_substitution</span></a> <a href="#local_s_625"><span class="LIDENT">s</span></a> <a href="#local_m_636"><span class="LIDENT">m</span></a><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="#local_acc_630"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">ModuleType</span> <span class="LPAREN">(</span><span id="local_id_638"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_mt_639"><span class="LIDENT">mt</span></span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span id="local_rest_640"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_inner_628"><span class="LIDENT">inner</span></a> <a href="#local_rest_640"><span class="LIDENT">rest</span></a><span class="EOL">
</span>          <span class="LPAREN">(</span><span class="UIDENT">ModuleType</span><span class="EOL">
</span>             <span class="LPAREN">(</span> <a href="#local_id_638"><span class="LIDENT">id</span></a><span class="COMMA">,</span><span class="EOL">
</span>               <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">Delayed</span><span class="DOT">.</span><span class="LIDENT">put</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>                   <a href="#val-module_type"><span class="LIDENT">module_type</span></a> <a href="#local_s_625"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">Delayed</span><span class="DOT">.</span><span class="LIDENT">get</span> <a href="#local_mt_639"><span class="LIDENT">mt</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="RPAREN">)</span><span class="EOL">
</span>          <span class="COLONCOLON">::</span> <a href="#local_acc_630"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">ModuleTypeSubstitution</span> <span class="LPAREN">(</span><span id="local_id_641"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_mt_642"><span class="LIDENT">mt</span></span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span id="local_rest_643"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_inner_628"><span class="LIDENT">inner</span></a> <a href="#local_rest_643"><span class="LIDENT">rest</span></a><span class="EOL">
</span>          <span class="LPAREN">(</span><span class="UIDENT">ModuleTypeSubstitution</span> <span class="LPAREN">(</span><a href="#local_id_641"><span class="LIDENT">id</span></a><span class="COMMA">,</span> <a href="#val-module_type_substitution"><span class="LIDENT">module_type_substitution</span></a> <a href="#local_s_625"><span class="LIDENT">s</span></a> <a href="#local_mt_642"><span class="LIDENT">mt</span></a><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="#local_acc_630"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Type</span> <span class="LPAREN">(</span><span id="local_id_644"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_r_645"><span class="LIDENT">r</span></span><span class="COMMA">,</span> <span id="local_t_646"><span class="LIDENT">t</span></span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span id="local_rest_647"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_inner_628"><span class="LIDENT">inner</span></a> <a href="#local_rest_647"><span class="LIDENT">rest</span></a><span class="EOL">
</span>          <span class="LPAREN">(</span><span class="UIDENT">Type</span><span class="EOL">
</span>             <span class="LPAREN">(</span> <a href="#local_id_644"><span class="LIDENT">id</span></a><span class="COMMA">,</span><span class="EOL">
</span>               <a href="#local_r_645"><span class="LIDENT">r</span></a><span class="COMMA">,</span><span class="EOL">
</span>               <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">Delayed</span><span class="DOT">.</span><span class="LIDENT">put</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>                   <a href="#val-type_"><span class="LIDENT">type_</span></a> <a href="#local_s_625"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">Delayed</span><span class="DOT">.</span><span class="LIDENT">get</span> <a href="#local_t_646"><span class="LIDENT">t</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="RPAREN">)</span><span class="EOL">
</span>          <span class="COLONCOLON">::</span> <a href="#local_acc_630"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">TypeSubstitution</span> <span class="LPAREN">(</span><span id="local_id_648"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_t_649"><span class="LIDENT">t</span></span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span id="local_rest_650"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_inner_628"><span class="LIDENT">inner</span></a> <a href="#local_rest_650"><span class="LIDENT">rest</span></a> <span class="LPAREN">(</span><span class="UIDENT">TypeSubstitution</span> <span class="LPAREN">(</span><a href="#local_id_648"><span class="LIDENT">id</span></a><span class="COMMA">,</span> <a href="#val-type_"><span class="LIDENT">type_</span></a> <a href="#local_s_625"><span class="LIDENT">s</span></a> <a href="#local_t_649"><span class="LIDENT">t</span></a><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="#local_acc_630"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Exception</span> <span class="LPAREN">(</span><span id="local_id_651"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_e_652"><span class="LIDENT">e</span></span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span id="local_rest_653"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_inner_628"><span class="LIDENT">inner</span></a> <a href="#local_rest_653"><span class="LIDENT">rest</span></a> <span class="LPAREN">(</span><span class="UIDENT">Exception</span> <span class="LPAREN">(</span><a href="#local_id_651"><span class="LIDENT">id</span></a><span class="COMMA">,</span> <a href="#val-exception_"><span class="LIDENT">exception_</span></a> <a href="#local_s_625"><span class="LIDENT">s</span></a> <a href="#local_e_652"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="#local_acc_630"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">TypExt</span> <span id="local_e_654"><span class="LIDENT">e</span></span> <span class="COLONCOLON">::</span> <span id="local_rest_655"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_inner_628"><span class="LIDENT">inner</span></a> <a href="#local_rest_655"><span class="LIDENT">rest</span></a> <span class="LPAREN">(</span><span class="UIDENT">TypExt</span> <span class="LPAREN">(</span><a href="#val-extension"><span class="LIDENT">extension</span></a> <a href="#local_s_625"><span class="LIDENT">s</span></a> <a href="#local_e_654"><span class="LIDENT">e</span></a><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="#local_acc_630"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Value</span> <span class="LPAREN">(</span><span id="local_id_656"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_v_657"><span class="LIDENT">v</span></span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span id="local_rest_658"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_inner_628"><span class="LIDENT">inner</span></a> <a href="#local_rest_658"><span class="LIDENT">rest</span></a><span class="EOL">
</span>          <span class="LPAREN">(</span><span class="UIDENT">Value</span><span class="EOL">
</span>             <span class="LPAREN">(</span> <a href="#local_id_656"><span class="LIDENT">id</span></a><span class="COMMA">,</span><span class="EOL">
</span>               <span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">Delayed</span><span class="DOT">.</span><span class="LIDENT">put</span> <span class="LPAREN">(</span><span class="FUN">fun</span> <span class="LPAREN">(</span><span class="RPAREN">)</span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>                   <a href="#val-value"><span class="LIDENT">value</span></a> <a href="#local_s_625"><span class="LIDENT">s</span></a> <span class="LPAREN">(</span><span class="UIDENT">Component</span><span class="DOT">.</span><span class="UIDENT">Delayed</span><span class="DOT">.</span><span class="LIDENT">get</span> <a href="#local_v_657"><span class="LIDENT">v</span></a><span class="RPAREN">)</span><span class="RPAREN">)</span> <span class="RPAREN">)</span><span class="EOL">
</span>          <span class="COLONCOLON">::</span> <a href="#local_acc_630"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Class</span> <span class="LPAREN">(</span><span id="local_id_659"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_r_660"><span class="LIDENT">r</span></span><span class="COMMA">,</span> <span id="local_c_661"><span class="LIDENT">c</span></span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span id="local_rest_662"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_inner_628"><span class="LIDENT">inner</span></a> <a href="#local_rest_662"><span class="LIDENT">rest</span></a> <span class="LPAREN">(</span><span class="UIDENT">Class</span> <span class="LPAREN">(</span><a href="#local_id_659"><span class="LIDENT">id</span></a><span class="COMMA">,</span> <a href="#local_r_660"><span class="LIDENT">r</span></a><span class="COMMA">,</span> <a href="#val-class_"><span class="LIDENT">class_</span></a> <a href="#local_s_625"><span class="LIDENT">s</span></a> <a href="#local_c_661"><span class="LIDENT">c</span></a><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="#local_acc_630"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">ClassType</span> <span class="LPAREN">(</span><span id="local_id_663"><span class="LIDENT">id</span></span><span class="COMMA">,</span> <span id="local_r_664"><span class="LIDENT">r</span></span><span class="COMMA">,</span> <span id="local_c_665"><span class="LIDENT">c</span></span><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <span id="local_rest_666"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span><span class="EOL">
</span>        <a href="#local_inner_628"><span class="LIDENT">inner</span></a> <a href="#local_rest_666"><span class="LIDENT">rest</span></a> <span class="LPAREN">(</span><span class="UIDENT">ClassType</span> <span class="LPAREN">(</span><a href="#local_id_663"><span class="LIDENT">id</span></a><span class="COMMA">,</span> <a href="#local_r_664"><span class="LIDENT">r</span></a><span class="COMMA">,</span> <a href="#val-class_type"><span class="LIDENT">class_type</span></a> <a href="#local_s_625"><span class="LIDENT">s</span></a> <a href="#local_c_665"><span class="LIDENT">c</span></a><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="#local_acc_630"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Include</span> <span id="local_i_667"><span class="LIDENT">i</span></span> <span class="COLONCOLON">::</span> <span id="local_rest_668"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_inner_628"><span class="LIDENT">inner</span></a> <a href="#local_rest_668"><span class="LIDENT">rest</span></a> <span class="LPAREN">(</span><span class="UIDENT">Include</span> <span class="LPAREN">(</span><a href="#val-include_"><span class="LIDENT">include_</span></a> <a href="#local_s_625"><span class="LIDENT">s</span></a> <a href="#local_i_667"><span class="LIDENT">i</span></a><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="#local_acc_630"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Open</span> <span id="local_o_669"><span class="LIDENT">o</span></span> <span class="COLONCOLON">::</span> <span id="local_rest_670"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_inner_628"><span class="LIDENT">inner</span></a> <a href="#local_rest_670"><span class="LIDENT">rest</span></a> <span class="LPAREN">(</span><span class="UIDENT">Open</span> <span class="LPAREN">(</span><a href="#val-open_"><span class="LIDENT">open_</span></a> <a href="#local_s_625"><span class="LIDENT">s</span></a> <a href="#local_o_669"><span class="LIDENT">o</span></a><span class="RPAREN">)</span> <span class="COLONCOLON">::</span> <a href="#local_acc_630"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span><span class="EOL">
</span>    <span class="BAR">|</span> <span class="UIDENT">Comment</span> <span id="local_c_671"><span class="LIDENT">c</span></span> <span class="COLONCOLON">::</span> <span id="local_rest_672"><span class="LIDENT">rest</span></span> <span class="MINUSGREATER">-&gt;</span> <a href="#local_inner_628"><span class="LIDENT">inner</span></a> <a href="#local_rest_672"><span class="LIDENT">rest</span></a> <span class="LPAREN">(</span><span class="UIDENT">Comment</span> <a href="#local_c_671"><span class="LIDENT">c</span></a> <span class="COLONCOLON">::</span> <a href="#local_acc_630"><span class="LIDENT">acc</span></a><span class="RPAREN">)</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LET">let</span> <span id="local_dont_recompile_673"><span class="LIDENT">dont_recompile</span></span> <span class="EQUAL">=</span><span class="EOL">
</span>    <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">length</span> <a href="#local_s_625"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">path_invalidating_modules</span> <span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>    <span class="AMPERAMPER">&amp;&amp;</span> <span class="UIDENT">List</span><span class="DOT">.</span><span class="LIDENT">length</span> <a href="#local_s_625"><span class="LIDENT">s</span></a><span class="DOT">.</span><span class="LIDENT">module_type_of_invalidating_modules</span> <span class="EQUAL">=</span> <span class="INT">0</span><span class="EOL">
</span>  <span class="IN">in</span><span class="EOL">
</span>  <span class="LPAREN">(</span><a href="#local_inner_628"><span class="LIDENT">inner</span></a> <a href="#local_items_626"><span class="LIDENT">items</span></a> <span class="LBRACKET">[</span><span class="RBRACKET">]</span><span class="COMMA">,</span> <a href="#val-removed_items"><span class="LIDENT">removed_items</span></a> <a href="#local_s_625"><span class="LIDENT">s</span></a> <a href="#local_removed_627"><span class="LIDENT">removed</span></a><span class="COMMA">,</span> <a href="#local_dont_recompile_673"><span class="LIDENT">dont_recompile</span></a><span class="RPAREN">)</span><span class="EOL">
</span></span></code></pre></body></html>
